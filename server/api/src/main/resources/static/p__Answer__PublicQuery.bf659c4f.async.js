(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[250],{13277:function(){},75952:function(L,x,e){"use strict";e.r(x),e.d(x,{default:function(){return V}});var m=e(80937),y=e(67294),S=e(51615),g=e(34792),A=e(48086),b=e(3182),i=e(69610),O=e(54941),F=e(94043),j=e.n(F),R=e(36602),c=e(54531),u=function(){function v(r){(0,i.Z)(this,v),this.id=void 0,this.resultId=void 0,this.query=void 0,this.queryErrorMsg=void 0,this.queryForm=void 0,this.queryResult=void 0,this.queryFormValue={},this.id=r.id,this.resultId=r.resultId,this.query=r.query,this.makeObservable()}return(0,O.Z)(v,[{key:"makeObservable",value:function(){(0,c.Ou)(this,{id:c.LO.ref,resultId:c.LO.ref,query:c.LO.ref,queryForm:c.LO.ref,queryResult:c.LO.ref,queryFormValue:c.LO.ref,queryErrorMsg:c.LO.ref,loadQuery:c.aD,getQueryResult:c.aD})}},{key:"loadQuery",value:function(){var r=(0,b.Z)(j().mark(function o(){var a;return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,R.hi.loadQuery({id:this.id,resultId:this.resultId});case 2:a=E.sent,a.success?this.queryForm=a.data.schema:this.queryErrorMsg=a.message;case 4:case"end":return E.stop()}},o,this)}));function p(){return r.apply(this,arguments)}return p}()},{key:"getQueryResult",value:function(){var r=(0,b.Z)(j().mark(function o(a){var h;return j().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,R.hi.getQueryResult({id:this.id,resultId:this.resultId,answer:a,query:this.query});case 2:h=l.sent,this.queryFormValue=a,h.code!==200?A.default.error(h.message):this.queryResult=h.data;case 5:case"end":return l.stop()}},o,this)}));function p(o){return r.apply(this,arguments)}return p}()},{key:"updateAnswer",value:function(){var r=(0,b.Z)(j().mark(function o(a,h){return j().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,R.hi.post("/api/public/saveAnswer",{id:h,queryId:this.resultId,answer:a,projectId:this.id});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},o,this)}));function p(o,a){return r.apply(this,arguments)}return p}()},{key:"upload",value:function(){var r=(0,b.Z)(j().mark(function o(a,h){return j().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",R.hi.upload("/api/public/upload",{file:a,basePath:this.id},h));case 1:case"end":return l.stop()}},o,this)}));function p(o,a){return r.apply(this,arguments)}return p}()}]),v}(),Z=y.createContext(new u({id:"123456",resultId:"123456"}));function Q(){return(0,y.useContext)(Z)}var P=e(19357),w=e(80893),t=e(85893),K=(0,m.Pi)(function(){var v=Q(),r=v.queryForm,p=v.queryResult;return(0,y.useEffect)(function(){v.loadQuery()},[]),p?(0,t.jsx)(t.Fragment,{}):r?(0,t.jsx)("div",{className:"public-query",children:(0,t.jsx)("div",{className:"query-form",children:!p&&(0,t.jsx)(P.Z,{theme:"antdForm",schema:r,questionNumber:!1,onSubmit:function(a){v.getQueryResult(a)}})})}):(0,t.jsx)(w.gb,{})}),H=e(57663),d=e(71577),s=e(49111),C=e(19650),n=e(71153),f=e(60331),k=e(83279),B=e(18106),I=e(51752),W=e(94184),N=e.n(W),M=e(87998),$=I.Z.TabPane,T=(0,m.Pi)(function(){var v=Q(),r=v.queryResult,p=v.queryFormValue,o=(0,y.useMemo)(function(){return(0,M.SB)()},[]);return(0,y.useEffect)(function(){},[]),r?(0,t.jsxs)("div",{className:N()("query-result",o?"mobile":"pc"),children:[(0,t.jsxs)("div",{className:"query-result-criteria",children:[(0,t.jsx)("h3",{children:"\u67E5\u8BE2\u6761\u4EF6"}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0"},children:[(0,t.jsxs)("div",{children:["\u67E5\u8BE2\u6761\u4EF6\uFF1A",(0,t.jsx)(C.Z,{children:Object.values(p).reduce(function(a,h){return a.push.apply(a,(0,k.Z)(Object.values(h))),a},[]).map(function(a){return(0,t.jsx)(f.Z,{color:"blue",children:a},a)})})]}),(0,t.jsx)(d.Z,{type:"primary",onClick:function(){v.queryResult=void 0},children:"\u91CD\u65B0\u67E5\u8BE2"})]})]}),(0,t.jsx)("div",{className:"query-result-container",children:(0,t.jsxs)("div",{className:"query-result-data",children:[(0,t.jsxs)("div",{className:"query-result-data-total",children:["\u67E5\u8BE2\u5230 ",r.answers.length," \u6761\u7B26\u5408\u6761\u4EF6\u7684\u6570\u636E"]}),(0,t.jsx)("div",{className:"query-result-data-content",children:(0,t.jsx)(I.Z,{type:"card",children:r.answers.map(function(a){return(0,t.jsx)($,{tab:a.createAt,children:(0,t.jsx)(P.Z,{theme:o?"antdMobile":"antd",schema:r==null?void 0:r.schema,initialValues:a.answer,headerVisible:!1,footerVisible:!!(r!=null&&r.schema.attribute),paginationVisible:!1,fieldPermission:r.fieldPermission,onUpload:function(E,l){return v.upload({file:E},l)},onSubmit:function(E){v.updateAnswer(E,a.answerId).then(function(l){l.success?A.default.success("\u7B54\u6848\u66F4\u65B0\u6210\u529F"):A.default.error(l.message)})}})},a.answerId)})})})]})})]}):(0,t.jsx)(t.Fragment,{})}),z=e(48644),D=(0,m.Pi)(function(){var v=Q(),r=v.queryErrorMsg;return r?(0,t.jsx)("div",{className:"render-failure  phone",children:(0,t.jsxs)("div",{className:"content",children:[(0,t.jsx)("div",{children:(0,t.jsx)(z.AT,{})}),(0,t.jsx)("h2",{children:r})]})}):(0,t.jsx)(t.Fragment,{})}),V=(0,m.Pi)(function(){var r=(0,S.UO)(),p=r.id,o=r.resultId,a=(0,S.TH)(),h=(0,y.useMemo)(function(){return new u({id:p,resultId:o,query:a.query})},[p,o]);return(0,t.jsxs)(Z.Provider,{value:h,children:[(0,t.jsx)(D,{}),(0,t.jsx)(K,{}),(0,t.jsx)(T,{})]})})},60331:function(L,x,e){"use strict";e.d(x,{Z:function(){return H}});var m=e(96156),y=e(22122),S=e(28481),g=e(67294),A=e(94184),b=e.n(A),i=e(98423),O=e(54549),F=e(65632),j=function(d,s){var C={};for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&s.indexOf(n)<0&&(C[n]=d[n]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,n=Object.getOwnPropertySymbols(d);f<n.length;f++)s.indexOf(n[f])<0&&Object.prototype.propertyIsEnumerable.call(d,n[f])&&(C[n[f]]=d[n[f]]);return C},R=function(s){var C,n=s.prefixCls,f=s.className,k=s.checked,B=s.onChange,I=s.onClick,W=j(s,["prefixCls","className","checked","onChange","onClick"]),N=g.useContext(F.E_),M=N.getPrefixCls,$=function(V){B==null||B(!k),I==null||I(V)},T=M("tag",n),z=b()(T,(C={},(0,m.Z)(C,"".concat(T,"-checkable"),!0),(0,m.Z)(C,"".concat(T,"-checkable-checked"),k),C),f);return g.createElement("span",(0,y.Z)({},W,{className:z,onClick:$}))},c=R,u=e(98787),Z=e(21790),Q=function(d,s){var C={};for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&s.indexOf(n)<0&&(C[n]=d[n]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,n=Object.getOwnPropertySymbols(d);f<n.length;f++)s.indexOf(n[f])<0&&Object.prototype.propertyIsEnumerable.call(d,n[f])&&(C[n[f]]=d[n[f]]);return C},P=new RegExp("^(".concat(u.Y.join("|"),")(-inverse)?$")),w=new RegExp("^(".concat(u.E.join("|"),")$")),t=function(s,C){var n,f=s.prefixCls,k=s.className,B=s.style,I=s.children,W=s.icon,N=s.color,M=s.onClose,$=s.closeIcon,T=s.closable,z=T===void 0?!1:T,D=Q(s,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),V=g.useContext(F.E_),v=V.getPrefixCls,r=V.direction,p=g.useState(!0),o=(0,S.Z)(p,2),a=o[0],h=o[1];g.useEffect(function(){"visible"in D&&h(D.visible)},[D.visible]);var E=function(){return N?P.test(N)||w.test(N):!1},l=(0,y.Z)({backgroundColor:N&&!E()?N:void 0},B),X=E(),U=v("tag",f),ee=b()(U,(n={},(0,m.Z)(n,"".concat(U,"-").concat(N),X),(0,m.Z)(n,"".concat(U,"-has-color"),N&&!X),(0,m.Z)(n,"".concat(U,"-hidden"),!a),(0,m.Z)(n,"".concat(U,"-rtl"),r==="rtl"),n),k),Y=function(G){G.stopPropagation(),M==null||M(G),!G.defaultPrevented&&("visible"in D||h(!1))},te=function(){return z?$?g.createElement("span",{className:"".concat(U,"-close-icon"),onClick:Y},$):g.createElement(O.Z,{className:"".concat(U,"-close-icon"),onClick:Y}):null},re="onClick"in D||I&&I.type==="a",ae=(0,i.Z)(D,["visible"]),q=W||null,ne=q?g.createElement(g.Fragment,null,q,g.createElement("span",null,I)):I,J=g.createElement("span",(0,y.Z)({},ae,{ref:C,className:ee,style:l}),ne,te());return re?g.createElement(Z.Z,null,J):J},K=g.forwardRef(t);K.displayName="Tag",K.CheckableTag=c;var H=K},71153:function(L,x,e){"use strict";var m=e(38663),y=e.n(m),S=e(13277),g=e.n(S)},20640:function(L,x,e){"use strict";var m=e(11742),y={"text/plain":"Text","text/html":"Url",default:"Text"},S="Copy to clipboard: #{key}, Enter";function g(b){var i=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return b.replace(/#{\s*key\s*}/g,i)}function A(b,i){var O,F,j,R,c,u,Z=!1;i||(i={}),O=i.debug||!1;try{j=m(),R=document.createRange(),c=document.getSelection(),u=document.createElement("span"),u.textContent=b,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",function(P){if(P.stopPropagation(),i.format)if(P.preventDefault(),typeof P.clipboardData=="undefined"){O&&console.warn("unable to use e.clipboardData"),O&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var w=y[i.format]||y.default;window.clipboardData.setData(w,b)}else P.clipboardData.clearData(),P.clipboardData.setData(i.format,b);i.onCopy&&(P.preventDefault(),i.onCopy(P.clipboardData))}),document.body.appendChild(u),R.selectNodeContents(u),c.addRange(R);var Q=document.execCommand("copy");if(!Q)throw new Error("copy command was unsuccessful");Z=!0}catch(P){O&&console.error("unable to copy using execCommand: ",P),O&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(i.format||"text",b),i.onCopy&&i.onCopy(window.clipboardData),Z=!0}catch(w){O&&console.error("unable to copy using clipboardData: ",w),O&&console.error("falling back to prompt"),F=g("message"in i?i.message:S),window.prompt(F,b)}}finally{c&&(typeof c.removeRange=="function"?c.removeRange(R):c.removeAllRanges()),u&&document.body.removeChild(u),j()}return Z}L.exports=A},11742:function(L){L.exports=function(){var x=document.getSelection();if(!x.rangeCount)return function(){};for(var e=document.activeElement,m=[],y=0;y<x.rangeCount;y++)m.push(x.getRangeAt(y));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return x.removeAllRanges(),function(){x.type==="Caret"&&x.removeAllRanges(),x.rangeCount||m.forEach(function(S){x.addRange(S)}),e&&e.focus()}}}}]);
