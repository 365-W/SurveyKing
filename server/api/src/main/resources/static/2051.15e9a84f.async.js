(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[2051],{28161:function(fe,ne,g){"use strict";g.r(ne),g.d(ne,{default:function(){return Wt}});var I=g(94657),U=g(40807),R=g(9761),b=g(67294),Q=g(67635),N=g(54707),A=g(48187),e=g(85893),re=function(){var n=(0,N.AK)(),a=(0,b.useContext)(U.ZX),u=a.schema;return(0,e.jsxs)("div",{className:n+"-header",children:[(0,e.jsx)("div",{className:n+"-header-title",children:(0,e.jsx)(Q.hl,{html:u.title})}),(0,e.jsx)("div",{className:n+"-header-description",children:(0,e.jsx)(Q.hl,{html:u.description})})]})},te=function(n){var a=(0,N.AK)();return(0,e.jsx)("div",{className:a+"-body",children:n.children})},z=g(77576),k=g(12028),X=g(57663),T=g(71577),ee=(0,R.Pi)(function(){var t,n,a=(0,N.AK)("-footer"),u=(0,b.useContext)(U.ZX),r=u.schema,f=u.loading,h=(0,N.Rk)(),d=h.pagination,o=d.current,m=d.pageSize,l=m>1,i=o===1,s=o===m;return(0,e.jsxs)("div",{className:a,children:[s&&(0,e.jsx)("div",{className:a+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(Q.hl,{html:r==null||(t=r.attribute)===null||t===void 0?void 0:t.suffix})}),(0,e.jsxs)("div",{className:a+"-pagination",children:[l&&!i&&(0,e.jsx)("div",{children:(0,e.jsx)(T.Z,{type:"primary",block:!0,onClick:function(){return h.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),l&&!s&&(0,e.jsx)("div",{children:(0,e.jsx)(T.Z,{type:"primary",block:!0,onClick:function(){return h.handleNext()},children:"\u4E0B\u4E00\u9875"})}),s&&(0,e.jsx)("div",{children:(0,e.jsx)(T.Z,{type:"primary",block:!0,onClick:function(){return h.submit()},loading:f,children:(0,e.jsx)(Q.hl,{html:((n=r.attribute)===null||n===void 0?void 0:n.submitButton)||"\u63D0\u4EA4"})})}),l&&(0,e.jsxs)("div",{className:a+"-pagination-info",children:["\u7B2C",o,"\u9875/\u5171",m,"\u9875"]}),h.autoNextPage>0&&(0,e.jsxs)("div",{style:{color:"#999",display:"flex",alignItems:"center",justifyContent:"center",width:200},children:["\u7B54\u5BF9\u81EA\u52A8\u8DF3\u8F6C\u4E0B\u4E00\u9875",(0,e.jsx)(k.Z,{style:{marginLeft:5},checked:h.autoNextPage===1,onChange:function(c){c?h.autoNextPage=1:h.autoNextPage=2}})]})]})]})}),V=g(47673),K=g(4107),p=g(11849),ae=g(77883),ie=g(85986),pe=g(14965),be=g(68318),me=g(39002),de=g(68351),Kt=g(43358),ce=g(34041),Xe=g(29985),Qe=g(46842),Je=g(64302),qe=g(27484),Se=g.n(qe),Yt=g(33852);Se().locale("zh-cn");function Ee(t,n){if(!!t)return Se()(t,n)}var _e=function(n){var a=n.dictCode,u=n.value,r=n.onChange,f=n.style,h=n.bordered,d=n.className,o=n.parentValue,m=n.cascaderLevel,l=m===void 0?1:m,i=(0,N.Al)(),s=(0,b.useState)([]),v=(0,I.Z)(s,2),c=v[0],x=v[1],j=(0,N.zE)(function(y){l&&l>1&&!o||i.onDictSearch&&i.onDictSearch({dictCode:a,searchValue:y,parentValue:o==null?void 0:o.split("|")[0],cascaderLevel:l}).then(function(C){x(C||[])})},2);return(0,b.useEffect)(function(){l&&l>1&&(o?j(void 0):x([]))},[o,l]),(0,b.useEffect)(function(){!u&&l<=1&&a&&j(void 0),u&&c.length===0&&j(u)},[u]),(0,e.jsx)(ce.Z,{options:c,showSearch:!0,onSearch:j,value:u==null?void 0:u.split("|")[0],onChange:function(C){var Z;return r("".concat(C,"|").concat((Z=c.find(function(w){return w.value===C}))===null||Z===void 0?void 0:Z.label))},style:f,bordered:h,dropdownClassName:d,allowClear:!0})};function en(t,n){return n||(t==="date"?"YYYY-MM-DD":t==="dateTime"?"YYYY-MM-DD HH:mm:ss":t==="time"?"HH:mm:ss":"YYYY-MM-DD")}function nn(t){return t?t==="YYYY"?"year":t==="YYYY-MM"?"month":"date":"date"}var tn=function(n){var a=n.onChange,u=n.type,r=n.value,f=n.style,h=f===void 0?{width:"100%"}:f,d=n.className,o=n.readOnly,m=n.bordered,l=en(u,n.dateTimeFormat);return l.startsWith("HH")?(0,e.jsx)(de.Z,{value:Ee(r,l),format:l,onChange:function(s,v){return a(v)},style:h,className:d,disabled:o,bordered:m}):(0,e.jsx)(be.Z,{onChange:function(s,v){a(v)},disabled:o,format:l,picker:nn(l),showTime:l.includes("HH")||l.includes("mm")||l.includes("ss"),showSecond:l.includes("ss"),showMinute:l.includes("mm"),showHour:l.includes("HH"),value:Ee(r,l),style:h,className:d,bordered:m})},le=function(n){var a=n.onChange,u=n.type,r=n.value,f=n.suffix,h=n.style,d=h===void 0?{width:"100%"}:h,o=n.className,m=n.dictCode,l=n.onBlur,i=l===void 0?function(){}:l,s=n.bordered,v=n.parentValue,c=n.cascaderLevel,x=n.icon,j=x===void 0?!0:x,y=n.readOnly,C=y===void 0?!1:y,Z=n.schema;return u==="horzBlank"?(0,e.jsx)(e.Fragment,{}):u==="selectDict"&&m?(0,e.jsx)(_e,{value:r,onChange:a,dictCode:m,style:d,bordered:s,className:o,parentValue:v,cascaderLevel:c}):u==="select"&&Z!==null&&Z!==void 0&&Z.dataSource?(0,e.jsx)(ce.Z,{options:Z.dataSource,style:{width:200},bordered:s,onChange:a}):u==="number"?(0,e.jsx)(ie.Z,{className:o,onChange:a,onBlur:function(S){return i(S.target.value)},value:r,style:d,addonAfter:f,readOnly:C,bordered:s}):u==="date"||u==="dateTime"||u==="time"?(0,e.jsx)(tn,(0,p.Z)({},n)):u==="mobile"?(0,e.jsx)(K.Z,{prefix:j?(0,e.jsx)(Xe.Z,{}):void 0,onChange:function(S){return a(S.target.value)},value:r,className:o,onBlur:function(S){return i(S.target.value)},bordered:s,readOnly:C}):u==="idCard"?(0,e.jsx)(K.Z,{prefix:j?(0,e.jsx)(Qe.Z,{}):void 0,onChange:function(S){return a(S.target.value)},value:r,style:d,className:o,onBlur:function(S){return i(S.target.value)},bordered:s}):u==="email"?(0,e.jsx)(K.Z,{prefix:j?(0,e.jsx)(Je.Z,{}):void 0,onChange:function(S){return a(S.target.value)},onBlur:function(S){return i(S.target.value)},value:r,style:d,className:o,bordered:s}):(0,e.jsx)(K.Z,{onChange:function(S){return a(S.target.value)},onBlur:function(S){return i(S.target.value)},value:r,suffix:f,style:d,className:o,bordered:s,readOnly:C})},Gt=g(49111),Fe=g(19650),an=g(17672),rn=function(n){var a=n.onChange,u=(0,b.useRef)(null),r=(0,b.useRef)(),f=(0,b.useRef)(),h=(0,b.useState)(0),d=(0,I.Z)(h,2),o=d[0],m=d[1];return(0,b.useEffect)(function(){var l=u.current;if(l){var i,s=new an.Z(u.current);s.addEventListener("beginStroke",function(){m(1)}),r.current=s;var v=Math.max(window.devicePixelRatio||1,1);l.width=l.offsetWidth*v,l.height=l.offsetHeight*v,(i=l.getContext("2d"))===null||i===void 0||i.scale(v,v)}},[]),(0,e.jsxs)("div",{className:"signature-pad",children:[(0,e.jsx)("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:f.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),(0,e.jsxs)("div",{className:"signature",children:[(0,e.jsx)("canvas",{ref:u,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:o!==2?"block":"none"}}),o===2&&(0,e.jsx)("img",{src:f.current||void 0})]}),(0,e.jsxs)("div",{className:"save-signature",children:[(0,e.jsx)("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),(0,e.jsx)("div",{children:(0,e.jsxs)(Fe.Z,{children:[o===1&&(0,e.jsx)(T.Z,{type:"link",onClick:function(){var i;(i=r.current)===null||i===void 0||i.clear(),m(0)},children:"\u6E05\u7A7A"}),(o===0||o===1)&&(0,e.jsx)(T.Z,{type:"primary",disabled:o!==1,ghost:!0,size:"small",onClick:function(){var i;a(r.current.toDataURL()),f.current=(i=r.current)===null||i===void 0?void 0:i.toDataURL(),m(2)},children:"\u5B8C\u6210"}),o===2&&(0,e.jsx)(T.Z,{type:"primary",ghost:!0,size:"small",onClick:function(){var i;m(0),(i=r.current)===null||i===void 0||i.clear()},children:"\u91CD\u7B7E"})]})})]})]})},ln=g(3024),sn=(0,R.Pi)(function(){var t=(0,b.useContext)(U.ZX),n=t.progressBar,a=(0,N.AK)(),u=(0,N.Rk)(),r=u.progress;return n?(0,e.jsx)(ln.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:a+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(r*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),Ie=function(n){var a,u=n.optionId,r=n.questionId,f=n.checked,h=n.checkedCount,d=(0,N.Al)(),o=d.statistics,m=o==null?void 0:o.questionStatistics[r],l=((m==null?void 0:m.optionStatistics.reduce(function(v,c){return v+c.count},0))||0)+h,i=(m==null||(a=m.optionStatistics.find(function(v){return v.optionId===u}))===null||a===void 0?void 0:a.count)||0;i=f?i+1:i;var s="".concat(Math.floor(i/l*1e3)/10,"%");return h===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("span",{className:"vote-info",children:[(0,e.jsxs)("span",{className:"vote-info-cnt ",children:[i,"\u7968"]}),(0,e.jsx)("span",{className:"vote-info-percent ",children:s}),(0,e.jsx)("div",{className:"vote-info-bar",children:(0,e.jsx)("div",{className:"vote-info-bar-fill",style:{width:s}})})]})},we=function(n){var a=n.schema,u=n.type,r=a.attribute,f=r===void 0?{}:r,h=f.examCorrectAnswer,d=(0,N.Al)(),o=d.correctAnswerVisible,m=d.mode;return h&&o&&m==="exam"?u==="FillBlank"||u==="HorzBlank"||u==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:h}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},Xt=function(n){var a=n.schema,u=a.attribute,r=u===void 0?{}:u,f=r.examScore,h=useSurvey(),d=h.mode,o=h.examScoreVisible;return f&&d==="exam"&&o?_jsxs("span",{className:"question-score",children:["\uFF08",f,"\u5206\uFF09"]}):_jsx(_Fragment,{})},un=(0,R.Pi)(function(t){var n=(0,N.Rk)(),a=n.reviewAnswer[t.qId];return a&&!a.visible?(0,e.jsx)("span",{className:"review-answer-btn",onClick:function(){a.visible=!0},children:"\u67E5\u770B\u7B54\u6848"}):(0,e.jsx)(e.Fragment,{})}),Qt=g(63185),xe=g(9676),P=g(78210),on=g(36862),dn=g(46533),cn=g(94184),ve=g.n(cn),vn=g(91220),Pe=g(15020);function Me(t,n,a,u){if(!t)return"";var r=RegExp("_{3,}","g"),f=t.matchAll(r),h=[],d=(0,vn.Z)(f),o;try{for(d.s();!(o=d.n()).done;){var m=o.value,l=m.index,i=m.index+m[0].length;h.push([l,i])}}catch(x){d.e(x)}finally{d.f()}if(h.length===0)return t;for(var s=h[0][0]===0?"":t.substring(0,h[0][0]),v=function(j){var y,C,Z=h[j],w=h[j+1],S=t.substring(Z[0],Z[1]),B=t.substring(Z[1],w?w[0]:t.length),F=n[j],E=a?a[F.id]:"";if(((y=F.attribute)===null||y===void 0?void 0:y.dataType)==="select"){var $,D;E=($=F.dataSource)===null||$===void 0||(D=$.find(function(L){return L.value===E}))===null||D===void 0?void 0:D.label}else if(((C=F.attribute)===null||C===void 0?void 0:C.dataType)==="selectDict"){var M,O;E=(M=E)===null||M===void 0||(O=M.split("|"))===null||O===void 0?void 0:O[1]}s+='<input data-id="'.concat(n[j].id,`" value='`).concat(E||"",`'  class="horz-blank" style="width:`).concat(12*S.length,'px">'),s+=B},c=0;c<h.length;c++)v(c);return s}var ge=(0,R.Pi)(function(t){var n=t.content,a=t.children,u=t.value,r=u===void 0?{}:u,f=t.onChange,h=t.onBlur,d=t.schema,o=(0,N.Rk)(),m=o.reviewAnswer[d.id];function l(i,s){var v,c;if(r[i]!==s){r[i]=s;var x=a.find(function(Z){return Z.id===i}),j=x==null||(v=x.attribute)===null||v===void 0?void 0:v.cascaderLevel,y=x==null||(c=x.attribute)===null||c===void 0?void 0:c.dictCode;y&&j&&a.filter(function(Z){var w;return((w=Z.attribute)===null||w===void 0?void 0:w.dictCode)===y&&Z.attribute.cascaderLevel&&Z.attribute.cascaderLevel>j}).forEach(function(Z){delete r[Z.id]}),(s===""||s===void 0)&&delete r[i];var C=(0,p.Z)({},r);if(Object.keys(C).length!==0)return C}}return console.log(r),(0,e.jsx)("div",{className:"pe-view",onClick:function(s){s.preventDefault(),s.stopPropagation()},children:(0,Pe.ZP)(Me(n,a),{replace:function(s){var v=s.attribs;if(!!v){var c=v["data-id"];if(c){var x,j,y,C,Z,w=(0,Pe.e_)(v),S=a.findIndex(function(q){return q.id===c}),B=a[S],F=(x=a[S-1])===null||x===void 0?void 0:x.id,E=r[F],$=(B==null||(j=B.attribute)===null||j===void 0?void 0:j.dataType)||"text",D=B==null||(y=B.attribute)===null||y===void 0?void 0:y.dictCode,M=B==null||(C=B.attribute)===null||C===void 0?void 0:C.dateTimeFormat,O=(Z=B.attribute)===null||Z===void 0?void 0:Z.cascaderLevel,L=m==null?void 0:m[c].isCorrect,H=ve()(w.className,{selected:m&&m.visible,"is-correct":m&&m.visible&&L});return(0,e.jsx)(le,(0,p.Z)((0,p.Z)({type:$,value:r[c],parentValue:E,schema:B,cascaderLevel:O,onChange:function(Y){return f(l(c,Y))},onBlur:function(Y){return h(l(c,Y))},dictCode:D,dateTimeFormat:M,bordered:!1,icon:!1},w),{},{className:H}))}}}})})}),hn=(0,R.Pi)(function(t){var n=t.qId,a=t.schema,u=t.checked,r=t.onChange,f=t.value,h=t.onBlur,d=a.id,o=a.title,m=a.attribute,l=m===void 0?{}:m,i=(0,N.Rk)(),s=i.reviewAnswer[n],v=s==null?void 0:s[d].selected,c=s==null?void 0:s[d].isCorrect,x=l.dataType;return s&&s.visible&&(v||c)?(0,e.jsxs)("label",{className:ve()("ant-checkbox-wrapper ant-checkbox-wrapper-in-form-item",{selected:v,"is-correct":c}),onClick:function(){return r(!u)},children:[(0,e.jsxs)("span",{children:[!c&&(0,e.jsx)(on.Z,{size:17,style:{color:"#ff6d56",marginRight:10,fontSize:17}}),c&&(0,e.jsx)(dn.Z,{size:17,style:{color:"#00bf6f",marginRight:10,fontSize:17}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(P.Z,{html:o})})]}):(0,e.jsxs)(xe.Z,{value:d,checked:u,onChange:function(y){return r(y.target.checked)},children:[x==="horzBlank"&&a.children?(0,e.jsx)(ge,{content:o,children:a.children,value:f,schema:a,onBlur:h,onChange:function(y){return r(!0,y)}}):(0,e.jsx)(P.Z,{html:o}),(0,e.jsx)(we,{schema:t.schema})]})}),Jt=g(88983),je=g(66253),Re=g(43061),Te=g(38819),fn=g(91508),mn=(0,R.Pi)(function(t){var n=t.qId,a=t.schema,u=t.onBlur,r=t.onChange,f=t.value,h=a.id,d=a.title,o=a.attribute,m=(0,N.Rk)(),l=m.reviewAnswer[n],i=l==null?void 0:l[h].selected,s=l==null?void 0:l[h].isCorrect,v=b.useContext(fn.ZP),c=o==null?void 0:o.dataType;return l&&l.visible&&(i||s)?(0,e.jsxs)("label",{className:ve()("ant-radio-wrapper ant-radio-wrapper-in-form-item radio-item",{selected:i,"is-correct":s}),onClick:function(){var j;return v==null||(j=v.onChange)===null||j===void 0?void 0:j.call(v,{target:{value:h}})},children:[(0,e.jsxs)("span",{children:[!s&&(0,e.jsx)(Re.Z,{style:{color:"#ff6d56",marginRight:10}}),s&&(0,e.jsx)(Te.Z,{style:{color:"#00bf6f",marginRight:10}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(P.Z,{html:d})})]}):(0,e.jsxs)(je.ZP,{value:h,className:"radio-item",children:[c==="horzBlank"&&a.children?(0,e.jsx)(ge,{schema:a,content:d,children:a.children,value:typeof f=="boolean"?{}:f,onBlur:u,onChange:r}):(0,e.jsx)(P.Z,{html:d}),(0,e.jsx)(we,{schema:t.schema})]})}),xn=(0,R.Pi)(function(t){var n=t.schema,a=t.value,u=t.onChange,r=t.qId,f=t.onBlur,h=(0,N.AK)("-body-question"),d=n.id,o=n.attribute,m=o==null?void 0:o.suffix,l=o==null?void 0:o.dataType,i=o==null?void 0:o.dictCode,s=o==null?void 0:o.dateTimeFormat,v=o==null?void 0:o.readOnly,c=(0,N.Rk)(),x=c.reviewAnswer[r],j=x==null?void 0:x[d].isCorrect;return x&&x.visible?(0,e.jsxs)("span",{style:{position:"relative"},children:[!j&&(0,e.jsx)(Re.Z,{style:{color:"#ff6d56",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),j&&(0,e.jsx)(Te.Z,{style:{color:"#00bf6f",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),(0,e.jsx)(le,{type:l,value:a[d],readOnly:v,className:ve()("selected",{"is-correct":j}),onChange:function(C){return u(C)},onBlur:f,style:{paddingLeft:20},suffix:m&&(0,e.jsx)("span",{className:h+"-option-suffix",children:(0,e.jsx)(P.Z,{html:m})})})]}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(le,{type:l,value:a[d],onChange:function(C){return u(C)},onBlur:f,readOnly:v,dictCode:i,dateTimeFormat:s,suffix:m&&(0,e.jsx)("span",{className:h+"-option-suffix",children:(0,e.jsx)(P.Z,{html:m})})})})}),qt=g(65011),_t=g(48736),ea=g(402),gn=g(20294),jn=ce.Z.Option,Ce=gn.Z.Text,na=function(n){var a=n.onChange,u=n.form,r=n.record,f=useState(n.value),h=_slicedToArray(f,2),d=h[0],o=h[1],m=useState(n.value),l=_slicedToArray(m,2),i=l[0],s=l[1];useEffect(function(){s(n.value)},[n.value]);var v=useState([{id:"1",drugName:"\u6D4B\u8BD5\u7528\u836F",chemicalName:"hahah11",stCompName:"\u4E0A\u6D77\u5236\u836F\u5382"},{id:"2",drugName:"\u6D4B\u8BD5\u7528\u836F1",chemicalName:"hahah11",stCompName:"\u5E7F\u4E1C\u5236\u836F\u5382"}]),c=_slicedToArray(v,2),x=c[0],j=c[1],y=useThrottleCallback(function(C){},4);return _jsx(_AutoComplete,{showSearch:!0,placeholder:"\u70B9\u51FB\u641C\u7D22",value:i,dropdownMatchSelectWidth:!1,onBlur:function(){s(d),d?a==null||a(d):a==null||a(void 0)},onSelect:function(Z){o(Z),s(Z)},allowClear:!0,onClear:function(){o(void 0),s(void 0),a==null||a(void 0)},onSearch:function(Z){s(Z),y(Z)},dropdownRender:function(Z){return _jsxs(_Fragment,{children:[Z,_jsx(_Divider,{style:{margin:"8px 0"}}),_jsxs(_Space,{align:"center",style:{padding:"0 8px 4px"},children:[_jsx(Ce,{children:"\u836F\u7269\u540D\u79F0"}),_jsx(Ce,{type:"secondary",style:{fontSize:12},children:"(\u5546\u54C1\u540D-\u5382\u5BB6)"})]})]})},children:x.map(function(C){return _jsxs(jn,{value:C.drugName,children:[_jsxs(Ce,{children:[" ",C.drugName]}),_jsxs(Ce,{type:"secondary",style:{fontSize:12,marginLeft:5},children:["(",C.chemicalName,"-",C.stCompName,")"]})]},C.id)})})},Cn=(0,R.Pi)(function(t){var n,a=t.schema,u=t.title,r=t.onBlur,f=t.onChange,h=a.type,d=((n=a.children)===null||n===void 0?void 0:n.filter(function(l){var i;return(i=l.attribute)===null||i===void 0?void 0:i.fieldInTitle}))||[],o=(0,R.U$)(),m=o.value;return h!=="HorzBlank"||d.length===0?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(P.Z,{html:u})}):(0,e.jsx)(ge,{schema:a,children:d,content:u,onChange:f,onBlur:r,value:m})}),yn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M839 73.9c-1.2-2.4-3.7-9.8-7.4-9.8s-11.1 8.6-13.5 12.3l-13.5 12.3c-7.4-6.1-35.6-23.4-43-23.4-11.1 0-104.6 113.2-118.1 129.1l-60.2 68.8-30.7 38.1-43.1-83.6-50.4-100.8c-4.9-9.8-8.6-22.1-22.1-22.1-7.3 0-9.8 3.6-13.5 9.8-3.7 4.9-3.7 4.9-11.1 8.6-8.6 0-12.3 0-19.7 6.2-6.2-4.9-11.1-11.1-19.7-11.1-3.7 0-6.2 1.2-8.6 3.6l-8.6 7.4c-4.8 6.1-15.9 17.2-15.9 25.8 0 11 9.8 31.9 13.5 41.8l90.9 250.8-14.7 17.3c-66.4 79.8-159.8 190.5-210.2 279l-29.5 50.4c-8.6 14.7-29.5 44.3-29.5 60.2 0 3.7 3.8 6.2 6.2 8.6 8.6 7.3 3.6 14.7 1.2 24.5-2.5 7.4-3.7 12.3-3.7 19.7 0 13.5 11.1 27 18.5 38.1 7.3 12.2 9.9 24.5 25.8 24.5 17.2 0 49.2-3.6 63.9-14.7l243.4-377.5 115.6 178.5c6.1 9.8 30.7 54.1 46.7 54.1 14.8 0 38.1-16.1 40.6-30.8-2.6-4.9-6.2-12.3-6.2-17.2 0-7.5 19.7-14.9 24.6-19.7v-9.9c8.6-3.7 13.5-8.6 17.2-17.2l-95.9-205.3-38.2-76.3 13.6-19.7 174.6-225.9c11-14.8 28.3-38.1 41.8-50.4 4.9-5 13.5-12.3 13.5-19.7 0-8.6-19.7-22.1-24.6-34.4z","p-id":"14396",fill:"#fe6c56"})}),Zn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M389.7 604.3L198.2 447.4c-3.7-3-9.1-3-12.8 0.1l-73.3 61.4c-4.4 3.7-4.8 10.3-0.9 14.5l324.1 344.3c5 5.3 13.8 3.6 16.6-3.1 64.4-160.1 244.3-452.8 463.2-664.7 3-2.9 3.9-7.2 2.3-11l-13.7-33c-2.4-5.8-9.5-8-14.7-4.5-243.2 157.7-419.4 353.5-499.3 452.9z",fill:"#fe6c56","p-id":"4913"})}),pn=(0,R.Pi)(function(t){var n,a=t.schema,u=t.seqNo,r=(0,N.Rk)(),f=r.props.correctAnswerVisible,h=r.props.questionScore,d=(n=a.attribute)===null||n===void 0?void 0:n.examAnswerMode;return!f||!h||d==="none"?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{className:"exam-score-info",children:[(0,e.jsxs)("span",{children:["\u7B2C",u,"\u9898"]}),h[a.id]?(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("span",{className:"score",children:["\u5F97\u5206:",h[a.id],"\u5206"]}),Zn]}):yn]})}),ta=g(71194),bn=g(50146);function $e(t){return t?t.substring(0,t.lastIndexOf("[")):"\u70B9\u51FB\u9009\u62E9"}var Sn=function(n){var a=n.onChange,u=n.value,r=n.mapMove,f=r===void 0?!1:r,h=n.optionId,d=(0,b.useRef)(null),o=(0,b.useRef)(),m=(0,b.useRef)(),l=(0,b.useRef)(),i=(0,b.useState)(function(){if(!!u){var E=u.match(/\[(\d+\.\d+),\s*(\d+\.\d+)\]/);if(E&&E.length>2)return[parseFloat(E[1]),parseFloat(E[2])]}}),s=(0,I.Z)(i,2),v=s[0],c=s[1],x=(0,b.useState)(function(){return $e(u)}),j=(0,I.Z)(x,2),y=j[0],C=j[1],Z=(0,b.useState)(!1),w=(0,I.Z)(Z,2),S=w[0],B=w[1],F=(0,b.useCallback)(function(E){m.current.getLocation(E,function($,D){if($==="complete"&&D.geocodes.length){var M=D.geocodes[0].location;l.current.start(M)}else console.error("\u6839\u636E\u5730\u5740\u67E5\u8BE2\u4F4D\u7F6E\u5931\u8D25")})},[]);return(0,b.useEffect)(function(){if(!!S){window["localMap".concat(h)]=function(){initAMapUI(),AMapUI.loadUI(["misc/PositionPicker"],function(O){var L=new AMap.Map("map-".concat(h),{zoom:16,center:v,dragEnable:f,zoomEnable:f});if(o.current=L,f){var H=new O({mode:"dragMarker",map:L});H.on("success",function(_){C(_.address),c([_.position.lng,_.position.lat])}),v?H.start(v):H.start(),L.panBy(0,1),l.current=H}var q=new AMap.Geocoder({city:"010"});m.current=q;var Y=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,offset:[10,20],zoomToAccuracy:!0,position:"RB"});Y.getCurrentPosition(function(_,oe){_=="complete"?(L.setCenter(oe.position),C(oe.formattedAddress),c([oe.position.lng,oe.position.lat])):console.error(oe)})})},window._AMapSecurityConfig={securityJsCode:"c92dc7c089f25dcd7944094d3ee1a959"};var E="https://webapi.amap.com/maps?v=1.4.15&key=fce3217057b3ace0b2128cb5d1696c87&callback=localMap".concat(h,"&plugin=AMap.Geocoder,AMap.Geolocation"),$=document.createElement("script");$.src=E,document.head.appendChild($);var D="https://webapi.amap.com/ui/1.1/main-async.js",M=document.createElement("script");M.src=D,document.head.appendChild(M)}},[S]),(0,e.jsxs)("div",{style:{position:"relative"},children:[(0,e.jsx)(K.Z.TextArea,{readOnly:!0,value:$e(u),onClick:function(){return B(!0)}}),(0,e.jsxs)(bn.Z,{open:S,onCancel:function(){B(!1)},onOk:function(){v&&a("".concat(y,"[").concat(v[0],", ").concat(v[1],"]")),B(!1)},children:[(0,e.jsx)("div",{style:{display:"flex",justifyContent:"space-between",width:200},children:f&&(0,e.jsx)(K.Z.Search,{placeholder:"\u8BF7\u8F93\u5165\u8981\u641C\u7D22\u7684\u5730\u70B9\u3001\u8857\u9053",size:"small",onSearch:function($){return F($)}})}),(0,e.jsx)("div",{ref:d,id:"map-".concat(h),style:{height:390}}),(0,e.jsx)("div",{style:{height:50,borderTop:"1px solid #b0b0b0",background:"#fff",padding:"12px 18px"},children:y})]})]})},wn=(0,R.Pi)(function(t){var n,a,u=t.qId,r=t.schema,f=(0,N.Rk)(),h=f.reviewAnswer[u],d=(n=r.children)===null||n===void 0?void 0:n.map(function(i){var s;return(s=i.attribute)===null||s===void 0?void 0:s.examCorrectAnswer}).filter(function(i){return i}).join(";"),o=d&&["FillBlank","MultipleBlank","Textarea","HorzBlank"].includes(r.type),m=function(){return o?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u6B63\u786E\u7B54\u6848\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",style:{marginBottom:10},children:d})]}):(0,e.jsx)(e.Fragment,{})},l=function(){var s;if((s=r.attribute)!==null&&s!==void 0&&s.examAnalysis){var v;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u7B54\u6848\u89E3\u6790\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",children:(0,e.jsx)(P.Z,{html:(v=r.attribute)===null||v===void 0?void 0:v.examAnalysis})})]})}return(0,e.jsx)(e.Fragment,{})};return h&&h.visible&&((a=r.attribute)!==null&&a!==void 0&&a.examAnalysis||o)?(0,e.jsxs)("div",{className:"answer-analysis",children:[m(),l()]}):(0,e.jsx)(e.Fragment,{})});function Bn(t){var n=t.schema,a=t.index,u=t.qsIndex,r=t.required,f=t.error,h=t.replaceTitle,d=t.seqNo,o=t.onBlur,m=t.onChange,l=t.onFocus,i=(0,b.useContext)(U.ZX),s=i.questionNumber,v=i.requiredVisible,c=(0,N.AK)("-body-question"),x=(0,b.useState)(),j=(0,I.Z)(x,2),y=j[0],C=j[1],Z=n.description;(0,b.useEffect)(function(){if(y){var B,F;(B=document.querySelector("[data-id='".concat(n.id,"']")))===null||B===void 0||B.classList.remove("ant-form-item-has-error"),(F=document.querySelector("[data-id='".concat(n.id,"']")))===null||F===void 0||F.querySelectorAll("[data-id]").forEach(function(H){H.classList.remove("ant-form-item-has-error")})}if(f.length>0){var E,$=f[0].split("^"),D=(0,I.Z)($,2),M=D[0],O=D[1],L;O?(L=document.querySelector("[data-id='".concat(M,"']")),C(O)):(L=document.querySelector("[data-id='".concat(n.id,"']")),C(M)),(E=L)===null||E===void 0||E.classList.add("ant-form-item-has-error")}else y&&C(void 0)},[f]);var w="";u!==void 0&&(w+=u+1+"-"),a!==void 0&&(w+=a+1+".");var S=function(){return y?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:y})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsxs)("section",{className:c,children:[(0,e.jsx)("div",{className:"".concat(c,"-head"),children:(0,e.jsxs)("span",{className:c+"-header",children:[(0,e.jsx)(pn,{schema:n,seqNo:d}),(0,e.jsxs)("h2",{className:c+"-header-title",children:[s&&(0,e.jsx)("span",{className:c+"-header-title-seq",children:(0,e.jsx)("b",{children:s?d||w:""})}),r&&v&&(0,e.jsx)("span",{className:c+"-header-title-required",children:(0,e.jsx)("i",{children:"*"})}),(0,e.jsx)("div",{className:c+"-header-title-text",children:(0,e.jsx)(Cn,{schema:n,title:h||n.title,onBlur:o,onChange:m,onFocus:l})}),S()]}),Z&&(0,e.jsx)("div",{className:"question-desc",children:(0,e.jsx)(Q.hl,{html:Z})})]})}),(0,e.jsxs)("div",{className:"".concat(c,"-body"),children:[t.children,(0,e.jsx)(un,{qId:n.id}),(0,e.jsx)(wn,{qId:n.id,schema:n})]})]})}(0,A.eC)("Question",(0,R.Pi)(Bn),"antd");function Nn(t){var n=t.schema,a=t.index,u=t.seqNo,r=(0,N.AK)("-body-questionSet"),f=(0,b.useContext)(U.ZX),h=f.questionNumber;return(0,e.jsxs)("div",{className:r,children:[(0,e.jsxs)("div",{className:r+"-title",children:[h?u||"".concat(a+1,"."):"",(0,e.jsx)(P.Z,{html:n.title})]}),t.children,(0,e.jsx)("div",{className:r+"-splitLine"})]})}(0,A.eC)("QuestionSet",Nn,"antd");var aa=g(84305),An=g(88182),En=g(82925),ra=g(22385),Fn=g(94199),he=g(93224),In=g(39017),Pn=g(49914),Mn=g(78338);function Rn(t){t=Number(t);var n=Math.floor(t/3600),a=Math.floor(t%3600/60),u=Math.floor(t%3600%60),r="".concat(n).padStart(2,"0"),f="".concat(a).padStart(2,"0"),h="".concat(u).padStart(2,"0");return"".concat(r,":").concat(f,":").concat(h)}function Tn(t){return t<=60?"#ff4d4f":t<=180?"#faad14":"#52c41a"}var $n=(0,R.Pi)(function(){var t,n,a=(0,Pn.H)(),u=(0,In.Rk)(),r=a.startTime,f=((t=a.project)===null||t===void 0||(n=t.setting.examSetting)===null||n===void 0?void 0:n.maxSubmitMinutes)||0,h=(0,b.useState)(0),d=(0,I.Z)(h,2),o=d[0],m=d[1],l=r+f*60*1e3,i=(0,b.useRef)();return(0,b.useEffect)(function(){if(f!==0)return i.current=window.setInterval(function(){m((l-new Date().getTime())/1e3)},1e3),function(){clearInterval(i.current)}},[l]),(0,b.useEffect)(function(){o<0&&(u.submit(),clearInterval(i.current))},[o]),f===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{style:{position:"absolute",right:0,fontSize:13},children:[(0,e.jsx)(Mn.Z,{style:{marginRight:5,color:"#1890ff"}}),"\u5269\u4F59:",(0,e.jsx)("span",{style:{marginLeft:3,color:Tn(o)},children:Rn(o)})]})}),Dn=["size","marked"],De=(0,R.Pi)(function(t){var n=(0,N.Rk)(),a=n.props.answerSheetVisible,u=t.size,r=t.marked,f=r===void 0?!0:r,h=(0,he.Z)(t,Dn);return a?(0,e.jsx)(Fn.Z,{title:"\u6807\u8BB0",children:(0,e.jsx)("svg",(0,p.Z)((0,p.Z)({viewBox:"0 0 1024 1024",version:"1.1",width:t.size||24,height:t.size||24,className:"marked"},h),{},{children:(0,e.jsx)("path",{d:"M662.04973405 329.56834123l108.40905238-142.19888693c4.22372932-5.63163908 4.22372932-11.26327817 1.40790978-18.30282702-2.81581955-5.63163908-8.44745863-9.8553684-15.48700748-9.85536841H218.55815604c-9.8553684 0-16.89491725 7.03954885-16.89491725 16.89491726V867.38987389c0 9.8553684 7.03954885 16.89491725 16.89491725 16.89491726s16.89491725-7.03954885 16.89491726-16.89491726V487.25423562h522.33452519c7.03954885 0 12.67118794-4.22372932 15.48700749-9.8553684s1.40790977-12.67118794-2.81581955-18.30282703l-108.40905238-129.52769896z",fill:f?"#EA4942":"#d8d8d8","p-id":"1287"})}))}):(0,e.jsx)(e.Fragment,{})}),On=(0,R.Pi)(function(t){var n=(0,N.Rk)(),a=t.finished,u=t.id,r=t.marked,f=t.seqNo;return(0,e.jsxs)("div",{className:ve()("answer-sheet-item",{marked:r,finished:a}),onClick:function(){return n.changePageIndex(u)},children:[f,r&&(0,e.jsx)(De,{style:{position:"absolute",left:20,bottom:18},size:18})]})}),Ln=(0,R.Pi)(function(){var t=(0,N.Rk)(),n=t.answerSheet;return(0,e.jsx)(e.Fragment,{children:n.filter(function(a){return a.display!=="none"}).map(function(a,u){return(0,b.createElement)(On,(0,p.Z)((0,p.Z)({},a),{},{seqNo:u+1,key:a.id}))})})}),Hn=(0,R.Pi)(function(){var t=(0,N.Rk)(),n=t.answerSheet,a=n.filter(function(f){return f.finished}).length,u=n.filter(function(f){return!f.finished}).length,r=n.filter(function(f){return f.marked}).length;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"finished",children:["\u5DF2\u7B54",(0,e.jsx)("span",{style:{marginLeft:4},children:a})]}),(0,e.jsxs)("div",{className:"unFinished",children:["\u672A\u7B54",(0,e.jsx)("span",{style:{marginLeft:4},children:u})]}),(0,e.jsxs)("div",{className:"marked",children:[(0,e.jsx)(De,{size:18}),"\u6807\u8BB0",(0,e.jsx)("span",{style:{marginLeft:4},children:r})]})]})}),zn=(0,R.Pi)(function(){return(0,e.jsxs)("div",{className:"answer-sheet-header",children:["\u7B54\u9898\u5361",(0,e.jsx)($n,{})]})}),kn=(0,R.Pi)(function(){var t=(0,N.Rk)(),n=t.props.answerSheetVisible;return n?(0,e.jsxs)("div",{className:"answer-sheet",children:[(0,e.jsx)(zn,{}),(0,e.jsx)("div",{className:"answer-sheet-content",children:(0,e.jsx)(Ln,{})}),(0,e.jsx)("div",{className:"answer-sheet-footer",children:(0,e.jsx)(Hn,{})})]}):(0,e.jsx)(e.Fragment,{})});Se().locale("zh-cn");function Un(t){var n=t.headerVisible,a=t.footerVisible,u=t.schema,r=(0,N.AK)(),f=(0,N.Al)(),h=function(){var o,m=(o=u.attribute)===null||o===void 0?void 0:o.headerImage;if(m)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(m),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:ve()(r,{preview:f.isPreview}),children:[(0,e.jsx)(sn,{}),(0,e.jsx)("div",{className:r+"-banner",children:h()}),n&&(0,e.jsx)(re,{}),(0,e.jsx)(An.ZP,{locale:En.Z,children:(0,e.jsx)(te,{children:t.children})}),a&&(0,e.jsx)(ee,{}),(0,e.jsx)(kn,{})]})}(0,A.eC)("Survey",Un,"antd");var ia=g(13062),J=g(71230),la=g(89032),G=g(15746),W=g(32059);function Vn(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children;function h(d,o){a((0,W.Z)({},o,d))}return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(d){var o=d.id,m=d.title,l=d.attribute,i=l===void 0?{}:l,s=i.mapMove;return(0,e.jsxs)(J.Z,{gutter:[10,0],"data-id":o,children:[m&&(0,e.jsx)(G.Z,{span:24},d.id),(0,e.jsx)(G.Z,{span:24,children:(0,e.jsx)(Sn,{optionId:o,onChange:function(c){return h(c,o)},value:r[o],mapMove:s})})]},o)})})}(0,A.RM)("Address",Vn,"antd");var sa=g(43185),ye=g(32620),ua=g(34792),Oe=g(48086),Ze=g(39428),Le=g(3182),Wn=g(81473);function Kn(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=t.readOnly,h=n.children,d=h===void 0?[]:h,o=(0,N.Al)(),m=function(){var l=(0,Le.Z)((0,Ze.Z)().mark(function i(s){var v,c,x,j;return(0,Ze.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:v=s.onSuccess,c=s.onError,x=s.file,j=s.onProgress,o.onUpload&&o.onUpload({file:x,fileType:6},function(Z){j&&j({percent:Z.loaded/Z.total*100})}).then(function(Z){if(Z.success&&v&&(v(Z.data),Z.data.content&&a((0,W.Z)({},d[0].id,Z.data.content))),!Z.success&&c){var w=new Error("Some error");c({event:w})}});case 2:case"end":return C.stop()}},i)}));return function(s){return l.apply(this,arguments)}}();return(0,e.jsx)("div",{children:d==null?void 0:d.map(function(l){var i=l.id,s=l.attribute,v=s===void 0?{}:s,c=v.cameraOnly;return(0,e.jsx)(J.Z,{style:{marginBottom:10},"data-id":i,children:(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(K.Z,{placeholder:"\u70B9\u51FB\u8BC6\u522B\u6761\u7801",value:r[i],addonAfter:(0,e.jsx)(ye.Z,{accept:"image/*",capture:c?"environment":void 0,disabled:f,maxCount:1,beforeUpload:function(j){return v!=null&&v.maxFileSize&&j.size>v.maxFileSize*1024*1024?(Oe.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(v.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),ye.Z.LIST_IGNORE):!0},customRequest:m,showUploadList:!1,children:(0,e.jsx)(Wn.Z,{})},i)})})},i)})})}(0,A.RM)("Barcode",Kn,"antd");var oa=g(36877),Yn=g(18480);function Gn(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f;function d(o){var m={};o.forEach(function(l,i){var s=h[i].id;m[s]=l}),a(m)}return(0,e.jsx)(J.Z,{children:(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(Yn.Z,{value:h.map(function(o){return r[o.id]}).filter(function(o){return o}),style:{width:260},options:n.dataSource,onChange:d,placeholder:"\u8BF7\u9009\u62E9"})})})}(0,A.RM)("Cascader",Gn,"antd");function Xn(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=t.onBlur,h=n.children,d=n.attribute,o=24/((d==null?void 0:d.columns)||1),m=(0,N.AK)("-body-question"),l=!!(d!=null&&d.statEnabled);function i(s,v,c){return v?r[s]=c||!0:delete r[s],(0,p.Z)({},r)}return(0,b.useEffect)(function(){h==null||h.forEach(function(s){var v;(v=s.attribute)!==null&&v!==void 0&&v.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},s.id,!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(J.Z,{children:h==null?void 0:h.map(function(s){var v,c,x,j=s.id,y=(v=s.attribute)===null||v===void 0?void 0:v.dataType,C=(c=s.attribute)===null||c===void 0?void 0:c.suffix,Z=(x=s.attribute)===null||x===void 0?void 0:x.readOnly;return(0,e.jsxs)(G.Z,{span:o,className:m+"-option","data-id":j,children:[(0,e.jsx)(hn,{qId:n.id,schema:s,checked:r.hasOwnProperty(j),onChange:function(S,B){return a(i(j,S,B))},value:typeof r[j]=="boolean"?{}:r[j],onBlur:f}),l&&(0,e.jsx)(Ie,{checked:!!r[j],optionId:j,questionId:n.id,checkedCount:Object.keys(r).length}),y&&(0,e.jsx)(le,{value:typeof r[j]=="boolean"?"":r[j],style:{maxWidth:200},type:y,onChange:function(S){return a(i(j,!0,S))},onBlur:function(S){return f(i(j,!0,S))},readOnly:Z,suffix:C&&(0,e.jsx)("span",{className:m+"-option-suffix",children:(0,e.jsx)(P.Z,{html:C})})})]},j)})})})}(0,A.RM)("Checkbox",Xn,"antd");var da=g(71153),He=g(60331),ca=g(62999),Qn=g(54680),se=g(3980),Jn=g(60780),qn=g.n(Jn);function _n(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=h[0].id,o=(0,b.useState)([]),m=(0,I.Z)(o,2),l=m[0],i=m[1];function s(c){d&&((c==null?void 0:c.length)===0?a(void 0):a((0,W.Z)({},d,c==null?void 0:c.map(function(x){return x.value}))))}var v=(0,b.useMemo)(function(){return qn()(l.map(function(c){return{title:c.name,key:c.id,value:c.id,parentId:c.parentId}}),{parentProperty:"parentId",customID:"key"})},[l]);return(0,b.useEffect)(function(){se.hi.selectDept({}).then(function(c){c.success&&i(c.data)})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(G.Z,{span:24,children:(0,e.jsx)(Qn.Z,{style:{width:"100%"},treeCheckable:!0,value:(r[d]||[]).map(function(c){return{value:c}}),treeCheckStrictly:!0,showCheckedStrategy:"SHOW_ALL",dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:v,placeholder:"\u8BF7\u9009\u62E9",treeDefaultExpandAll:!0,onChange:s,showSearch:!1})})})}var et=function(n){var a=n.schema,u=n.value,r=u===void 0?{}:u,f=a.children,h=f===void 0?[]:f,d=h[0].id,o=(0,b.useState)([]),m=(0,I.Z)(o,2),l=m[0],i=m[1];return(0,b.useEffect)(function(){se.hi.selectDept({selected:r[d]||[],name:"^_^"}).then(function(s){s.success&&i(s.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Fe.Z,{children:l.map(function(s){return(0,e.jsx)(He.Z,{color:"blue",children:s.name},s.id)})})})};(0,A.RM)("Dept",_n,"antd"),(0,A.cf)("Dept",et,"antd");function ze(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=t.onBlur,h=n.children,d=(0,N.AK)("-body-question");function o(l,i){r[l]=i,i===""&&delete r[l],a((0,p.Z)({},r),l)}function m(l,i){r[l]=i,i===""&&delete r[l],f((0,p.Z)({},r),l)}return(0,e.jsx)("div",{children:h==null?void 0:h.map(function(l){var i=l.id,s=l.title;return(0,e.jsxs)(J.Z,{style:{marginBottom:10},"data-id":i,children:[s&&(0,e.jsx)(G.Z,{className:d+"-option",span:4,children:l.title&&(0,e.jsx)("span",{className:d+"-option-title",children:(0,e.jsx)(P.Z,{html:l.title})})},l.id),(0,e.jsxs)(G.Z,{span:12,className:d+"-option",children:[(0,e.jsx)(xn,{qId:n.id,schema:l,value:r,onChange:function(c){return o(i,c)},onBlur:function(c){return m(i,c)}}),(0,e.jsx)(we,{schema:l,type:n.type})]})]},i)})})}(0,A.RM)("FillBlank",ze,"antd"),(0,A.RM)("MultipleBlank",ze,"antd");function nt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=t.onBlur,h=n.children,d=n.attribute,o=d===void 0?{}:d,m=o.content;return!m||!h?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(ge,{schema:n,children:h.filter(function(l){var i;return!((i=l.attribute)!==null&&i!==void 0&&i.fieldInTitle)}),content:m,onBlur:f,onChange:a,value:r})}var tt=function(n){var a=n.schema,u=n.value,r=a.children,f=a.attribute,h=f===void 0?{}:f,d=h.content;return(0,e.jsx)("div",{className:"preview pe-view",children:(0,e.jsx)(P.Z,{html:Me(d,r,u),replaceP:!1},Math.random())})};(0,A.RM)("HorzBlank",nt,"antd"),(0,A.cf)("HorzBlank",tt,"antd");var Be=g(83279),ue=g(79521),at=g(54121),rt=function(n){var a=(0,se.XI)(200),u=(0,I.Z)(a,2),r=u[0],f=u[1],h=(0,se.XI)(200),d=(0,I.Z)(h,2),o=d[0],m=d[1];return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},n.getRowProps()),{},{className:"tr",style:{position:"relative"},ref:r,children:[n.cells.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getCellProps()),{},{className:"td","data-id":"".concat(n.i,"-").concat(l.column.id),children:l.render("Cell")}))}),n.onDelete&&(0,e.jsx)("div",{ref:o,style:{position:"absolute",left:-20,top:0,height:48,width:24,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(at.Z,{onClick:function(){n.onDelete()},style:{color:"#f5222d",cursor:"pointer",visibility:f||m?"visible":"hidden"}})})]}))};function ke(t){var n=t.columns,a=t.data,u=t.onAdd,r=t.onDelete,f=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),h=(0,ue.useTable)({columns:n,data:a,defaultColumn:f},ue.useBlockLayout),d=h.getTableProps,o=h.getTableBodyProps,m=h.headerGroups,l=h.rows,i=h.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},d()),{},{className:"table",children:[(0,e.jsx)("div",{children:m.map(function(s){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},s.getHeaderGroupProps()),{},{className:"tr",children:s.headers.map(function(v){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},v.getHeaderProps()),{},{className:"th",children:v.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},o()),{},{children:l.map(function(s,v){return i(s),(0,b.createElement)(rt,(0,p.Z)((0,p.Z)({},s),{},{key:v,i:v,onDelete:r?function(){return r(v)}:void 0}))})})),u&&(0,e.jsx)("div",{className:"footer",onClick:u,children:"+ \u7EE7\u7EED\u586B\u5199"})]}))}function it(t){var n=t.schema,a=t.onChange,u=t.value||[{}],r=n.children,f=r===void 0?[]:r,h=(0,b.useMemo)(function(){return f.map(function(d){var o;return{Header:(0,e.jsx)(P.Z,{html:d.title}),width:(o=d.attribute)===null||o===void 0?void 0:o.width,accessor:d.id,Cell:function(l){var i,s=l.value,v=l.row,c=l.data;if(((i=d.attribute)===null||i===void 0?void 0:i.dataType)==="select"){var x;return(0,e.jsx)(ce.Z,{placeholder:"\u8BF7\u9009\u62E9",value:s,style:{minWidth:80},onChange:function(y){c[v.index][d.id]=y},options:((x=d.dataSource)===null||x===void 0?void 0:x.map(function(j){return{label:j.label,value:j.value}}))||[]})}else return(0,e.jsx)(K.Z,{value:s,onChange:function(y){c[v.index][d.id]=y.target.value,a((0,Be.Z)(c))}})}}})},[]);return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(ke,{columns:h,data:u,onAdd:function(){u.push({}),a((0,Be.Z)(u))},onDelete:function(o){u.splice(o,1),a((0,Be.Z)(u))}})})}var lt=function(n){var a=n.schema,u=n.value||[{},{}],r=a.children,f=r===void 0?[]:r,h=(0,b.useMemo)(function(){return f.map(function(d){var o;return{Header:(0,e.jsx)(P.Z,{html:d.title}),width:(o=d.attribute)===null||o===void 0?void 0:o.width,accessor:d.id,Cell:function(l){var i,s=l.value,v=l.row,c=l.data;if(((i=d.attribute)===null||i===void 0?void 0:i.dataType)==="select"){var x,j,y=((x=d.dataSource)===null||x===void 0||(j=x.find(function(C){return C.value===s}))===null||j===void 0?void 0:j.label)||"";return(0,e.jsx)("span",{children:y})}else return(0,e.jsx)("span",{children:s})}}})},[]);return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(ke,{columns:h,data:u})})};(0,A.RM)("MatrixAuto",it,"antd"),(0,A.cf)("MatrixAuto",lt,"antd");var st=["title","rowId"],ut=["title","rowId"];function Ue(t){var n=t.columns,a=t.data,u=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ue.useTable)({columns:n,data:a,defaultColumn:u},ue.useBlockLayout),f=r.getTableProps,h=r.getTableBodyProps,d=r.headerGroups,o=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:d.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},h()),{},{children:o.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td",children:i.render("Cell")}))})}))})}))]}))}function ot(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=n.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var i,s=h.map(function(v){var c;return{Header:(0,e.jsx)(P.Z,{html:v.title}),width:(c=v.attribute)===null||c===void 0?void 0:c.width,accessor:v.id,Cell:function(j){var y,C=j.value,Z=j.row,w=j.data,S=(y=v.attribute)===null||y===void 0?void 0:y.dataType;return(0,e.jsxs)("div",{onClick:function(F){var E=!C,$={};w.forEach(function(D,M){var O=D.title,L=D.rowId,H=(0,he.Z)(D,st);Z.index===M&&(E?H[v.id]=!0:delete H[v.id]),$[L]=H}),a($)},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,e.jsx)(xe.Z,{checked:!!C}),S?(0,e.jsx)(le,{type:S,style:{width:120,marginLeft:5},value:C===!0?"":C,onChange:function(F){var E={};w.forEach(function($,D){var M=$.title,O=$.rowId,L=(0,he.Z)($,ut);Z.index===D&&(L[v.id]=F),E[O]=L}),a(E)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return s.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=n.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),s},[]),l=o.map(function(i,s){var v=i.id,c=r[v]||{};return(0,p.Z)({title:(0,e.jsx)(P.Z,{html:i.title}),rowId:v},c)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(Ue,{columns:m,data:l})})}var dt=function(n){var a=n.schema,u=n.value,r=u===void 0?{}:u,f=a.children,h=f===void 0?[]:f,d=a.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var i,s=h.map(function(v){var c;return{Header:(0,e.jsx)(P.Z,{html:v.title}),width:(c=v.attribute)===null||c===void 0?void 0:c.width,accessor:v.id,Cell:function(j){var y=j.value,C=j.row,Z=j.data;return y?(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:!!y,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return s.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=a.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),s},[]),l=o.map(function(i,s){var v=i.id,c=r[v]||{};return(0,p.Z)({title:(0,e.jsx)(P.Z,{html:i.title}),rowId:v},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(Ue,{columns:m,data:l})})};(0,A.RM)("MatrixCheckbox",ot,"antd"),(0,A.cf)("MatrixCheckbox",dt,"antd");var ct=["title","rowId"];function Ve(t){var n=t.columns,a=t.data,u=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ue.useTable)({columns:n,data:a,defaultColumn:u},ue.useBlockLayout),f=r.getTableProps,h=r.getTableBodyProps,d=r.headerGroups,o=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:d.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},h()),{},{children:o.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td","data-id":"".concat(l.original.rowId,"-").concat(i.column.id),children:i.render("Cell")}))})}))})}))]}))}function vt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=n.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var i,s=h.map(function(v){var c;return{Header:(0,e.jsx)(P.Z,{html:v.title}),width:(c=v.attribute)===null||c===void 0?void 0:c.width,accessor:v.id,Cell:function(j){var y=j.value,C=j.row,Z=j.data;return(0,e.jsx)(le,{value:y,onChange:function(S){var B={};Z.forEach(function(F,E){var $=F.title,D=F.rowId,M=(0,he.Z)(F,ct);C.index===E&&(M[v.id]=S),B[D]=M}),a(B)}})}}});return s.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=n.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),s},[]),l=o.map(function(i,s){var v=i.id,c=r[v]||{};return(0,p.Z)({title:(0,e.jsx)(P.Z,{html:i.title}),rowId:v},c)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(Ve,{columns:m,data:l})})}var ht=function(n){var a=n.schema,u=n.value,r=u===void 0?{}:u,f=a.children,h=f===void 0?[]:f,d=a.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var i,s=h.map(function(v){var c;return{Header:function(){return(0,e.jsx)(P.Z,{html:v.title})},width:(c=v.attribute)===null||c===void 0?void 0:c.width,accessor:v.id,Cell:function(j){var y=j.value;return(0,e.jsx)("span",{children:y})}}});return s.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:(i=a.attribute)===null||i===void 0?void 0:i.width,accessor:"title"}),s},[]),l=o.map(function(i,s){var v=i.id,c=r[v]||{};return(0,p.Z)({title:i.title,rowId:v},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(Ve,{columns:m,data:l})})};(0,A.RM)("MatrixFillBlank",vt,"antd"),(0,A.cf)("MatrixFillBlank",ht,"antd");var ft=["title","rowId"],mt=["title","rowId"];function We(t){var n=t.columns,a=t.data,u=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ue.useTable)({columns:n,data:a,defaultColumn:u},ue.useBlockLayout),f=r.getTableProps,h=r.getTableBodyProps,d=r.headerGroups,o=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:d.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},h()),{},{children:o.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td",children:i.render("Cell")}))})}))})}))]}))}function xt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=n.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var s;return((s=n.children)===null||s===void 0?void 0:s.filter(function(v){var c;return(c=v.attribute)===null||c===void 0?void 0:c.exclusiveFillBlankInMatrix}).map(function(v){return v.id}))||[]},[n]),l=(0,b.useMemo)(function(){var s,v,c=h.map(function(x){var j;return{Header:(0,e.jsx)(P.Z,{html:x.title}),width:(j=x.attribute)===null||j===void 0?void 0:j.width,accessor:x.id,Cell:function(C){var Z,w,S=C.value,B=C.row,F=C.data,E=(Z=x.attribute)===null||Z===void 0?void 0:Z.exclusiveFillBlankInMatrix,$=(w=x.attribute)===null||w===void 0?void 0:w.dataType;return(0,e.jsxs)("div",{onClick:function(){if(!E){var M={};F.forEach(function(O,L){var H=O.title,q=O.rowId,Y=(0,he.Z)(O,ft);B.index===L?(M[q]={},m.forEach(function(_){M[q][_]=Y[_]}),M[q][x.id]=!0):M[q]=Y}),a(M)}},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[!E&&(0,e.jsx)(je.ZP,{checked:!!S}),$?(0,e.jsx)(le,{type:$,style:{width:120},value:S===!0?"":S,onChange:function(M){var O={};F.forEach(function(L,H){var q=L.title,Y=L.rowId,_=(0,he.Z)(L,mt);B.index===H?(E?O[Y]=_:(O[Y]={},m.forEach(function(oe){O[Y][oe]=_[oe]})),O[Y][x.id]=M):O[Y]=_}),a(O)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return c.splice(0,0,{Header:(0,e.jsx)(P.Z,{html:(s=n.attribute)===null||s===void 0?void 0:s.cornerText}),width:((v=n.attribute)===null||v===void 0?void 0:v.width)||150,accessor:"title"}),c},[]),i=o.map(function(s,v){var c=s.id,x=r[c]||{};return(0,p.Z)({title:(0,e.jsx)(P.Z,{html:s.title}),rowId:c},x)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(We,{columns:l,data:i})})}var gt=function(n){var a=n.schema,u=n.value,r=u===void 0?{}:u,f=a.children,h=f===void 0?[]:f,d=a.row,o=d===void 0?[]:d,m=(0,b.useMemo)(function(){var i,s,v=h.map(function(c){var x;return{Header:(0,e.jsx)(P.Z,{html:c.title}),width:(x=c.attribute)===null||x===void 0?void 0:x.width,accessor:c.id,Cell:function(y){var C=y.value,Z=y.row,w=y.data;return C?(0,e.jsx)("div",{children:(0,e.jsx)(je.ZP,{checked:!!C,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return v.splice(0,0,{Header:(0,e.jsx)(P.Z,{html:(i=a.attribute)===null||i===void 0?void 0:i.cornerText}),width:((s=a.attribute)===null||s===void 0?void 0:s.width)||150,accessor:"title"}),v},[]),l=o.map(function(i,s){var v=i.id,c=r[v]||{};return(0,p.Z)({title:(0,e.jsx)(P.Z,{html:i.title}),rowId:v},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(We,{columns:m,data:l})})};(0,A.RM)("MatrixRadio",xt,"antd"),(0,A.cf)("MatrixRadio",gt,"antd");function jt(t){for(var n=[],a=2;a<t+2;a++)n.push(a/(t+2));return n}function Ct(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=[],r=t;r<=n;r++)u.push(r);return a&&u.reverse(),u}function yt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=h[0].id,o=(0,b.useState)(function(){return r[d]||-1}),m=(0,I.Z)(o,2),l=m[0],i=m[1];function s(c){a((0,W.Z)({},d,c))}(0,b.useEffect)(function(){Object.keys(r).length>0&&i(r[d])},[r,d]);var v=function(x){var j=r[x.id],y=x.attribute||{},C=y.scope,Z=C===void 0?"[0,10]":C,w=y.npsInvertSort,S=y.npsStart,B=S===void 0?"\u4E0D\u53EF\u80FD":S,F=y.npsEnd,E=F===void 0?"\u6781\u6709\u53EF\u80FD":F,$=Z.replace("[","").replace("]","").split(","),D=(0,I.Z)($,2),M=D[0],O=D[1],L=jt(l||0);return(0,e.jsxs)("div",{className:"nps",onMouseLeave:function(){i(j)},children:[(0,e.jsx)("div",{className:"nps-container",children:Ct(parseInt(M),parseInt(O),w).map(function(H){var q={background:"#2672ff",opacity:L[H]};return(0,e.jsx)("div",{className:"nps-item",style:l>=H?q:void 0,onMouseOver:function(){i(H)},onClick:function(){return s(H)},children:H},H)})}),(0,e.jsxs)("div",{className:"nps-tip",children:[(0,e.jsx)("div",{children:w?E:B}),(0,e.jsx)("div",{children:w?B:E})]})]},x.id)};return(0,e.jsx)(J.Z,{children:h.map(function(c){return v(c)})})}(0,A.RM)("Nps",yt,"antd");var Zt=je.ZP.Group;function pt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=t.onBlur,h=n.children,d=n.attribute,o=24/((d==null?void 0:d.columns)||1),m=(0,N.AK)("-body-question"),l=!!(d!=null&&d.statEnabled);function i(c){var x,j=c.target.value,y=(x=n.children)===null||x===void 0?void 0:x.find(function(Z){return Z.id===j});if(y){var C=y.id;a((0,W.Z)({},c.target.value,r[C]||!0))}}function s(c,x){a((0,W.Z)({},c,x||!0),c)}function v(c,x){f((0,W.Z)({},c,x||!0),c)}return(0,b.useEffect)(function(){var c;(c=n.children)===null||c===void 0||c.forEach(function(x){var j,y=x.id,C=x.attribute,Z=C==null?void 0:C.dataType;(j=x.attribute)!==null&&j!==void 0&&j.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},y,Z?r[y]:!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(Zt,{onChange:i,value:Object.keys(r)[0],style:{width:"100%"},children:(0,e.jsx)(J.Z,{children:h==null?void 0:h.map(function(c){var x,j,y,C=c.id,Z=(x=c.attribute)===null||x===void 0?void 0:x.dataType,w=(j=c.attribute)===null||j===void 0?void 0:j.suffix,S=(y=c.attribute)===null||y===void 0?void 0:y.readOnly;return(0,e.jsxs)(G.Z,{span:o,className:m+"-option","data-id":C,children:[(0,e.jsx)(mn,{qId:n.id,schema:c,value:r[C],onChange:function(F){return s(C,F)},onBlur:function(F){return v(C,F)}}),l&&(0,e.jsx)(Ie,{checked:!!r[C],optionId:C,questionId:n.id,checkedCount:Object.keys(r).length}),Z&&(0,e.jsx)(le,{value:r[C]===!0?"":r[C],type:Z,schema:c,readOnly:S,style:{maxWidth:200},onChange:function(F){return s(C,F)},onBlur:function(F){return v(C,F)},suffix:w&&(0,e.jsx)("span",{className:m+"-option-suffix",children:(0,e.jsx)(P.Z,{html:w})})})]},C)})})})})}(0,A.RM)("Radio",pt,"antd");function bt(t){var n=(0,N.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(Q.hl,{html:"".concat(t.replaceTitle||t.schema.title||"")})})}var St=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(Q.hl,{html:"".concat(n.replaceTitle||n.schema.title||"")})})};(0,A.RM)("Remark",bt,"antd"),(0,A.cf)("Remark",St,"antd");var va=g(96433),Ne=g(2864),Ke=g(41687),wt=g(46870),Ye=g(18613),Bt=g(57206),Nt={1:(0,e.jsx)(Ke.Z,{}),2:(0,e.jsx)(Ke.Z,{}),3:(0,e.jsx)(wt.Z,{}),4:(0,e.jsx)(Ye.Z,{}),5:(0,e.jsx)(Ye.Z,{})};function At(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f;function d(m,l){a((0,W.Z)({},m,l))}var o=function(l){var i=l.attribute||{},s=l.id,v=i.scope,c=v===void 0?"[0,5]":v,x=i.scoreStyle,j=c.replace("[","").replace("]","").split(","),y=(0,I.Z)(j,2),C=y[0],Z=y[1];return x==="heart"?(0,e.jsx)(Ne.Z,{defaultValue:parseInt(C),character:(0,e.jsx)(Bt.Z,{}),style:{color:"#ea7463"},value:r[s],count:parseInt(Z),onChange:function(S){return d(s,S)}},s):x==="smile"?(0,e.jsx)(Ne.Z,{defaultValue:parseInt(C),character:function(S){var B=S.index;return Nt[B+1]},count:parseInt(Z),onChange:function(S){return d(s,S)},value:r[s]},s):(0,e.jsx)(Ne.Z,{defaultValue:parseInt(C),count:parseInt(Z),value:r[s],onChange:function(S){return d(s,S)}},s)};return(0,e.jsx)(J.Z,{children:h.map(function(m){return o(m)})})}(0,A.RM)("Score",At,"antd");function Et(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f;function d(o){var m,l=(m=n.children)===null||m===void 0?void 0:m.find(function(i){return i.id===o});l&&a((0,W.Z)({},o,!0))}return(0,b.useEffect)(function(){var o;(o=n.children)===null||o===void 0||o.forEach(function(m){var l,i=m.id;(l=m.attribute)!==null&&l!==void 0&&l.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},i,!0))})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(ce.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,onClear:function(){a(void 0)},showSearch:!0,value:Object.keys(r)[0],filterOption:function(m,l){return(l==null?void 0:l.label).toLowerCase().indexOf(m.toLowerCase())!==-1},onChange:d,style:{width:260},options:h.map(function(o){return{label:o.title,value:o.id}})})})})}(0,A.RM)("Select",Et,"antd");var ha=g(34669),Ft=g(82833);function Ge(t){var n=t.schema,a=t.onChange,u=n.children,r=(0,N.Al)(),f=(0,b.useState)(0),h=(0,I.Z)(f,2),d=h[0],o=h[1];function m(l,i){var s="signature-".concat(i,"-").concat((0,U.kb)(6),".png");if(!r.onUpload){a((0,W.Z)({},i,[s]));return}fetch(l).then(function(v){return v.blob()}).then(function(v){var c=new File([v],s,{type:"image/png"});r.onUpload({file:c},function(x){o(x.loaded/x.total*100)}).then(function(x){x.success&&x.data.id&&a((0,W.Z)({},i,[x.data.id]))})})}return(0,e.jsx)("div",{children:u==null?void 0:u.map(function(l){var i=l.id,s=l.title;return(0,e.jsxs)(J.Z,{gutter:[10,0],"data-id":i,children:[s&&(0,e.jsx)(G.Z,{span:24},l.id),(0,e.jsxs)(G.Z,{span:24,children:[(0,e.jsx)(rn,{onChange:function(c){return m(c,i)}}),d>0&&d!==100&&(0,e.jsx)(Ft.Z,{percent:d,size:"small",showInfo:!1})]})]},i)})})}Ge.Preview=function(t){var n=t.value,a;return n&&(a=Object.values(n)[0][0]),(0,e.jsx)("div",{className:"preview signature-print",children:a&&(0,e.jsx)("img",{src:"/api/file?id=".concat(a)})})},(0,A.RM)("Signature",Ge,"antd");var Ae=g(27049);function It(t){var n=(0,N.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(Ae.Z,{plain:!0})})}var Pt=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(Ae.Z,{plain:!0})})};(0,A.RM)("SplitLine",It,"antd"),(0,A.cf)("SplitLine",Pt,"antd");function Mt(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=(0,N.AK)("-body-question");function d(o,m){r[o]=m,m===""&&delete r[o],a((0,p.Z)({},r))}return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(o){var m=o.id,l=o.attribute,i=o.title,s=(0,U.Ck)(l==null?void 0:l.autoSize,[2,4]);return(0,e.jsxs)(J.Z,{style:{marginBottom:10},"data-id":m,children:[i&&(0,e.jsx)(G.Z,{className:h+"-option",span:4,children:o.title&&(0,e.jsx)("span",{className:h+"-option-title",children:o.title})},o.id),(0,e.jsx)(G.Z,{span:12,children:(0,e.jsx)(K.Z.TextArea,{autoSize:{minRows:s[1],maxRows:s[2]},value:r[m]||"",onChange:function(c){return d(m,c.target.value)}})})]},m)})})}(0,A.RM)("Textarea",Mt,"antd");var Rt=g(43347),Tt=ye.Z.Dragger;function $t(t){var n=t.schema,a=t.onChange,u=t.value,r=t.readOnly,f=n.children,h=(0,N.Al)(),d=(0,b.useState)(),o=(0,I.Z)(d,2),m=o[0],l=o[1];(0,b.useEffect)(function(){var v=n.children[0].id,c=u&&u[v]||[];m==null&&c.length>0&&se.hi.loadFiles({ids:c}).then(function(x){l(x==null?void 0:x.map(function(j){return{name:j.originalName,uid:j.id,status:"done"}}))})},[u]);var i=function(){var v=(0,Le.Z)((0,Ze.Z)().mark(function c(x){var j,y,C,Z;return(0,Ze.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:j=x.onSuccess,y=x.onError,C=x.file,Z=x.onProgress,h.onUpload&&h.onUpload({file:C},function(B){Z&&Z({percent:B.loaded/B.total*100})}).then(function(B){if(B.success&&j&&j(B.data),!B.success&&y){var F=new Error("Some error");y({event:F})}});case 2:case"end":return S.stop()}},c)}));return function(x){return v.apply(this,arguments)}}(),s=function(c,x){if(l(c.fileList),(c.file.status==="removed"||c.file.status==="done")&&!c.fileList.find(function(y){return y.status!=="done"})){var j=c.fileList.filter(function(y){return y.status==="done"}).map(function(y){var C;return((C=y.response)===null||C===void 0?void 0:C.id)||y.uid});j.length===0?a(void 0):a((0,W.Z)({},x,j))}};return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(v){var c=v.id,x=v.attribute,j=[];if(x){var y=x.maxFileCount,C=x.maxFileSize,Z=x.fileAccept;y&&j.push("\u6700\u591A\u4E0A\u4F20".concat(y,"\u4E2A")),C&&j.push("\u9650\u5236\u6BCF\u4E2A\u6587\u4EF6".concat(C,"M\u4EE5\u5185")),Z&&j.push("\u4EC5\u652F\u6301\u6587\u4EF6\u7C7B\u578B\uFF1A".concat(Z))}return(0,e.jsxs)(Tt,{multiple:!0,disabled:r,maxCount:(x==null?void 0:x.maxFileCount)||20,accept:x==null?void 0:x.fileAccept,beforeUpload:function(S){return x!=null&&x.maxFileSize&&S.size>x.maxFileSize*1024*1024?(Oe.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(x.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),ye.Z.LIST_IGNORE):!0},customRequest:i,onChange:function(S){return s(S,c)},fileList:m,children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(Rt.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:"\u9009\u62E9\u6216\u62D6\u62FD\u4E0A\u4F20\u6587\u4EF6"}),(0,e.jsx)("p",{className:"ant-upload-hint",children:j.join(",")})]},c)})})}(0,A.RM)("Upload",$t,"antd");var Dt=g(55686),Ot=g(95459),Lt=ce.Z.Option;function Ht(t){var n=t.schema,a=t.onChange,u=t.value,r=u===void 0?{}:u,f=n.children,h=f===void 0?[]:f,d=h[0].id,o=(0,b.useState)([]),m=(0,I.Z)(o,2),l=m[0],i=m[1];function s(x){d&&a((0,W.Z)({},d,x))}var v=(0,se.zE)(function(x){se.hi.selectUser({name:x,selected:r[d]||[]}).then(function(j){j.success&&i(j.data)})},5),c=function(j){s(j?l.map(function(y){return y.userId}):void 0)};return(0,b.useEffect)(function(){var x;v(""),(x=n.children)===null||x===void 0||x.forEach(function(j){var y,C=j.id;(y=j.attribute)!==null&&y!==void 0&&y.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},C,!0))})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(G.Z,{span:24,children:(0,e.jsx)(ce.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,filterOption:!1,mode:"multiple",onClear:function(){a(void 0)},style:{width:"100%"},value:r[d]||[],onSearch:v,showSearch:!0,onChange:s,dropdownRender:function(j){return(0,e.jsxs)("div",{children:[j,(0,e.jsx)(Ae.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",paddingLeft:10},children:(0,e.jsx)(xe.Z,{onChange:function(C){c(C.target.checked)},children:"\u5168\u9009"})})]})},children:l.map(function(x){return(0,e.jsx)(Lt,{value:x.userId,label:x.name,children:(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{role:"img",style:{marginRight:10},children:(0,e.jsx)(Dt.Z,{user:x,size:20})}),x.name," ",x.deptName&&"(".concat(x.deptName,")")]})},x.userId)})})})})}var zt=function(n){var a=n.schema,u=n.value,r=u===void 0?{}:u,f=a.children,h=f===void 0?[]:f,d=h[0].id,o=(0,b.useState)([]),m=(0,I.Z)(o,2),l=m[0],i=m[1];return(0,b.useEffect)(function(){se.hi.selectUser({selected:r[d]||[],name:"^_^"}).then(function(s){s.success&&i(s.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Ot.Z,{children:l.map(function(s){return(0,e.jsx)(He.Z,{color:"blue",children:s.name},s.userId)})})})};(0,A.RM)("User",Ht,"antd"),(0,A.cf)("User",zt,"antd");var kt=g(73328),Ut=function(n){var a=(0,b.useRef)(null),u=(0,b.useState)(!1),r=(0,I.Z)(u,2),f=r[0],h=r[1];return(0,kt.Z)(a,function(){h(!1)}),(0,e.jsx)("div",{className:ve()("preview",{active:f}),ref:a,onClick:function(){h(!0)},children:(0,e.jsx)(P.Z,{html:Object.values(n.value||{})[0]})})};(0,U.cf)("RichText",Ut,"antd");var Vt=function(n){return(0,e.jsx)(e.Fragment,{children:n.children})},Wt=Vt;(0,U.RM)("RichText",(0,b.lazy)(function(){return Promise.all([g.e(9548),g.e(4177),g.e(6779),g.e(2684),g.e(6625),g.e(8764),g.e(596),g.e(2370),g.e(811),g.e(62)]).then(g.bind(g,27321))}),"antd"),(0,U.cf)("Upload",(0,b.lazy)(function(){return Promise.all([g.e(9548),g.e(6779),g.e(6661),g.e(2923),g.e(9452)]).then(g.bind(g,43640))}),"antd")},55686:function(fe,ne,g){"use strict";var I=g(11849),U=g(94233),R=g(51890),b=g(93224),Q=g(89366),N=g(85893),A=["user"],e=function(te){var z=te.user,k=(0,b.Z)(te,A);return!z||!z.avatar?(0,N.jsx)(R.C,(0,I.Z)({icon:(0,N.jsx)(Q.Z,{}),size:k.size||"small"},k)):(0,N.jsx)(R.C,(0,I.Z)({src:"/api/public/preview/".concat(z.avatar),size:k.size||"small"},k))};ne.Z=e},78210:function(fe,ne,g){"use strict";var I=g(27856),U=g.n(I),R=g(15020),b=g(85893),Q=function(A){var e=A.html,re=e===void 0?"":e,te=A.replaceP,z=te===void 0?!0:te;return z?(0,b.jsx)("div",{className:"pe-view",children:typeof re=="string"&&(0,R.ZP)(U().sanitize(re,{ADD_TAGS:["iframe"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling"]}).replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"))}):(0,b.jsx)(b.Fragment,{children:typeof re=="string"&&(0,R.ZP)(U().sanitize(re))})};ne.Z=Q},39017:function(fe,ne,g){"use strict";g.d(ne,{Rk:function(){return te}});var I=g(67294),U=g(24004);function R(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",k=useContext(SurveyContext),X=k.theme;return"survey-".concat(X)+z}function b(z,k){var X=(k&&k.depends||[]).reduce(function(T,ee){return T||!ee},!1);return Q(X?void 0:function(T,ee){return fetch(T,ee).then(function(V){if(!!V.ok)return V.json()})},z,k||{})}function Q(z){for(var k=arguments.length,X=new Array(k>1?k-1:0),T=1;T<k;T++)X[T-1]=arguments[T];var ee=useState(0),V=_slicedToArray(ee,2),K=V[0],p=V[1],ae=useCallback(function(){p(Math.random())},[]),ie=useState({loading:!1,mutate:ae}),pe=_slicedToArray(ie,2),be=pe[0],me=pe[1];return useEffect(function(){!z||X[1].manual&&K===0||z.apply(null,X).then(function(de){de.code===200?me({loading:!1,data:de.data,mutate:ae}):me({error:de.message,loading:!1,mutate:ae})}).catch(function(de){me({error:de,loading:!1,mutate:ae})})},N(K,X)),be}function N(){for(var z=arguments.length,k=new Array(z),X=0;X<z;X++)k[X]=arguments[X];for(var T=[],ee=0;ee<arguments.length;ee++){var V=arguments[ee];if(V instanceof Array)for(var K=0;K<V.length;K++)T=T.concat(N(V[K]));else if(typeof URL!="undefined"&&V instanceof URL)T=T.concat(V.toJSON());else if(V instanceof Object)for(var p=Object.keys(V),ae=0;ae<p.length;ae++){var ie=p[ae];ie==="depends"?T=T.concat(V[ie]):T=T.concat([ie]).concat(N(V[ie]))}else T=T.concat(V)}return T}var A=g(87998);function e(){return useContext(SurveyContext)}function re(){return useSurvey().attachments}function te(){var z=(0,I.useContext)(A.ZX);return z.innerStore}},49914:function(fe,ne,g){"use strict";g.d(ne,{H:function(){return R}});var I=g(67294),U=g(87998);function R(){return(0,I.useContext)(U.ff)}}}]);
