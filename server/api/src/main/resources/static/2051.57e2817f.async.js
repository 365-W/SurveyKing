(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[2051],{28161:function(fe,ne,g){"use strict";g.r(ne),g.d(ne,{default:function(){return Wt}});var M=g(94657),U=g(40807),F=g(78210),T=g(9761),b=g(67294),N=g(54707),E=g(48187),_=g(67635),e=g(85893),te=function(){var n=(0,N.AK)(),a=(0,b.useContext)(U.ZX),s=a.schema;return(0,e.jsxs)("div",{className:n+"-header",children:[(0,e.jsx)("div",{className:n+"-header-title",children:(0,e.jsx)(_.hl,{html:s.title})}),(0,e.jsx)("div",{className:n+"-header-description",children:(0,e.jsx)(_.hl,{html:s.description})})]})},k=function(n){var a=(0,N.AK)();return(0,e.jsx)("div",{className:a+"-body",children:n.children})},V=g(77576),G=g(12028),L=g(57663),K=g(71577),z=(0,T.Pi)(function(){var t,n,a=(0,N.AK)("-footer"),s=(0,b.useContext)(U.ZX),r=s.schema,f=s.loading,v=(0,N.Rk)(),o=v.pagination,u=o.current,m=o.pageSize,l=m>1,i=u===1,d=u===m;return(0,e.jsxs)("div",{className:a,children:[d&&(0,e.jsx)("div",{className:a+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(_.hl,{html:r==null||(t=r.attribute)===null||t===void 0?void 0:t.suffix})}),(0,e.jsxs)("div",{className:a+"-pagination",children:[l&&!i&&(0,e.jsx)("div",{children:(0,e.jsx)(K.Z,{type:"primary",block:!0,onClick:function(){return v.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),l&&!d&&(0,e.jsx)("div",{children:(0,e.jsx)(K.Z,{type:"primary",block:!0,onClick:function(){return v.handleNext()},children:"\u4E0B\u4E00\u9875"})}),d&&(0,e.jsx)("div",{children:(0,e.jsx)(K.Z,{type:"primary",block:!0,onClick:function(){return v.submit()},loading:f,children:(0,e.jsx)(_.hl,{html:((n=r.attribute)===null||n===void 0?void 0:n.submitButton)||"\u63D0\u4EA4"})})}),l&&(0,e.jsxs)("div",{className:a+"-pagination-info",children:["\u7B2C",u,"\u9875/\u5171",m,"\u9875"]}),v.autoNextPage>0&&(0,e.jsxs)("div",{style:{color:"#999",display:"flex",alignItems:"center",justifyContent:"center",width:200},children:["\u7B54\u5BF9\u81EA\u52A8\u8DF3\u8F6C\u4E0B\u4E00\u9875",(0,e.jsx)(G.Z,{style:{marginLeft:5},checked:v.autoNextPage===1,onChange:function(c){c?v.autoNextPage=1:v.autoNextPage=2}})]})]})]})}),se=g(47673),Q=g(4107),p=g(11849),ue=g(77883),me=g(85986),Ne=g(14965),he=g(68318),ce=g(39002),Ge=g(68351),Kt=g(43358),oe=g(34041),Xe=g(29985),Qe=g(46842),Je=g(64302),qe=g(27484),pe=g.n(qe),Yt=g(33852);pe().locale("zh-cn");function Ae(t,n){if(!!t)return pe()(t,n)}var _e=function(n){var a=n.dictCode,s=n.value,r=n.onChange,f=n.style,v=n.bordered,o=n.className,u=n.parentValue,m=n.cascaderLevel,l=m===void 0?1:m,i=(0,N.Al)(),d=(0,b.useState)([]),h=(0,M.Z)(d,2),c=h[0],x=h[1],j=(0,N.zE)(function(y){l&&l>1&&!u||i.onDictSearch&&i.onDictSearch({dictCode:a,searchValue:y,parentValue:u==null?void 0:u.split("|")[0],cascaderLevel:l}).then(function(C){x(C||[])})},2);return(0,b.useEffect)(function(){l&&l>1&&(u?j(void 0):x([]))},[u,l]),(0,b.useEffect)(function(){!s&&l<=1&&a&&j(void 0),s&&c.length===0&&j(s)},[s]),(0,e.jsx)(oe.Z,{options:c,showSearch:!0,onSearch:j,value:s==null?void 0:s.split("|")[0],onChange:function(C){var Z;return r("".concat(C,"|").concat((Z=c.find(function(S){return S.value===C}))===null||Z===void 0?void 0:Z.label))},style:f,bordered:v,dropdownClassName:o,allowClear:!0})};function en(t,n){return n||(t==="date"?"YYYY-MM-DD":t==="dateTime"?"YYYY-MM-DD HH:mm:ss":t==="time"?"HH:mm:ss":"YYYY-MM-DD")}function nn(t){return t?t==="YYYY"?"year":t==="YYYY-MM"?"month":"date":"date"}var tn=function(n){var a=n.onChange,s=n.type,r=n.value,f=n.style,v=f===void 0?{width:"100%"}:f,o=n.className,u=n.readOnly,m=n.bordered,l=en(s,n.dateTimeFormat);return l.startsWith("HH")?(0,e.jsx)(Ge.Z,{value:Ae(r,l),format:l,onChange:function(d,h){return a(h)},style:v,className:o,disabled:u,bordered:m}):(0,e.jsx)(he.Z,{onChange:function(d,h){a(h)},disabled:u,format:l,picker:nn(l),showTime:l.includes("HH")||l.includes("mm")||l.includes("ss"),showSecond:l.includes("ss"),showMinute:l.includes("mm"),showHour:l.includes("HH"),value:Ae(r,l),style:v,className:o,bordered:m})},ae=function(n){var a=n.onChange,s=n.type,r=n.value,f=n.suffix,v=n.style,o=v===void 0?{width:"100%"}:v,u=n.className,m=n.dictCode,l=n.onBlur,i=l===void 0?function(){}:l,d=n.bordered,h=n.parentValue,c=n.cascaderLevel,x=n.icon,j=x===void 0?!0:x,y=n.readOnly,C=y===void 0?!1:y,Z=n.schema;return s==="horzBlank"?(0,e.jsx)(e.Fragment,{}):s==="selectDict"&&m?(0,e.jsx)(_e,{value:r,onChange:a,dictCode:m,style:o,bordered:d,className:u,parentValue:h,cascaderLevel:c}):s==="select"&&Z!==null&&Z!==void 0&&Z.dataSource?(0,e.jsx)(oe.Z,{options:Z.dataSource,style:{width:200},bordered:d,onChange:a}):s==="number"?(0,e.jsx)(me.Z,{className:u,onChange:a,onBlur:function(w){return i(w.target.value)},value:r,style:o,addonAfter:f,readOnly:C,bordered:d}):s==="date"||s==="dateTime"||s==="time"?(0,e.jsx)(tn,(0,p.Z)({},n)):s==="mobile"?(0,e.jsx)(Q.Z,{prefix:j?(0,e.jsx)(Xe.Z,{}):void 0,onChange:function(w){return a(w.target.value)},value:r,className:u,onBlur:function(w){return i(w.target.value)},bordered:d,readOnly:C}):s==="idCard"?(0,e.jsx)(Q.Z,{prefix:j?(0,e.jsx)(Qe.Z,{}):void 0,onChange:function(w){return a(w.target.value)},value:r,style:o,className:u,onBlur:function(w){return i(w.target.value)},bordered:d}):s==="email"?(0,e.jsx)(Q.Z,{prefix:j?(0,e.jsx)(Je.Z,{}):void 0,onChange:function(w){return a(w.target.value)},onBlur:function(w){return i(w.target.value)},value:r,style:o,className:u,bordered:d}):(0,e.jsx)(Q.Z,{onChange:function(w){return a(w.target.value)},onBlur:function(w){return i(w.target.value)},value:r,suffix:f,style:o,className:u,bordered:d,readOnly:C})},Gt=g(49111),Ee=g(19650),an=g(17672),rn=function(n){var a=n.onChange,s=(0,b.useRef)(null),r=(0,b.useRef)(),f=(0,b.useRef)(),v=(0,b.useState)(0),o=(0,M.Z)(v,2),u=o[0],m=o[1];return(0,b.useEffect)(function(){var l=s.current;if(l){var i,d=new an.Z(s.current);d.addEventListener("beginStroke",function(){m(1)}),r.current=d;var h=Math.max(window.devicePixelRatio||1,1);l.width=l.offsetWidth*h,l.height=l.offsetHeight*h,(i=l.getContext("2d"))===null||i===void 0||i.scale(h,h)}},[]),(0,e.jsxs)("div",{className:"signature-pad",children:[(0,e.jsx)("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:f.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),(0,e.jsxs)("div",{className:"signature",children:[(0,e.jsx)("canvas",{ref:s,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:u!==2?"block":"none"}}),u===2&&(0,e.jsx)("img",{src:f.current||void 0})]}),(0,e.jsxs)("div",{className:"save-signature",children:[(0,e.jsx)("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),(0,e.jsx)("div",{children:(0,e.jsxs)(Ee.Z,{children:[u===1&&(0,e.jsx)(K.Z,{type:"link",onClick:function(){var i;(i=r.current)===null||i===void 0||i.clear(),m(0)},children:"\u6E05\u7A7A"}),(u===0||u===1)&&(0,e.jsx)(K.Z,{type:"primary",disabled:u!==1,ghost:!0,size:"small",onClick:function(){var i;a(r.current.toDataURL()),f.current=(i=r.current)===null||i===void 0?void 0:i.toDataURL(),m(2)},children:"\u5B8C\u6210"}),u===2&&(0,e.jsx)(K.Z,{type:"primary",ghost:!0,size:"small",onClick:function(){var i;m(0),(i=r.current)===null||i===void 0||i.clear()},children:"\u91CD\u7B7E"})]})})]})]})},ln=g(3024),sn=(0,T.Pi)(function(){var t=(0,b.useContext)(U.ZX),n=t.progressBar,a=(0,N.AK)(),s=(0,N.Rk)(),r=s.progress;return n?(0,e.jsx)(ln.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:a+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(r*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),Fe=function(n){var a,s=n.optionId,r=n.questionId,f=n.checked,v=n.checkedCount,o=(0,N.Al)(),u=o.statistics,m=u==null?void 0:u.questionStatistics[r],l=((m==null?void 0:m.optionStatistics.reduce(function(h,c){return h+c.count},0))||0)+v,i=(m==null||(a=m.optionStatistics.find(function(h){return h.optionId===s}))===null||a===void 0?void 0:a.count)||0;i=f?i+1:i;var d="".concat(Math.floor(i/l*1e3)/10,"%");return v===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("span",{className:"vote-info",children:[(0,e.jsxs)("span",{className:"vote-info-cnt ",children:[i,"\u7968"]}),(0,e.jsx)("span",{className:"vote-info-percent ",children:d}),(0,e.jsx)("div",{className:"vote-info-bar",children:(0,e.jsx)("div",{className:"vote-info-bar-fill",style:{width:d}})})]})},be=function(n){var a=n.schema,s=n.type,r=a.attribute,f=r===void 0?{}:r,v=f.examCorrectAnswer,o=(0,N.Al)(),u=o.correctAnswerVisible,m=o.mode;return v&&u&&m==="exam"?s==="FillBlank"||s==="HorzBlank"||s==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:v}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},Xt=function(n){var a=n.schema,s=a.attribute,r=s===void 0?{}:s,f=r.examScore,v=useSurvey(),o=v.mode,u=v.examScoreVisible;return f&&o==="exam"&&u?_jsxs("span",{className:"question-score",children:["\uFF08",f,"\u5206\uFF09"]}):_jsx(_Fragment,{})},un=(0,T.Pi)(function(t){var n=(0,N.Rk)(),a=n.reviewAnswer[t.qId];return a&&!a.visible?(0,e.jsx)("span",{className:"review-answer-btn",onClick:function(){a.visible=!0},children:"\u67E5\u770B\u7B54\u6848"}):(0,e.jsx)(e.Fragment,{})}),Qt=g(63185),xe=g(9676),on=g(36862),dn=g(46533),cn=g(94184),de=g.n(cn),vn=g(91220),Ie=g(15020);function Pe(t,n,a,s){if(!t)return"";var r=RegExp("_{3,}","g"),f=t.matchAll(r),v=[],o=(0,vn.Z)(f),u;try{for(o.s();!(u=o.n()).done;){var m=u.value,l=m.index,i=m.index+m[0].length;v.push([l,i])}}catch(x){o.e(x)}finally{o.f()}if(v.length===0)return t;for(var d=v[0][0]===0?"":t.substring(0,v[0][0]),h=function(j){var y,C,Z=v[j],S=v[j+1],w=t.substring(Z[0],Z[1]),B=t.substring(Z[1],S?S[0]:t.length),I=n[j],A=a?a[I.id]:"";if(((y=I.attribute)===null||y===void 0?void 0:y.dataType)==="select"){var P,$;A=(P=I.dataSource)===null||P===void 0||($=P.find(function(O){return O.value===A}))===null||$===void 0?void 0:$.label}else if(((C=I.attribute)===null||C===void 0?void 0:C.dataType)==="selectDict"){var R,D;A=(R=A)===null||R===void 0||(D=R.split("|"))===null||D===void 0?void 0:D[1]}d+='<input data-id="'.concat(n[j].id,`" value='`).concat(A||"",`'  class="horz-blank" style="width:`).concat(12*w.length,'px">'),d+=B},c=0;c<v.length;c++)h(c);return d}var ge=(0,T.Pi)(function(t){var n=t.content,a=t.children,s=t.value,r=s===void 0?{}:s,f=t.onChange,v=t.onBlur,o=t.schema,u=(0,N.Rk)(),m=u.reviewAnswer[o.id];function l(i,d){var h,c;if(r[i]!==d){r[i]=d;var x=a.find(function(Z){return Z.id===i}),j=x==null||(h=x.attribute)===null||h===void 0?void 0:h.cascaderLevel,y=x==null||(c=x.attribute)===null||c===void 0?void 0:c.dictCode;y&&j&&a.filter(function(Z){var S;return((S=Z.attribute)===null||S===void 0?void 0:S.dictCode)===y&&Z.attribute.cascaderLevel&&Z.attribute.cascaderLevel>j}).forEach(function(Z){delete r[Z.id]}),(d===""||d===void 0)&&delete r[i];var C=(0,p.Z)({},r);if(Object.keys(C).length!==0)return C}}return(0,e.jsx)("div",{className:"pe-view",onClick:function(d){d.preventDefault(),d.stopPropagation()},children:(0,Ie.ZP)(Pe(n,a),{replace:function(d){var h=d.attribs;if(!!h){var c=h["data-id"];if(c){var x,j,y,C,Z,S=(0,Ie.e_)(h),w=a.findIndex(function(q){return q.id===c}),B=a[w],I=(x=a[w-1])===null||x===void 0?void 0:x.id,A=r[I],P=(B==null||(j=B.attribute)===null||j===void 0?void 0:j.dataType)||"text",$=B==null||(y=B.attribute)===null||y===void 0?void 0:y.dictCode,R=B==null||(C=B.attribute)===null||C===void 0?void 0:C.dateTimeFormat,D=(Z=B.attribute)===null||Z===void 0?void 0:Z.cascaderLevel,O=m==null?void 0:m[c].isCorrect,H=de()(S.className,{selected:m&&m.visible,"is-correct":m&&m.visible&&O});return(0,e.jsx)(ae,(0,p.Z)((0,p.Z)({type:P,value:r[c],parentValue:A,schema:B,cascaderLevel:D,onChange:function(Y){return f(l(c,Y))},onBlur:function(Y){return v(l(c,Y))},dictCode:$,dateTimeFormat:R,bordered:!1,icon:!1},S),{},{className:H}))}}}})})}),hn=(0,T.Pi)(function(t){var n=t.qId,a=t.schema,s=t.checked,r=t.onChange,f=t.value,v=t.onBlur,o=a.id,u=a.title,m=a.attribute,l=m===void 0?{}:m,i=(0,N.Rk)(),d=i.reviewAnswer[n],h=d==null?void 0:d[o].selected,c=d==null?void 0:d[o].isCorrect,x=l.dataType;return d&&d.visible&&(h||c)?(0,e.jsxs)("label",{className:de()("ant-checkbox-wrapper ant-checkbox-wrapper-in-form-item",{selected:h,"is-correct":c}),onClick:function(){return r(!s)},children:[(0,e.jsxs)("span",{children:[!c&&(0,e.jsx)(on.Z,{size:17,style:{color:"#ff6d56",marginRight:10,fontSize:17}}),c&&(0,e.jsx)(dn.Z,{size:17,style:{color:"#00bf6f",marginRight:10,fontSize:17}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(F.Z,{html:u})})]}):(0,e.jsxs)(xe.Z,{value:o,checked:s,onChange:function(y){return r(y.target.checked)},children:[x==="horzBlank"&&a.children?(0,e.jsx)(ge,{content:u,children:a.children,value:f,schema:a,onBlur:v,onChange:function(y){return r(!0,y)}}):(0,e.jsx)(F.Z,{html:u}),(0,e.jsx)(be,{schema:t.schema})]})}),Jt=g(88983),je=g(66253),Me=g(43061),Re=g(38819),fn=g(91508),mn=(0,T.Pi)(function(t){var n=t.qId,a=t.schema,s=t.onBlur,r=t.onChange,f=t.value,v=a.id,o=a.title,u=a.attribute,m=(0,N.Rk)(),l=m.reviewAnswer[n],i=l==null?void 0:l[v].selected,d=l==null?void 0:l[v].isCorrect,h=b.useContext(fn.ZP),c=u==null?void 0:u.dataType;return l&&l.visible&&(i||d)?(0,e.jsxs)("label",{className:de()("ant-radio-wrapper ant-radio-wrapper-in-form-item radio-item",{selected:i,"is-correct":d}),onClick:function(){var j;return h==null||(j=h.onChange)===null||j===void 0?void 0:j.call(h,{target:{value:v}})},children:[(0,e.jsxs)("span",{children:[!d&&(0,e.jsx)(Me.Z,{style:{color:"#ff6d56",marginRight:10}}),d&&(0,e.jsx)(Re.Z,{style:{color:"#00bf6f",marginRight:10}})]}),(0,e.jsx)("div",{className:"option-label-wrap",children:(0,e.jsx)(F.Z,{html:o})})]}):(0,e.jsxs)(je.ZP,{value:v,className:"radio-item",children:[c==="horzBlank"&&a.children?(0,e.jsx)(ge,{schema:a,content:o,children:a.children,value:typeof f=="boolean"?{}:f,onBlur:s,onChange:r}):(0,e.jsx)(F.Z,{html:o}),(0,e.jsx)(be,{schema:t.schema})]})}),xn=(0,T.Pi)(function(t){var n=t.schema,a=t.value,s=t.onChange,r=t.qId,f=t.onBlur,v=(0,N.AK)("-body-question"),o=n.id,u=n.attribute,m=u==null?void 0:u.suffix,l=u==null?void 0:u.dataType,i=u==null?void 0:u.dictCode,d=u==null?void 0:u.dateTimeFormat,h=u==null?void 0:u.readOnly,c=(0,N.Rk)(),x=c.reviewAnswer[r],j=x==null?void 0:x[o].isCorrect;return x&&x.visible?(0,e.jsxs)("span",{style:{position:"relative"},children:[!j&&(0,e.jsx)(Me.Z,{style:{color:"#ff6d56",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),j&&(0,e.jsx)(Re.Z,{style:{color:"#00bf6f",marginRight:10,position:"absolute",left:0,top:3,zIndex:1}}),(0,e.jsx)(ae,{type:l,value:a[o],readOnly:h,className:de()("selected",{"is-correct":j}),onChange:function(C){return s(C)},onBlur:f,style:{paddingLeft:20},suffix:m&&(0,e.jsx)("span",{className:v+"-option-suffix",children:(0,e.jsx)(F.Z,{html:m})})})]}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ae,{type:l,value:a[o],onChange:function(C){return s(C)},onBlur:f,readOnly:h,dictCode:i,dateTimeFormat:d,suffix:m&&(0,e.jsx)("span",{className:v+"-option-suffix",children:(0,e.jsx)(F.Z,{html:m})})})})}),qt=g(65011),_t=g(48736),ea=g(402),gn=g(20294),jn=oe.Z.Option,Ce=gn.Z.Text,na=function(n){var a=n.onChange,s=n.form,r=n.record,f=useState(n.value),v=_slicedToArray(f,2),o=v[0],u=v[1],m=useState(n.value),l=_slicedToArray(m,2),i=l[0],d=l[1];useEffect(function(){d(n.value)},[n.value]);var h=useState([{id:"1",drugName:"\u6D4B\u8BD5\u7528\u836F",chemicalName:"hahah11",stCompName:"\u4E0A\u6D77\u5236\u836F\u5382"},{id:"2",drugName:"\u6D4B\u8BD5\u7528\u836F1",chemicalName:"hahah11",stCompName:"\u5E7F\u4E1C\u5236\u836F\u5382"}]),c=_slicedToArray(h,2),x=c[0],j=c[1],y=useThrottleCallback(function(C){},4);return _jsx(_AutoComplete,{showSearch:!0,placeholder:"\u70B9\u51FB\u641C\u7D22",value:i,dropdownMatchSelectWidth:!1,onBlur:function(){d(o),o?a==null||a(o):a==null||a(void 0)},onSelect:function(Z){u(Z),d(Z)},allowClear:!0,onClear:function(){u(void 0),d(void 0),a==null||a(void 0)},onSearch:function(Z){d(Z),y(Z)},dropdownRender:function(Z){return _jsxs(_Fragment,{children:[Z,_jsx(_Divider,{style:{margin:"8px 0"}}),_jsxs(_Space,{align:"center",style:{padding:"0 8px 4px"},children:[_jsx(Ce,{children:"\u836F\u7269\u540D\u79F0"}),_jsx(Ce,{type:"secondary",style:{fontSize:12},children:"(\u5546\u54C1\u540D-\u5382\u5BB6)"})]})]})},children:x.map(function(C){return _jsxs(jn,{value:C.drugName,children:[_jsxs(Ce,{children:[" ",C.drugName]}),_jsxs(Ce,{type:"secondary",style:{fontSize:12,marginLeft:5},children:["(",C.chemicalName,"-",C.stCompName,")"]})]},C.id)})})},Cn=(0,T.Pi)(function(t){var n,a=t.schema,s=t.title,r=t.onBlur,f=t.onChange,v=a.type,o=((n=a.children)===null||n===void 0?void 0:n.filter(function(l){var i;return(i=l.attribute)===null||i===void 0?void 0:i.fieldInTitle}))||[],u=(0,T.U$)(),m=u.value;return v!=="HorzBlank"||o.length===0?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.Z,{html:s})}):(0,e.jsx)(ge,{schema:a,children:o,content:s,onChange:f,onBlur:r,value:m})}),yn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M839 73.9c-1.2-2.4-3.7-9.8-7.4-9.8s-11.1 8.6-13.5 12.3l-13.5 12.3c-7.4-6.1-35.6-23.4-43-23.4-11.1 0-104.6 113.2-118.1 129.1l-60.2 68.8-30.7 38.1-43.1-83.6-50.4-100.8c-4.9-9.8-8.6-22.1-22.1-22.1-7.3 0-9.8 3.6-13.5 9.8-3.7 4.9-3.7 4.9-11.1 8.6-8.6 0-12.3 0-19.7 6.2-6.2-4.9-11.1-11.1-19.7-11.1-3.7 0-6.2 1.2-8.6 3.6l-8.6 7.4c-4.8 6.1-15.9 17.2-15.9 25.8 0 11 9.8 31.9 13.5 41.8l90.9 250.8-14.7 17.3c-66.4 79.8-159.8 190.5-210.2 279l-29.5 50.4c-8.6 14.7-29.5 44.3-29.5 60.2 0 3.7 3.8 6.2 6.2 8.6 8.6 7.3 3.6 14.7 1.2 24.5-2.5 7.4-3.7 12.3-3.7 19.7 0 13.5 11.1 27 18.5 38.1 7.3 12.2 9.9 24.5 25.8 24.5 17.2 0 49.2-3.6 63.9-14.7l243.4-377.5 115.6 178.5c6.1 9.8 30.7 54.1 46.7 54.1 14.8 0 38.1-16.1 40.6-30.8-2.6-4.9-6.2-12.3-6.2-17.2 0-7.5 19.7-14.9 24.6-19.7v-9.9c8.6-3.7 13.5-8.6 17.2-17.2l-95.9-205.3-38.2-76.3 13.6-19.7 174.6-225.9c11-14.8 28.3-38.1 41.8-50.4 4.9-5 13.5-12.3 13.5-19.7 0-8.6-19.7-22.1-24.6-34.4z","p-id":"14396",fill:"#fe6c56"})}),Zn=(0,e.jsx)("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24",children:(0,e.jsx)("path",{d:"M389.7 604.3L198.2 447.4c-3.7-3-9.1-3-12.8 0.1l-73.3 61.4c-4.4 3.7-4.8 10.3-0.9 14.5l324.1 344.3c5 5.3 13.8 3.6 16.6-3.1 64.4-160.1 244.3-452.8 463.2-664.7 3-2.9 3.9-7.2 2.3-11l-13.7-33c-2.4-5.8-9.5-8-14.7-4.5-243.2 157.7-419.4 353.5-499.3 452.9z",fill:"#fe6c56","p-id":"4913"})}),pn=(0,T.Pi)(function(t){var n,a=t.schema,s=t.seqNo,r=(0,N.Rk)(),f=r.props.correctAnswerVisible,v=r.props.questionScore,o=(n=a.attribute)===null||n===void 0?void 0:n.examAnswerMode;return!f||!v||o==="none"?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{className:"exam-score-info",children:[(0,e.jsxs)("span",{children:["\u7B2C",s,"\u9898"]}),v[a.id]?(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("span",{className:"score",children:["\u5F97\u5206:",v[a.id],"\u5206"]}),Zn]}):yn]})}),ta=g(71194),bn=g(50146);function Te(t){return t?t.substring(0,t.lastIndexOf("[")):"\u70B9\u51FB\u9009\u62E9"}var Sn=function(n){var a=n.onChange,s=n.value,r=n.mapMove,f=r===void 0?!1:r,v=n.optionId,o=(0,b.useRef)(null),u=(0,b.useRef)(),m=(0,b.useRef)(),l=(0,b.useRef)(),i=(0,b.useState)(function(){if(!!s){var A=s.match(/\[(\d+\.\d+),\s*(\d+\.\d+)\]/);if(A&&A.length>2)return[parseFloat(A[1]),parseFloat(A[2])]}}),d=(0,M.Z)(i,2),h=d[0],c=d[1],x=(0,b.useState)(function(){return Te(s)}),j=(0,M.Z)(x,2),y=j[0],C=j[1],Z=(0,b.useState)(!1),S=(0,M.Z)(Z,2),w=S[0],B=S[1],I=(0,b.useCallback)(function(A){m.current.getLocation(A,function(P,$){if(P==="complete"&&$.geocodes.length){var R=$.geocodes[0].location;l.current.start(R)}else console.error("\u6839\u636E\u5730\u5740\u67E5\u8BE2\u4F4D\u7F6E\u5931\u8D25")})},[]);return(0,b.useEffect)(function(){if(!!w){window["localMap".concat(v)]=function(){initAMapUI(),AMapUI.loadUI(["misc/PositionPicker"],function(D){var O=new AMap.Map("map-".concat(v),{zoom:16,center:h,dragEnable:f,zoomEnable:f});if(u.current=O,f){var H=new D({mode:"dragMarker",map:O});H.on("success",function(ee){C(ee.address),c([ee.position.lng,ee.position.lat])}),h?H.start(h):H.start(),O.panBy(0,1),l.current=H}var q=new AMap.Geocoder({city:"010"});m.current=q;var Y=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,offset:[10,20],zoomToAccuracy:!0,position:"RB"});Y.getCurrentPosition(function(ee,le){ee=="complete"?(O.setCenter(le.position),C(le.formattedAddress),c([le.position.lng,le.position.lat])):console.error(le)})})},window._AMapSecurityConfig={securityJsCode:"c92dc7c089f25dcd7944094d3ee1a959"};var A="https://webapi.amap.com/maps?v=1.4.15&key=fce3217057b3ace0b2128cb5d1696c87&callback=localMap".concat(v,"&plugin=AMap.Geocoder,AMap.Geolocation"),P=document.createElement("script");P.src=A,document.head.appendChild(P);var $="https://webapi.amap.com/ui/1.1/main-async.js",R=document.createElement("script");R.src=$,document.head.appendChild(R)}},[w]),(0,e.jsxs)("div",{style:{position:"relative"},children:[(0,e.jsx)(Q.Z.TextArea,{readOnly:!0,value:Te(s),onClick:function(){return B(!0)}}),(0,e.jsxs)(bn.Z,{open:w,onCancel:function(){B(!1)},onOk:function(){h&&a("".concat(y,"[").concat(h[0],", ").concat(h[1],"]")),B(!1)},children:[(0,e.jsx)("div",{style:{display:"flex",justifyContent:"space-between",width:200},children:f&&(0,e.jsx)(Q.Z.Search,{placeholder:"\u8BF7\u8F93\u5165\u8981\u641C\u7D22\u7684\u5730\u70B9\u3001\u8857\u9053",size:"small",onSearch:function(P){return I(P)}})}),(0,e.jsx)("div",{ref:o,id:"map-".concat(v),style:{height:390}}),(0,e.jsx)("div",{style:{height:50,borderTop:"1px solid #b0b0b0",background:"#fff",padding:"12px 18px"},children:y})]})]})},wn=(0,T.Pi)(function(t){var n,a,s=t.qId,r=t.schema,f=(0,N.Rk)(),v=f.reviewAnswer[s],o=(n=r.children)===null||n===void 0?void 0:n.map(function(i){var d;return(d=i.attribute)===null||d===void 0?void 0:d.examCorrectAnswer}).filter(function(i){return i}).join(";"),u=o&&["FillBlank","MultipleBlank","Textarea","HorzBlank"].includes(r.type),m=function(){return u?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u6B63\u786E\u7B54\u6848\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",style:{marginBottom:10},children:o})]}):(0,e.jsx)(e.Fragment,{})},l=function(){var d;if((d=r.attribute)!==null&&d!==void 0&&d.examAnalysis){var h;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"answer-analysis-title",children:"\u7B54\u6848\u89E3\u6790\uFF1A"}),(0,e.jsx)("div",{className:"answer-analysis-content",children:(0,e.jsx)(F.Z,{html:(h=r.attribute)===null||h===void 0?void 0:h.examAnalysis})})]})}return(0,e.jsx)(e.Fragment,{})};return v&&v.visible&&((a=r.attribute)!==null&&a!==void 0&&a.examAnalysis||u)?(0,e.jsxs)("div",{className:"answer-analysis",children:[m(),l()]}):(0,e.jsx)(e.Fragment,{})});function Bn(t){var n=t.schema,a=t.index,s=t.qsIndex,r=t.required,f=t.error,v=t.replaceTitle,o=t.seqNo,u=t.onBlur,m=t.onChange,l=t.onFocus,i=(0,b.useContext)(U.ZX),d=i.questionNumber,h=i.requiredVisible,c=(0,N.AK)("-body-question"),x=(0,b.useState)(),j=(0,M.Z)(x,2),y=j[0],C=j[1],Z=n.description;(0,b.useEffect)(function(){if(y){var B,I;(B=document.querySelector("[data-id='".concat(n.id,"']")))===null||B===void 0||B.classList.remove("ant-form-item-has-error"),(I=document.querySelector("[data-id='".concat(n.id,"']")))===null||I===void 0||I.querySelectorAll("[data-id]").forEach(function(H){H.classList.remove("ant-form-item-has-error")})}if(f.length>0){var A,P=f[0].split("^"),$=(0,M.Z)(P,2),R=$[0],D=$[1],O;D?(O=document.querySelector("[data-id='".concat(R,"']")),C(D)):(O=document.querySelector("[data-id='".concat(n.id,"']")),C(R)),(A=O)===null||A===void 0||A.classList.add("ant-form-item-has-error")}else y&&C(void 0)},[f]);var S="";s!==void 0&&(S+=s+1+"-"),a!==void 0&&(S+=a+1+".");var w=function(){return y?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:y})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsxs)("section",{className:c,children:[(0,e.jsx)("div",{className:"".concat(c,"-head"),children:(0,e.jsxs)("span",{className:c+"-header",children:[(0,e.jsx)(pn,{schema:n,seqNo:o}),(0,e.jsxs)("h2",{className:c+"-header-title",children:[d&&(0,e.jsx)("span",{className:c+"-header-title-seq",children:(0,e.jsx)("b",{children:d?o||S:""})}),r&&h&&(0,e.jsx)("span",{className:c+"-header-title-required",children:(0,e.jsx)("i",{children:"*"})}),(0,e.jsx)("div",{className:c+"-header-title-text",children:(0,e.jsx)(Cn,{schema:n,title:v||n.title,onBlur:u,onChange:m,onFocus:l})}),w()]}),Z&&(0,e.jsx)("div",{className:"question-desc",children:(0,e.jsx)(F.Z,{html:Z})})]})}),(0,e.jsxs)("div",{className:"".concat(c,"-body"),children:[t.children,(0,e.jsx)(un,{qId:n.id}),(0,e.jsx)(wn,{qId:n.id,schema:n})]})]})}(0,E.eC)("Question",(0,T.Pi)(Bn),"antd");function Nn(t){var n=t.schema,a=t.index,s=t.seqNo,r=(0,N.AK)("-body-questionSet"),f=(0,b.useContext)(U.ZX),v=f.questionNumber;return(0,e.jsxs)("div",{className:r,children:[(0,e.jsxs)("div",{className:r+"-title",children:[v?s||"".concat(a+1,"."):"",(0,e.jsx)(F.Z,{html:n.title})]}),t.children,(0,e.jsx)("div",{className:r+"-splitLine"})]})}(0,E.eC)("QuestionSet",Nn,"antd");var aa=g(84305),An=g(88182),En=g(82925),ra=g(22385),Fn=g(94199),ve=g(93224),In=g(39017),Pn=g(49914),Mn=g(78338);function Rn(t){t=Number(t);var n=Math.floor(t/3600),a=Math.floor(t%3600/60),s=Math.floor(t%3600%60),r="".concat(n).padStart(2,"0"),f="".concat(a).padStart(2,"0"),v="".concat(s).padStart(2,"0");return"".concat(r,":").concat(f,":").concat(v)}function Tn(t){return t<=60?"#ff4d4f":t<=180?"#faad14":"#52c41a"}var $n=(0,T.Pi)(function(){var t,n,a=(0,Pn.H)(),s=(0,In.Rk)(),r=a.startTime,f=((t=a.project)===null||t===void 0||(n=t.setting.examSetting)===null||n===void 0?void 0:n.maxSubmitMinutes)||0,v=(0,b.useState)(0),o=(0,M.Z)(v,2),u=o[0],m=o[1],l=r+f*60*1e3,i=(0,b.useRef)();return(0,b.useEffect)(function(){if(f!==0)return i.current=window.setInterval(function(){m((l-new Date().getTime())/1e3)},1e3),function(){clearInterval(i.current)}},[l]),(0,b.useEffect)(function(){u<0&&(s.submit(),clearInterval(i.current))},[u]),f===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)("div",{style:{position:"absolute",right:0,fontSize:13},children:[(0,e.jsx)(Mn.Z,{style:{marginRight:5,color:"#1890ff"}}),"\u5269\u4F59:",(0,e.jsx)("span",{style:{marginLeft:3,color:Tn(u)},children:Rn(u)})]})}),Dn=["size","marked"],$e=(0,T.Pi)(function(t){var n=(0,N.Rk)(),a=n.props.answerSheetVisible,s=t.size,r=t.marked,f=r===void 0?!0:r,v=(0,ve.Z)(t,Dn);return a?(0,e.jsx)(Fn.Z,{title:"\u6807\u8BB0",children:(0,e.jsx)("svg",(0,p.Z)((0,p.Z)({viewBox:"0 0 1024 1024",version:"1.1",width:t.size||24,height:t.size||24,className:"marked"},v),{},{children:(0,e.jsx)("path",{d:"M662.04973405 329.56834123l108.40905238-142.19888693c4.22372932-5.63163908 4.22372932-11.26327817 1.40790978-18.30282702-2.81581955-5.63163908-8.44745863-9.8553684-15.48700748-9.85536841H218.55815604c-9.8553684 0-16.89491725 7.03954885-16.89491725 16.89491726V867.38987389c0 9.8553684 7.03954885 16.89491725 16.89491725 16.89491726s16.89491725-7.03954885 16.89491726-16.89491726V487.25423562h522.33452519c7.03954885 0 12.67118794-4.22372932 15.48700749-9.8553684s1.40790977-12.67118794-2.81581955-18.30282703l-108.40905238-129.52769896z",fill:f?"#EA4942":"#d8d8d8","p-id":"1287"})}))}):(0,e.jsx)(e.Fragment,{})}),On=(0,T.Pi)(function(t){var n=(0,N.Rk)(),a=t.finished,s=t.id,r=t.marked,f=t.seqNo;return(0,e.jsxs)("div",{className:de()("answer-sheet-item",{marked:r,finished:a}),onClick:function(){return n.changePageIndex(s)},children:[f,r&&(0,e.jsx)($e,{style:{position:"absolute",left:20,bottom:18},size:18})]})}),Hn=(0,T.Pi)(function(){var t=(0,N.Rk)(),n=t.answerSheet;return(0,e.jsx)(e.Fragment,{children:n.filter(function(a){return a.display!=="none"}).map(function(a,s){return(0,b.createElement)(On,(0,p.Z)((0,p.Z)({},a),{},{seqNo:s+1,key:a.id}))})})}),Ln=(0,T.Pi)(function(){var t=(0,N.Rk)(),n=t.answerSheet,a=n.filter(function(f){return f.finished}).length,s=n.filter(function(f){return!f.finished}).length,r=n.filter(function(f){return f.marked}).length;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"finished",children:["\u5DF2\u7B54",(0,e.jsx)("span",{style:{marginLeft:4},children:a})]}),(0,e.jsxs)("div",{className:"unFinished",children:["\u672A\u7B54",(0,e.jsx)("span",{style:{marginLeft:4},children:s})]}),(0,e.jsxs)("div",{className:"marked",children:[(0,e.jsx)($e,{size:18}),"\u6807\u8BB0",(0,e.jsx)("span",{style:{marginLeft:4},children:r})]})]})}),kn=(0,T.Pi)(function(){return(0,e.jsxs)("div",{className:"answer-sheet-header",children:["\u7B54\u9898\u5361",(0,e.jsx)($n,{})]})}),zn=(0,T.Pi)(function(){var t=(0,N.Rk)(),n=t.props.answerSheetVisible;return n?(0,e.jsxs)("div",{className:"answer-sheet",children:[(0,e.jsx)(kn,{}),(0,e.jsx)("div",{className:"answer-sheet-content",children:(0,e.jsx)(Hn,{})}),(0,e.jsx)("div",{className:"answer-sheet-footer",children:(0,e.jsx)(Ln,{})})]}):(0,e.jsx)(e.Fragment,{})});pe().locale("zh-cn");function Un(t){var n=t.headerVisible,a=t.footerVisible,s=t.schema,r=(0,N.AK)(),f=(0,N.Al)(),v=function(){var u,m=(u=s.attribute)===null||u===void 0?void 0:u.headerImage;if(m)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(m),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:de()(r,{preview:f.isPreview}),children:[(0,e.jsx)(sn,{}),(0,e.jsx)("div",{className:r+"-banner",children:v()}),n&&(0,e.jsx)(te,{}),(0,e.jsx)(An.ZP,{locale:En.Z,children:(0,e.jsx)(k,{children:t.children})}),a&&(0,e.jsx)(z,{}),(0,e.jsx)(zn,{})]})}(0,E.eC)("Survey",Un,"antd");var ia=g(13062),J=g(71230),la=g(89032),X=g(15746),W=g(32059);function Vn(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children;function v(o,u){a((0,W.Z)({},u,o))}return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(o){var u=o.id,m=o.title,l=o.attribute,i=l===void 0?{}:l,d=i.mapMove;return(0,e.jsxs)(J.Z,{gutter:[10,0],"data-id":u,children:[m&&(0,e.jsx)(X.Z,{span:24},o.id),(0,e.jsx)(X.Z,{span:24,children:(0,e.jsx)(Sn,{optionId:u,onChange:function(c){return v(c,u)},value:r[u],mapMove:d})})]},u)})})}(0,E.RM)("Address",Vn,"antd");var sa=g(43185),ye=g(32620),ua=g(34792),De=g(48086),Ze=g(39428),Oe=g(3182),Wn=g(81473);function Kn(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=t.readOnly,v=n.children,o=v===void 0?[]:v,u=(0,N.Al)(),m=function(){var l=(0,Oe.Z)((0,Ze.Z)().mark(function i(d){var h,c,x,j;return(0,Ze.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:h=d.onSuccess,c=d.onError,x=d.file,j=d.onProgress,u.onUpload&&u.onUpload({file:x,fileType:6},function(Z){j&&j({percent:Z.loaded/Z.total*100})}).then(function(Z){if(Z.success&&h&&(h(Z.data),Z.data.content&&a((0,W.Z)({},o[0].id,Z.data.content))),!Z.success&&c){var S=new Error("Some error");c({event:S})}});case 2:case"end":return C.stop()}},i)}));return function(d){return l.apply(this,arguments)}}();return(0,e.jsx)("div",{children:o==null?void 0:o.map(function(l){var i=l.id,d=l.attribute,h=d===void 0?{}:d,c=h.cameraOnly;return(0,e.jsx)(J.Z,{style:{marginBottom:10},"data-id":i,children:(0,e.jsx)(X.Z,{span:12,children:(0,e.jsx)(Q.Z,{placeholder:"\u70B9\u51FB\u8BC6\u522B\u6761\u7801",value:r[i],addonAfter:(0,e.jsx)(ye.Z,{accept:"image/*",capture:c?"environment":void 0,disabled:f,maxCount:1,beforeUpload:function(j){return h!=null&&h.maxFileSize&&j.size>h.maxFileSize*1024*1024?(De.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(h.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),ye.Z.LIST_IGNORE):!0},customRequest:m,showUploadList:!1,children:(0,e.jsx)(Wn.Z,{})},i)})})},i)})})}(0,E.RM)("Barcode",Kn,"antd");var oa=g(36877),Yn=g(18480);function Gn(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f;function o(u){var m={};u.forEach(function(l,i){var d=v[i].id;m[d]=l}),a(m)}return(0,e.jsx)(J.Z,{children:(0,e.jsx)(X.Z,{span:12,children:(0,e.jsx)(Yn.Z,{value:v.map(function(u){return r[u.id]}).filter(function(u){return u}),style:{width:260},options:n.dataSource,onChange:o,placeholder:"\u8BF7\u9009\u62E9"})})})}(0,E.RM)("Cascader",Gn,"antd");function Xn(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=t.onBlur,v=n.children,o=n.attribute,u=24/((o==null?void 0:o.columns)||1),m=(0,N.AK)("-body-question"),l=!!(o!=null&&o.statEnabled),i=(0,N.Rk)(),d=i.hiddenOption[n.id]||[];(0,b.useEffect)(function(){var c=Object.keys(r),x=!1;c.forEach(function(j){d.includes(j)&&(x=!0,delete r[j])}),x&&a((0,p.Z)({},r))},[d]);function h(c,x,j){return x?r[c]=j||!0:delete r[c],(0,p.Z)({},r)}return(0,b.useEffect)(function(){v==null||v.forEach(function(c){var x;(x=c.attribute)!==null&&x!==void 0&&x.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},c.id,!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(J.Z,{children:v==null?void 0:v.filter(function(c){return!d.includes(c.id)}).map(function(c){var x,j,y,C=c.id,Z=(x=c.attribute)===null||x===void 0?void 0:x.dataType,S=(j=c.attribute)===null||j===void 0?void 0:j.suffix,w=(y=c.attribute)===null||y===void 0?void 0:y.readOnly;return(0,e.jsxs)(X.Z,{span:u,className:m+"-option","data-id":C,children:[(0,e.jsx)(hn,{qId:n.id,schema:c,checked:r.hasOwnProperty(C),onChange:function(I,A){return a(h(C,I,A))},value:typeof r[C]=="boolean"?{}:r[C],onBlur:f}),l&&(0,e.jsx)(Fe,{checked:!!r[C],optionId:C,questionId:n.id,checkedCount:Object.keys(r).length}),Z&&(0,e.jsx)(ae,{value:typeof r[C]=="boolean"?"":r[C],style:{maxWidth:200},type:Z,onChange:function(I){return a(h(C,!0,I))},onBlur:function(I){return f(h(C,!0,I))},readOnly:w,suffix:S&&(0,e.jsx)("span",{className:m+"-option-suffix",children:(0,e.jsx)(F.Z,{html:S})})})]},C)})})})}(0,E.RM)("Checkbox",(0,T.Pi)(Xn),"antd");var da=g(71153),He=g(60331),ca=g(62999),Qn=g(54680),re=g(3980),Jn=g(60780),qn=g.n(Jn);function _n(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=v[0].id,u=(0,b.useState)([]),m=(0,M.Z)(u,2),l=m[0],i=m[1];function d(c){o&&((c==null?void 0:c.length)===0?a(void 0):a((0,W.Z)({},o,c==null?void 0:c.map(function(x){return x.value}))))}var h=(0,b.useMemo)(function(){return qn()(l.map(function(c){return{title:c.name,key:c.id,value:c.id,parentId:c.parentId}}),{parentProperty:"parentId",customID:"key"})},[l]);return(0,b.useEffect)(function(){re.hi.selectDept({}).then(function(c){c.success&&i(c.data)})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(X.Z,{span:24,children:(0,e.jsx)(Qn.Z,{style:{width:"100%"},treeCheckable:!0,value:(r[o]||[]).map(function(c){return{value:c}}),treeCheckStrictly:!0,showCheckedStrategy:"SHOW_ALL",dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:h,placeholder:"\u8BF7\u9009\u62E9",treeDefaultExpandAll:!0,onChange:d,showSearch:!1})})})}var et=function(n){var a=n.schema,s=n.value,r=s===void 0?{}:s,f=a.children,v=f===void 0?[]:f,o=v[0].id,u=(0,b.useState)([]),m=(0,M.Z)(u,2),l=m[0],i=m[1];return(0,b.useEffect)(function(){re.hi.selectDept({selected:r[o]||[],name:"^_^"}).then(function(d){d.success&&i(d.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Ee.Z,{children:l.map(function(d){return(0,e.jsx)(He.Z,{color:"blue",children:d.name},d.id)})})})};(0,E.RM)("Dept",_n,"antd"),(0,E.cf)("Dept",et,"antd");function Le(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=t.onBlur,v=n.children,o=(0,N.AK)("-body-question");function u(l,i){r[l]=i,i===""&&delete r[l],a((0,p.Z)({},r),l)}function m(l,i){r[l]=i,i===""&&delete r[l],f((0,p.Z)({},r),l)}return(0,e.jsx)("div",{children:v==null?void 0:v.map(function(l){var i=l.id,d=l.title;return(0,e.jsxs)(J.Z,{style:{marginBottom:10},"data-id":i,children:[d&&(0,e.jsx)(X.Z,{className:o+"-option",span:4,children:l.title&&(0,e.jsx)("span",{className:o+"-option-title",children:(0,e.jsx)(F.Z,{html:l.title})})},l.id),(0,e.jsxs)(X.Z,{span:12,className:o+"-option",children:[(0,e.jsx)(xn,{qId:n.id,schema:l,value:r,onChange:function(c){return u(i,c)},onBlur:function(c){return m(i,c)}}),(0,e.jsx)(be,{schema:l,type:n.type})]})]},i)})})}(0,E.RM)("FillBlank",Le,"antd"),(0,E.RM)("MultipleBlank",Le,"antd");function nt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=t.onBlur,v=n.children,o=n.attribute,u=o===void 0?{}:o,m=u.content;return!m||!v?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)(ge,{schema:n,children:v.filter(function(l){var i;return!((i=l.attribute)!==null&&i!==void 0&&i.fieldInTitle)}),content:m,onBlur:f,onChange:a,value:r})}var tt=function(n){var a=n.schema,s=n.value,r=a.children,f=a.attribute,v=f===void 0?{}:f,o=v.content;return(0,e.jsx)("div",{className:"preview pe-view",children:(0,e.jsx)(F.Z,{html:Pe(o,r,s),replaceP:!1},Math.random())})};(0,E.RM)("HorzBlank",nt,"antd"),(0,E.cf)("HorzBlank",tt,"antd");var Se=g(83279),ie=g(79521),at=g(54121),rt=function(n){var a=(0,re.XI)(200),s=(0,M.Z)(a,2),r=s[0],f=s[1],v=(0,re.XI)(200),o=(0,M.Z)(v,2),u=o[0],m=o[1];return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},n.getRowProps()),{},{className:"tr",style:{position:"relative"},ref:r,children:[n.cells.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getCellProps()),{},{className:"td","data-id":"".concat(n.i,"-").concat(l.column.id),children:l.render("Cell")}))}),n.onDelete&&(0,e.jsx)("div",{ref:u,style:{position:"absolute",left:-20,top:0,height:48,width:24,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(at.Z,{onClick:function(){n.onDelete()},style:{color:"#f5222d",cursor:"pointer",visibility:f||m?"visible":"hidden"}})})]}))};function ke(t){var n=t.columns,a=t.data,s=t.onAdd,r=t.onDelete,f=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),v=(0,ie.useTable)({columns:n,data:a,defaultColumn:f},ie.useBlockLayout),o=v.getTableProps,u=v.getTableBodyProps,m=v.headerGroups,l=v.rows,i=v.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},o()),{},{className:"table",children:[(0,e.jsx)("div",{children:m.map(function(d){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},d.getHeaderGroupProps()),{},{className:"tr",children:d.headers.map(function(h){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},h.getHeaderProps()),{},{className:"th",children:h.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},u()),{},{children:l.map(function(d,h){return i(d),(0,b.createElement)(rt,(0,p.Z)((0,p.Z)({},d),{},{key:h,i:h,onDelete:r?function(){return r(h)}:void 0}))})})),s&&(0,e.jsx)("div",{className:"footer",onClick:s,children:"+ \u7EE7\u7EED\u586B\u5199"})]}))}function it(t){var n=t.schema,a=t.onChange,s=t.value||[{}],r=n.children,f=r===void 0?[]:r,v=(0,b.useMemo)(function(){return f.map(function(o){var u;return{Header:(0,e.jsx)(F.Z,{html:o.title}),width:(u=o.attribute)===null||u===void 0?void 0:u.width,accessor:o.id,Cell:function(l){var i,d=l.value,h=l.row,c=l.data;if(((i=o.attribute)===null||i===void 0?void 0:i.dataType)==="select"){var x;return(0,e.jsx)(oe.Z,{placeholder:"\u8BF7\u9009\u62E9",value:d,style:{minWidth:80},onChange:function(y){c[h.index][o.id]=y},options:((x=o.dataSource)===null||x===void 0?void 0:x.map(function(j){return{label:j.label,value:j.value}}))||[]})}else return(0,e.jsx)(Q.Z,{value:d,onChange:function(y){c[h.index][o.id]=y.target.value,a((0,Se.Z)(c))}})}}})},[]);return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(ke,{columns:v,data:s,onAdd:function(){s.push({}),a((0,Se.Z)(s))},onDelete:function(u){s.splice(u,1),a((0,Se.Z)(s))}})})}var lt=function(n){var a=n.schema,s=n.value||[{},{}],r=a.children,f=r===void 0?[]:r,v=(0,b.useMemo)(function(){return f.map(function(o){var u;return{Header:(0,e.jsx)(F.Z,{html:o.title}),width:(u=o.attribute)===null||u===void 0?void 0:u.width,accessor:o.id,Cell:function(l){var i,d=l.value,h=l.row,c=l.data;if(((i=o.attribute)===null||i===void 0?void 0:i.dataType)==="select"){var x,j,y=((x=o.dataSource)===null||x===void 0||(j=x.find(function(C){return C.value===d}))===null||j===void 0?void 0:j.label)||"";return(0,e.jsx)("span",{children:y})}else return(0,e.jsx)("span",{children:d})}}})},[]);return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(ke,{columns:v,data:s})})};(0,E.RM)("MatrixAuto",it,"antd"),(0,E.cf)("MatrixAuto",lt,"antd");var st=["title","rowId"],ut=["title","rowId"];function ze(t){var n=t.columns,a=t.data,s=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ie.useTable)({columns:n,data:a,defaultColumn:s},ie.useBlockLayout),f=r.getTableProps,v=r.getTableBodyProps,o=r.headerGroups,u=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:o.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},v()),{},{children:u.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td",children:i.render("Cell")}))})}))})}))]}))}function ot(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=n.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var i,d=v.map(function(h){var c;return{Header:(0,e.jsx)(F.Z,{html:h.title}),width:(c=h.attribute)===null||c===void 0?void 0:c.width,accessor:h.id,Cell:function(j){var y,C=j.value,Z=j.row,S=j.data,w=(y=h.attribute)===null||y===void 0?void 0:y.dataType;return(0,e.jsxs)("div",{onClick:function(I){var A=!C,P={};S.forEach(function($,R){var D=$.title,O=$.rowId,H=(0,ve.Z)($,st);Z.index===R&&(A?H[h.id]=!0:delete H[h.id]),P[O]=H}),a(P)},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,e.jsx)(xe.Z,{checked:!!C}),w?(0,e.jsx)(ae,{type:w,style:{width:120,marginLeft:5},value:C===!0?"":C,onChange:function(I){var A={};S.forEach(function(P,$){var R=P.title,D=P.rowId,O=(0,ve.Z)(P,ut);Z.index===$&&(O[h.id]=I),A[D]=O}),a(A)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return d.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=n.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),d},[]),l=u.map(function(i,d){var h=i.id,c=r[h]||{};return(0,p.Z)({title:(0,e.jsx)(F.Z,{html:i.title}),rowId:h},c)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(ze,{columns:m,data:l})})}var dt=function(n){var a=n.schema,s=n.value,r=s===void 0?{}:s,f=a.children,v=f===void 0?[]:f,o=a.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var i,d=v.map(function(h){var c;return{Header:(0,e.jsx)(F.Z,{html:h.title}),width:(c=h.attribute)===null||c===void 0?void 0:c.width,accessor:h.id,Cell:function(j){var y=j.value,C=j.row,Z=j.data;return y?(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:!!y,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return d.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=a.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),d},[]),l=u.map(function(i,d){var h=i.id,c=r[h]||{};return(0,p.Z)({title:(0,e.jsx)(F.Z,{html:i.title}),rowId:h},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(ze,{columns:m,data:l})})};(0,E.RM)("MatrixCheckbox",ot,"antd"),(0,E.cf)("MatrixCheckbox",dt,"antd");var ct=["title","rowId"];function Ue(t){var n=t.columns,a=t.data,s=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ie.useTable)({columns:n,data:a,defaultColumn:s},ie.useBlockLayout),f=r.getTableProps,v=r.getTableBodyProps,o=r.headerGroups,u=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:o.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},v()),{},{children:u.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td","data-id":"".concat(l.original.rowId,"-").concat(i.column.id),children:i.render("Cell")}))})}))})}))]}))}function vt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=n.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var i,d=v.map(function(h){var c;return{Header:(0,e.jsx)(F.Z,{html:h.title}),width:(c=h.attribute)===null||c===void 0?void 0:c.width,accessor:h.id,Cell:function(j){var y=j.value,C=j.row,Z=j.data;return(0,e.jsx)(ae,{value:y,onChange:function(w){var B={};Z.forEach(function(I,A){var P=I.title,$=I.rowId,R=(0,ve.Z)(I,ct);C.index===A&&(R[h.id]=w),B[$]=R}),a(B)}})}}});return d.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:((i=n.attribute)===null||i===void 0?void 0:i.width)||150,accessor:"title"}),d},[]),l=u.map(function(i,d){var h=i.id,c=r[h]||{};return(0,p.Z)({title:(0,e.jsx)(F.Z,{html:i.title}),rowId:h},c)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(Ue,{columns:m,data:l})})}var ht=function(n){var a=n.schema,s=n.value,r=s===void 0?{}:s,f=a.children,v=f===void 0?[]:f,o=a.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var i,d=v.map(function(h){var c;return{Header:function(){return(0,e.jsx)(F.Z,{html:h.title})},width:(c=h.attribute)===null||c===void 0?void 0:c.width,accessor:h.id,Cell:function(j){var y=j.value;return(0,e.jsx)("span",{children:y})}}});return d.splice(0,0,{Header:(0,e.jsx)(e.Fragment,{}),width:(i=a.attribute)===null||i===void 0?void 0:i.width,accessor:"title"}),d},[]),l=u.map(function(i,d){var h=i.id,c=r[h]||{};return(0,p.Z)({title:i.title,rowId:h},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(Ue,{columns:m,data:l})})};(0,E.RM)("MatrixFillBlank",vt,"antd"),(0,E.cf)("MatrixFillBlank",ht,"antd");var ft=["title","rowId"],mt=["title","rowId"];function Ve(t){var n=t.columns,a=t.data,s=b.useMemo(function(){return{minWidth:100,width:150,maxWidth:400}},[]),r=(0,ie.useTable)({columns:n,data:a,defaultColumn:s},ie.useBlockLayout),f=r.getTableProps,v=r.getTableBodyProps,o=r.headerGroups,u=r.rows,m=r.prepareRow;return(0,e.jsxs)("div",(0,p.Z)((0,p.Z)({},f()),{},{className:"table",children:[(0,e.jsx)("div",{children:o.map(function(l){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getHeaderGroupProps()),{},{className:"tr",children:l.headers.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getHeaderProps()),{},{className:"th",children:i.render("Header")}))})}))})}),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},v()),{},{children:u.map(function(l){return m(l),(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},l.getRowProps()),{},{className:"tr",children:l.cells.map(function(i){return(0,e.jsx)("div",(0,p.Z)((0,p.Z)({},i.getCellProps()),{},{className:"td",children:i.render("Cell")}))})}))})}))]}))}function xt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=n.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var d;return((d=n.children)===null||d===void 0?void 0:d.filter(function(h){var c;return(c=h.attribute)===null||c===void 0?void 0:c.exclusiveFillBlankInMatrix}).map(function(h){return h.id}))||[]},[n]),l=(0,b.useMemo)(function(){var d,h,c=v.map(function(x){var j;return{Header:(0,e.jsx)(F.Z,{html:x.title}),width:(j=x.attribute)===null||j===void 0?void 0:j.width,accessor:x.id,Cell:function(C){var Z,S,w=C.value,B=C.row,I=C.data,A=(Z=x.attribute)===null||Z===void 0?void 0:Z.exclusiveFillBlankInMatrix,P=(S=x.attribute)===null||S===void 0?void 0:S.dataType;return(0,e.jsxs)("div",{onClick:function(){if(!A){var R={};I.forEach(function(D,O){var H=D.title,q=D.rowId,Y=(0,ve.Z)(D,ft);B.index===O?(R[q]={},m.forEach(function(ee){R[q][ee]=Y[ee]}),R[q][x.id]=!0):R[q]=Y}),a(R)}},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[!A&&(0,e.jsx)(je.ZP,{checked:!!w}),P?(0,e.jsx)(ae,{type:P,style:{width:120},value:w===!0?"":w,onChange:function(R){var D={};I.forEach(function(O,H){var q=O.title,Y=O.rowId,ee=(0,ve.Z)(O,mt);B.index===H?(A?D[Y]=ee:(D[Y]={},m.forEach(function(le){D[Y][le]=ee[le]})),D[Y][x.id]=R):D[Y]=ee}),a(D)},onBlur:function(){}}):(0,e.jsx)("div",{style:{height:32,width:1}})]})}}});return c.splice(0,0,{Header:(0,e.jsx)(F.Z,{html:(d=n.attribute)===null||d===void 0?void 0:d.cornerText}),width:((h=n.attribute)===null||h===void 0?void 0:h.width)||150,accessor:"title"}),c},[]),i=u.map(function(d,h){var c=d.id,x=r[c]||{};return(0,p.Z)({title:(0,e.jsx)(F.Z,{html:d.title}),rowId:c},x)});return(0,e.jsx)("div",{className:"table-container",children:(0,e.jsx)(Ve,{columns:l,data:i})})}var gt=function(n){var a=n.schema,s=n.value,r=s===void 0?{}:s,f=a.children,v=f===void 0?[]:f,o=a.row,u=o===void 0?[]:o,m=(0,b.useMemo)(function(){var i,d,h=v.map(function(c){var x;return{Header:(0,e.jsx)(F.Z,{html:c.title}),width:(x=c.attribute)===null||x===void 0?void 0:x.width,accessor:c.id,Cell:function(y){var C=y.value,Z=y.row,S=y.data;return C?(0,e.jsx)("div",{children:(0,e.jsx)(je.ZP,{checked:!!C,disabled:!0})}):(0,e.jsx)(e.Fragment,{})}}});return h.splice(0,0,{Header:(0,e.jsx)(F.Z,{html:(i=a.attribute)===null||i===void 0?void 0:i.cornerText}),width:((d=a.attribute)===null||d===void 0?void 0:d.width)||150,accessor:"title"}),h},[]),l=u.map(function(i,d){var h=i.id,c=r[h]||{};return(0,p.Z)({title:(0,e.jsx)(F.Z,{html:i.title}),rowId:h},c)});return(0,e.jsx)("div",{className:"preview table-container",style:{flexDirection:"row"},children:(0,e.jsx)(Ve,{columns:m,data:l})})};(0,E.RM)("MatrixRadio",xt,"antd"),(0,E.cf)("MatrixRadio",gt,"antd");function jt(t){for(var n=[],a=2;a<t+2;a++)n.push(a/(t+2));return n}function Ct(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[],r=t;r<=n;r++)s.push(r);return a&&s.reverse(),s}function yt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=v[0].id,u=(0,b.useState)(function(){return r[o]||-1}),m=(0,M.Z)(u,2),l=m[0],i=m[1];function d(c){a((0,W.Z)({},o,c))}(0,b.useEffect)(function(){Object.keys(r).length>0&&i(r[o])},[r,o]);var h=function(x){var j=r[x.id],y=x.attribute||{},C=y.scope,Z=C===void 0?"[0,10]":C,S=y.npsInvertSort,w=y.npsStart,B=w===void 0?"\u4E0D\u53EF\u80FD":w,I=y.npsEnd,A=I===void 0?"\u6781\u6709\u53EF\u80FD":I,P=Z.replace("[","").replace("]","").split(","),$=(0,M.Z)(P,2),R=$[0],D=$[1],O=jt(l||0);return(0,e.jsxs)("div",{className:"nps",onMouseLeave:function(){i(j)},children:[(0,e.jsx)("div",{className:"nps-container",children:Ct(parseInt(R),parseInt(D),S).map(function(H){var q={background:"#2672ff",opacity:O[H]};return(0,e.jsx)("div",{className:"nps-item",style:l>=H?q:void 0,onMouseOver:function(){i(H)},onClick:function(){return d(H)},children:H},H)})}),(0,e.jsxs)("div",{className:"nps-tip",children:[(0,e.jsx)("div",{children:S?A:B}),(0,e.jsx)("div",{children:S?B:A})]})]},x.id)};return(0,e.jsx)(J.Z,{children:v.map(function(c){return h(c)})})}(0,E.RM)("Nps",yt,"antd");var Zt=je.ZP.Group;function pt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=t.onBlur,v=n.children,o=n.attribute,u=24/((o==null?void 0:o.columns)||1),m=(0,N.AK)("-body-question"),l=!!(o!=null&&o.statEnabled),i=(0,N.Rk)(),d=i.hiddenOption[n.id]||[];function h(j){var y,C=j.target.value,Z=(y=n.children)===null||y===void 0?void 0:y.find(function(w){return w.id===C});if(Z){var S=Z.id;a((0,W.Z)({},j.target.value,r[S]||!0))}}(0,b.useEffect)(function(){var j=Object.keys(r)[0];d.includes(j)&&a(void 0)},[d]);function c(j,y){a((0,W.Z)({},j,y||!0),j)}function x(j,y){f((0,W.Z)({},j,y||!0),j)}return(0,b.useEffect)(function(){var j;(j=n.children)===null||j===void 0||j.forEach(function(y){var C,Z=y.id,S=y.attribute,w=S==null?void 0:S.dataType;(C=y.attribute)!==null&&C!==void 0&&C.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},Z,w?r[Z]:!0))})},[]),(0,e.jsx)("div",{children:(0,e.jsx)(Zt,{onChange:h,value:Object.keys(r)[0],style:{width:"100%"},children:(0,e.jsx)(J.Z,{children:v==null?void 0:v.filter(function(j){return!d.includes(j.id)}).map(function(j){var y,C,Z,S=j.id,w=(y=j.attribute)===null||y===void 0?void 0:y.dataType,B=(C=j.attribute)===null||C===void 0?void 0:C.suffix,I=(Z=j.attribute)===null||Z===void 0?void 0:Z.readOnly;return(0,e.jsxs)(X.Z,{span:u,className:m+"-option","data-id":S,children:[(0,e.jsx)(mn,{qId:n.id,schema:j,value:r[S],onChange:function(P){return c(S,P)},onBlur:function(P){return x(S,P)}}),l&&(0,e.jsx)(Fe,{checked:!!r[S],optionId:S,questionId:n.id,checkedCount:Object.keys(r).length}),w&&(0,e.jsx)(ae,{value:r[S]===!0?"":r[S],type:w,schema:j,readOnly:I,style:{maxWidth:200},onChange:function(P){return c(S,P)},onBlur:function(P){return x(S,P)},suffix:B&&(0,e.jsx)("span",{className:m+"-option-suffix",children:(0,e.jsx)(F.Z,{html:B})})})]},S)})})})})}(0,E.RM)("Radio",(0,T.Pi)(pt),"antd");function bt(t){var n=(0,N.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(_.hl,{html:"".concat(t.replaceTitle||t.schema.title||"")})})}var St=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(_.hl,{html:"".concat(n.replaceTitle||n.schema.title||"")})})};(0,E.RM)("Remark",bt,"antd"),(0,E.cf)("Remark",St,"antd");var va=g(96433),we=g(2864),We=g(41687),wt=g(46870),Ke=g(18613),Bt=g(57206),Nt={1:(0,e.jsx)(We.Z,{}),2:(0,e.jsx)(We.Z,{}),3:(0,e.jsx)(wt.Z,{}),4:(0,e.jsx)(Ke.Z,{}),5:(0,e.jsx)(Ke.Z,{})};function At(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f;function o(m,l){a((0,W.Z)({},m,l))}var u=function(l){var i=l.attribute||{},d=l.id,h=i.scope,c=h===void 0?"[0,5]":h,x=i.scoreStyle,j=c.replace("[","").replace("]","").split(","),y=(0,M.Z)(j,2),C=y[0],Z=y[1];return x==="heart"?(0,e.jsx)(we.Z,{defaultValue:parseInt(C),character:(0,e.jsx)(Bt.Z,{}),style:{color:"#ea7463"},value:r[d],count:parseInt(Z),onChange:function(w){return o(d,w)}},d):x==="smile"?(0,e.jsx)(we.Z,{defaultValue:parseInt(C),character:function(w){var B=w.index;return Nt[B+1]},count:parseInt(Z),onChange:function(w){return o(d,w)},value:r[d]},d):(0,e.jsx)(we.Z,{defaultValue:parseInt(C),count:parseInt(Z),value:r[d],onChange:function(w){return o(d,w)}},d)};return(0,e.jsx)(J.Z,{children:v.map(function(m){return u(m)})})}(0,E.RM)("Score",At,"antd");function Et(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f;function o(u){var m,l=(m=n.children)===null||m===void 0?void 0:m.find(function(i){return i.id===u});l&&a((0,W.Z)({},u,!0))}return(0,b.useEffect)(function(){var u;(u=n.children)===null||u===void 0||u.forEach(function(m){var l,i=m.id;(l=m.attribute)!==null&&l!==void 0&&l.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},i,!0))})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(X.Z,{span:12,children:(0,e.jsx)(oe.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,onClear:function(){a(void 0)},showSearch:!0,value:Object.keys(r)[0],filterOption:function(m,l){return(l==null?void 0:l.label).toLowerCase().indexOf(m.toLowerCase())!==-1},onChange:o,style:{width:260},options:v.map(function(u){return{label:u.title,value:u.id}})})})})}(0,E.RM)("Select",Et,"antd");var ha=g(34669),Ft=g(82833);function Ye(t){var n=t.schema,a=t.onChange,s=n.children,r=(0,N.Al)(),f=(0,b.useState)(0),v=(0,M.Z)(f,2),o=v[0],u=v[1];function m(l,i){var d="signature-".concat(i,"-").concat((0,U.kb)(6),".png");if(!r.onUpload){a((0,W.Z)({},i,[d]));return}fetch(l).then(function(h){return h.blob()}).then(function(h){var c=new File([h],d,{type:"image/png"});r.onUpload({file:c},function(x){u(x.loaded/x.total*100)}).then(function(x){x.success&&x.data.id&&a((0,W.Z)({},i,[x.data.id]))})})}return(0,e.jsx)("div",{children:s==null?void 0:s.map(function(l){var i=l.id,d=l.title;return(0,e.jsxs)(J.Z,{gutter:[10,0],"data-id":i,children:[d&&(0,e.jsx)(X.Z,{span:24},l.id),(0,e.jsxs)(X.Z,{span:24,children:[(0,e.jsx)(rn,{onChange:function(c){return m(c,i)}}),o>0&&o!==100&&(0,e.jsx)(Ft.Z,{percent:o,size:"small",showInfo:!1})]})]},i)})})}Ye.Preview=function(t){var n=t.value,a;return n&&(a=Object.values(n)[0][0]),(0,e.jsx)("div",{className:"preview signature-print",children:a&&(0,e.jsx)("img",{src:"/api/file?id=".concat(a)})})},(0,E.RM)("Signature",Ye,"antd");var Be=g(27049);function It(t){var n=(0,N.AK)("-body-question");return(0,e.jsx)("div",{className:n,children:(0,e.jsx)(Be.Z,{plain:!0})})}var Pt=function(n){return(0,e.jsx)("div",{children:(0,e.jsx)(Be.Z,{plain:!0})})};(0,E.RM)("SplitLine",It,"antd"),(0,E.cf)("SplitLine",Pt,"antd");function Mt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=(0,N.AK)("-body-question");function o(u,m){r[u]=m,m===""&&delete r[u],a((0,p.Z)({},r))}return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(u){var m=u.id,l=u.attribute,i=u.title,d=(0,U.Ck)(l==null?void 0:l.autoSize,[2,4]);return(0,e.jsxs)(J.Z,{style:{marginBottom:10},"data-id":m,children:[i&&(0,e.jsx)(X.Z,{className:v+"-option",span:4,children:u.title&&(0,e.jsx)("span",{className:v+"-option-title",children:u.title})},u.id),(0,e.jsx)(X.Z,{span:12,children:(0,e.jsx)(Q.Z.TextArea,{autoSize:{minRows:d[1],maxRows:d[2]},value:r[m]||"",onChange:function(c){return o(m,c.target.value)}})})]},m)})})}(0,E.RM)("Textarea",Mt,"antd");var Rt=g(43347),Tt=ye.Z.Dragger;function $t(t){var n=t.schema,a=t.onChange,s=t.value,r=t.readOnly,f=n.children,v=(0,N.Al)(),o=(0,b.useState)(),u=(0,M.Z)(o,2),m=u[0],l=u[1];(0,b.useEffect)(function(){var h=n.children[0].id,c=s&&s[h]||[];m==null&&c.length>0&&re.hi.loadFiles({ids:c}).then(function(x){l(x==null?void 0:x.map(function(j){return{name:j.originalName,uid:j.id,status:"done"}}))})},[s]);var i=function(){var h=(0,Oe.Z)((0,Ze.Z)().mark(function c(x){var j,y,C,Z;return(0,Ze.Z)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:j=x.onSuccess,y=x.onError,C=x.file,Z=x.onProgress,v.onUpload&&v.onUpload({file:C},function(B){Z&&Z({percent:B.loaded/B.total*100})}).then(function(B){if(B.success&&j&&j(B.data),!B.success&&y){var I=new Error("Some error");y({event:I})}});case 2:case"end":return w.stop()}},c)}));return function(x){return h.apply(this,arguments)}}(),d=function(c,x){if(l(c.fileList),(c.file.status==="removed"||c.file.status==="done")&&!c.fileList.find(function(y){return y.status!=="done"})){var j=c.fileList.filter(function(y){return y.status==="done"}).map(function(y){var C;return((C=y.response)===null||C===void 0?void 0:C.id)||y.uid});j.length===0?a(void 0):a((0,W.Z)({},x,j))}};return(0,e.jsx)("div",{children:f==null?void 0:f.map(function(h){var c=h.id,x=h.attribute,j=[];if(x){var y=x.maxFileCount,C=x.maxFileSize,Z=x.fileAccept;y&&j.push("\u6700\u591A\u4E0A\u4F20".concat(y,"\u4E2A")),C&&j.push("\u9650\u5236\u6BCF\u4E2A\u6587\u4EF6".concat(C,"M\u4EE5\u5185")),Z&&j.push("\u4EC5\u652F\u6301\u6587\u4EF6\u7C7B\u578B\uFF1A".concat(Z))}return(0,e.jsxs)(Tt,{multiple:!0,disabled:r,maxCount:(x==null?void 0:x.maxFileCount)||20,accept:x==null?void 0:x.fileAccept,beforeUpload:function(w){return x!=null&&x.maxFileSize&&w.size>x.maxFileSize*1024*1024?(De.default.error("\u6700\u5927\u53EA\u80FD\u4E0A\u4F20 ".concat(x.maxFileSize,"M \u5927\u5C0F\u7684\u6587\u4EF6")),ye.Z.LIST_IGNORE):!0},customRequest:i,onChange:function(w){return d(w,c)},fileList:m,children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(Rt.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:"\u9009\u62E9\u6216\u62D6\u62FD\u4E0A\u4F20\u6587\u4EF6"}),(0,e.jsx)("p",{className:"ant-upload-hint",children:j.join(",")})]},c)})})}(0,E.RM)("Upload",$t,"antd");var Dt=g(55686),Ot=g(95459),Ht=oe.Z.Option;function Lt(t){var n=t.schema,a=t.onChange,s=t.value,r=s===void 0?{}:s,f=n.children,v=f===void 0?[]:f,o=v[0].id,u=(0,b.useState)([]),m=(0,M.Z)(u,2),l=m[0],i=m[1];function d(x){o&&a((0,W.Z)({},o,x))}var h=(0,re.zE)(function(x){re.hi.selectUser({name:x,selected:r[o]||[]}).then(function(j){j.success&&i(j.data)})},5),c=function(j){d(j?l.map(function(y){return y.userId}):void 0)};return(0,b.useEffect)(function(){var x;h(""),(x=n.children)===null||x===void 0||x.forEach(function(j){var y,C=j.id;(y=j.attribute)!==null&&y!==void 0&&y.defaultChecked&&Object.keys(r).length===0&&a((0,W.Z)({},C,!0))})},[]),(0,e.jsx)(J.Z,{children:(0,e.jsx)(X.Z,{span:24,children:(0,e.jsx)(oe.Z,{placeholder:"\u8BF7\u9009\u62E9",allowClear:!0,filterOption:!1,mode:"multiple",onClear:function(){a(void 0)},style:{width:"100%"},value:r[o]||[],onSearch:h,showSearch:!0,onChange:d,dropdownRender:function(j){return(0,e.jsxs)("div",{children:[j,(0,e.jsx)(Be.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",paddingLeft:10},children:(0,e.jsx)(xe.Z,{onChange:function(C){c(C.target.checked)},children:"\u5168\u9009"})})]})},children:l.map(function(x){return(0,e.jsx)(Ht,{value:x.userId,label:x.name,children:(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{role:"img",style:{marginRight:10},children:(0,e.jsx)(Dt.Z,{user:x,size:20})}),x.name," ",x.deptName&&"(".concat(x.deptName,")")]})},x.userId)})})})})}var kt=function(n){var a=n.schema,s=n.value,r=s===void 0?{}:s,f=a.children,v=f===void 0?[]:f,o=v[0].id,u=(0,b.useState)([]),m=(0,M.Z)(u,2),l=m[0],i=m[1];return(0,b.useEffect)(function(){re.hi.selectUser({selected:r[o]||[],name:"^_^"}).then(function(d){d.success&&i(d.data)})},[]),(0,e.jsx)("div",{className:"preview",children:(0,e.jsx)(Ot.Z,{children:l.map(function(d){return(0,e.jsx)(He.Z,{color:"blue",children:d.name},d.userId)})})})};(0,E.RM)("User",Lt,"antd"),(0,E.cf)("User",kt,"antd");var zt=g(73328),Ut=function(n){var a=(0,b.useRef)(null),s=(0,b.useState)(!1),r=(0,M.Z)(s,2),f=r[0],v=r[1];return(0,zt.Z)(a,function(){v(!1)}),(0,e.jsx)("div",{className:de()("preview",{active:f}),ref:a,onClick:function(){v(!0)},children:(0,e.jsx)(F.Z,{html:Object.values(n.value||{})[0]})})};(0,U.cf)("RichText",Ut,"antd");var Vt=function(n){return(0,e.jsx)(e.Fragment,{children:n.children})},Wt=Vt;(0,U.RM)("RichText",(0,b.lazy)(function(){return Promise.all([g.e(9548),g.e(4177),g.e(6779),g.e(2684),g.e(6625),g.e(8764),g.e(596),g.e(2370),g.e(811),g.e(62)]).then(g.bind(g,27321))}),"antd"),(0,U.cf)("Upload",(0,b.lazy)(function(){return Promise.all([g.e(9548),g.e(6779),g.e(6661),g.e(4502),g.e(9452)]).then(g.bind(g,43640))}),"antd")},55686:function(fe,ne,g){"use strict";var M=g(11849),U=g(94233),F=g(51890),T=g(93224),b=g(89366),N=g(85893),E=["user"],_=function(te){var k=te.user,V=(0,T.Z)(te,E);return!k||!k.avatar?(0,N.jsx)(F.C,(0,M.Z)({icon:(0,N.jsx)(b.Z,{}),size:V.size||"small"},V)):(0,N.jsx)(F.C,(0,M.Z)({src:"/api/public/preview/".concat(k.avatar),size:V.size||"small"},V))};ne.Z=_},78210:function(fe,ne,g){"use strict";var M=g(27856),U=g.n(M),F=g(15020),T=g(85893),b=function(E){var _=E.html,e=_===void 0?"":_,te=E.replaceP,k=te===void 0?!0:te;return k?(0,T.jsx)("div",{className:"pe-view",children:typeof e=="string"&&(0,F.ZP)(U().sanitize(e,{ADD_TAGS:["iframe"],ADD_ATTR:["allow","allowfullscreen","frameborder","scrolling"]}).replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"))}):(0,T.jsx)(T.Fragment,{children:typeof e=="string"&&(0,F.ZP)(U().sanitize(e))})};ne.Z=b},39017:function(fe,ne,g){"use strict";g.d(ne,{Rk:function(){return te}});var M=g(67294),U=g(24004);function F(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",V=useContext(SurveyContext),G=V.theme;return"survey-".concat(G)+k}function T(k,V){var G=(V&&V.depends||[]).reduce(function(L,K){return L||!K},!1);return b(G?void 0:function(L,K){return fetch(L,K).then(function(z){if(!!z.ok)return z.json()})},k,V||{})}function b(k){for(var V=arguments.length,G=new Array(V>1?V-1:0),L=1;L<V;L++)G[L-1]=arguments[L];var K=useState(0),z=_slicedToArray(K,2),se=z[0],Q=z[1],p=useCallback(function(){Q(Math.random())},[]),ue=useState({loading:!1,mutate:p}),me=_slicedToArray(ue,2),Ne=me[0],he=me[1];return useEffect(function(){!k||G[1].manual&&se===0||k.apply(null,G).then(function(ce){ce.code===200?he({loading:!1,data:ce.data,mutate:p}):he({error:ce.message,loading:!1,mutate:p})}).catch(function(ce){he({error:ce,loading:!1,mutate:p})})},N(se,G)),Ne}function N(){for(var k=arguments.length,V=new Array(k),G=0;G<k;G++)V[G]=arguments[G];for(var L=[],K=0;K<arguments.length;K++){var z=arguments[K];if(z instanceof Array)for(var se=0;se<z.length;se++)L=L.concat(N(z[se]));else if(typeof URL!="undefined"&&z instanceof URL)L=L.concat(z.toJSON());else if(z instanceof Object)for(var Q=Object.keys(z),p=0;p<Q.length;p++){var ue=Q[p];ue==="depends"?L=L.concat(z[ue]):L=L.concat([ue]).concat(N(z[ue]))}else L=L.concat(z)}return L}var E=g(87998);function _(){return useContext(SurveyContext)}function e(){return useSurvey().attachments}function te(){var k=(0,M.useContext)(E.ZX);return k.innerStore}},49914:function(fe,ne,g){"use strict";g.d(ne,{H:function(){return F}});var M=g(67294),U=g(87998);function F(){return(0,M.useContext)(U.ff)}}}]);
