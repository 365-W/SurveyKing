(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[250],{13277:function(){},75952:function(Y,M,e){"use strict";e.r(M),e.d(M,{default:function(){return G}});var m=e(80937),C=e(67294),Z=e(51615),f=e(11849),J=e(34792),N=e(48086),R=e(3182),W=e(69610),L=e(54941),K=e(94043),p=e.n(K),S=e(3980),g=e(54531),$=function(){function u(t){(0,W.Z)(this,u),this.id=void 0,this.resultId=void 0,this.query=void 0,this.queryErrorMsg=void 0,this.queryForm=void 0,this.queryResult=void 0,this.queryFormValue={},this.id=t.id,this.resultId=t.resultId,this.query=t.query,this.makeObservable()}return(0,L.Z)(u,[{key:"makeObservable",value:function(){(0,g.Ou)(this,{id:g.LO.ref,resultId:g.LO.ref,query:g.LO.ref,queryForm:g.LO.ref,queryResult:g.LO.ref,queryFormValue:g.LO.ref,queryErrorMsg:g.LO.ref,loadQuery:g.aD,getQueryResult:g.aD})}},{key:"loadQuery",value:function(){var t=(0,R.Z)(p().mark(function i(){var s;return p().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,S.hi.loadQuery({id:this.id,resultId:this.resultId});case 2:s=y.sent,s.success?this.queryForm=s.data.schema:this.queryErrorMsg=s.message;case 4:case"end":return y.stop()}},i,this)}));function d(){return t.apply(this,arguments)}return d}()},{key:"getQueryResult",value:function(){var t=(0,R.Z)(p().mark(function i(s){var v;return p().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,S.hi.getQueryResult({id:this.id,resultId:this.resultId,answer:s,query:this.query});case 2:v=l.sent,this.queryFormValue=s,v.code!==200?N.default.error(v.message):this.queryResult=v.data;case 5:case"end":return l.stop()}},i,this)}));function d(i){return t.apply(this,arguments)}return d}()},{key:"updateAnswer",value:function(){var t=(0,R.Z)(p().mark(function i(s,v){return p().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,S.hi.post("/api/public/saveAnswer",{id:v,queryId:this.resultId,answer:s,projectId:this.id});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},i,this)}));function d(i,s){return t.apply(this,arguments)}return d}()},{key:"upload",value:function(){var t=(0,R.Z)(p().mark(function i(s,v){return p().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",S.hi.upload("/api/public/upload",(0,f.Z)((0,f.Z)({},s),{},{fileType:4,basePath:this.id}),v));case 1:case"end":return l.stop()}},i,this)}));function d(i,s){return t.apply(this,arguments)}return d}()}]),u}(),V=C.createContext(new $({id:"123456",resultId:"123456"}));function B(){return(0,C.useContext)(V)}var U=e(19357),k=e(80893),r=e(85893),z=(0,m.Pi)(function(){var u=B(),t=u.queryForm,d=u.queryResult;return(0,C.useEffect)(function(){u.loadQuery()},[]),d?(0,r.jsx)(r.Fragment,{}):t?(0,r.jsx)("div",{className:"public-query",children:(0,r.jsx)("div",{className:"query-form",children:!d&&(0,r.jsx)(U.Z,{theme:"antdForm",schema:t,questionNumber:!1,onSubmit:function(s){u.getQueryResult(s)}})})}):(0,r.jsx)(k.gb,{})}),o=e(57663),a=e(71577),h=e(49111),n=e(19650),c=e(71153),F=e(60331),O=e(83279),j=e(18106),Q=e(51752),x=e(94184),b=e.n(x),T=e(87998),P=Q.Z.TabPane,D=(0,m.Pi)(function(){var u=B(),t=u.queryResult,d=u.queryFormValue,i=(0,C.useMemo)(function(){return(0,T.SB)()},[]);return(0,C.useEffect)(function(){},[]),t?(0,r.jsxs)("div",{className:b()("query-result",i?"mobile":"pc"),children:[(0,r.jsxs)("div",{className:"query-result-criteria",children:[(0,r.jsx)("h3",{children:"\u67E5\u8BE2\u6761\u4EF6"}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"12px 0"},children:[(0,r.jsxs)("div",{children:["\u67E5\u8BE2\u6761\u4EF6\uFF1A",(0,r.jsx)(n.Z,{children:Object.values(d).reduce(function(s,v){return s.push.apply(s,(0,O.Z)(Object.values(v))),s},[]).map(function(s){return(0,r.jsx)(F.Z,{color:"blue",children:s},s)})})]}),(0,r.jsx)(a.Z,{type:"primary",onClick:function(){u.queryResult=void 0},children:"\u91CD\u65B0\u67E5\u8BE2"})]})]}),(0,r.jsx)("div",{className:"query-result-container",children:(0,r.jsxs)("div",{className:"query-result-data",children:[(0,r.jsxs)("div",{className:"query-result-data-total",children:["\u67E5\u8BE2\u5230 ",t.answers.length," \u6761\u7B26\u5408\u6761\u4EF6\u7684\u6570\u636E"]}),(0,r.jsx)("div",{className:"query-result-data-content",children:(0,r.jsx)(Q.Z,{type:"card",children:t.answers.map(function(s){return(0,r.jsx)(P,{tab:s.createAt,children:(0,r.jsx)(U.Z,{theme:i?"antdMobile":"antd",schema:t==null?void 0:t.schema,initialValues:s.answer,headerVisible:!1,footerVisible:!!(t!=null&&t.schema.attribute),paginationVisible:!1,fieldPermission:t.fieldPermission,onUpload:function(y,l){return u.upload(y,l)},onSubmit:function(y){u.updateAnswer(y,s.answerId).then(function(l){l.success?N.default.success("\u7B54\u6848\u66F4\u65B0\u6210\u529F"):N.default.error(l.message)})}})},s.answerId)})})})]})})]}):(0,r.jsx)(r.Fragment,{})}),E=e(54781),A=(0,m.Pi)(function(){var u=B(),t=u.queryErrorMsg;return t?(0,r.jsx)("div",{className:"render-failure  phone",children:(0,r.jsxs)("div",{className:"content",children:[(0,r.jsx)("div",{children:(0,r.jsx)(E.AT,{})}),(0,r.jsx)("h2",{children:t})]})}):(0,r.jsx)(r.Fragment,{})}),G=(0,m.Pi)(function(){var t=(0,Z.UO)(),d=t.id,i=t.resultId,s=(0,Z.TH)(),v=(0,C.useMemo)(function(){return new $({id:d,resultId:i,query:s.query})},[d,i]);return(0,r.jsxs)(V.Provider,{value:v,children:[(0,r.jsx)(A,{}),(0,r.jsx)(z,{}),(0,r.jsx)(D,{})]})})},60331:function(Y,M,e){"use strict";e.d(M,{Z:function(){return z}});var m=e(96156),C=e(22122),Z=e(28481),f=e(67294),J=e(94184),N=e.n(J),R=e(98423),W=e(54549),L=e(53124),K=function(o,a){var h={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&a.indexOf(n)<0&&(h[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(o);c<n.length;c++)a.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(o,n[c])&&(h[n[c]]=o[n[c]]);return h},p=function(a){var h,n=a.prefixCls,c=a.className,F=a.checked,O=a.onChange,j=a.onClick,Q=K(a,["prefixCls","className","checked","onChange","onClick"]),x=f.useContext(L.E_),b=x.getPrefixCls,T=function(A){O==null||O(!F),j==null||j(A)},P=b("tag",n),D=N()(P,(h={},(0,m.Z)(h,"".concat(P,"-checkable"),!0),(0,m.Z)(h,"".concat(P,"-checkable-checked"),F),h),c);return f.createElement("span",(0,C.Z)({},Q,{className:D,onClick:T}))},S=p,g=e(98787),$=e(21790),V=function(o,a){var h={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&a.indexOf(n)<0&&(h[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(o);c<n.length;c++)a.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(o,n[c])&&(h[n[c]]=o[n[c]]);return h},B=new RegExp("^(".concat(g.Y.join("|"),")(-inverse)?$")),U=new RegExp("^(".concat(g.E.join("|"),")$")),k=function(a,h){var n,c=a.prefixCls,F=a.className,O=a.style,j=a.children,Q=a.icon,x=a.color,b=a.onClose,T=a.closeIcon,P=a.closable,D=P===void 0?!1:P,E=V(a,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),A=f.useContext(L.E_),G=A.getPrefixCls,u=A.direction,t=f.useState(!0),d=(0,Z.Z)(t,2),i=d[0],s=d[1];f.useEffect(function(){"visible"in E&&s(E.visible)},[E.visible]);var v=function(){return x?B.test(x)||U.test(x):!1},y=(0,C.Z)({backgroundColor:x&&!v()?x:void 0},O),l=v(),I=G("tag",c),ee=N()(I,(n={},(0,m.Z)(n,"".concat(I,"-").concat(x),l),(0,m.Z)(n,"".concat(I,"-has-color"),x&&!l),(0,m.Z)(n,"".concat(I,"-hidden"),!i),(0,m.Z)(n,"".concat(I,"-rtl"),u==="rtl"),n),F),X=function(H){H.stopPropagation(),b==null||b(H),!H.defaultPrevented&&("visible"in E||s(!1))},re=function(){return D?T?f.createElement("span",{className:"".concat(I,"-close-icon"),onClick:X},T):f.createElement(W.Z,{className:"".concat(I,"-close-icon"),onClick:X}):null},te="onClick"in E||j&&j.type==="a",se=(0,R.Z)(E,["visible"]),q=Q||null,ne=q?f.createElement(f.Fragment,null,q,f.createElement("span",null,j)):j,w=f.createElement("span",(0,C.Z)({},se,{ref:h,className:ee,style:y}),ne,re());return te?f.createElement($.Z,null,w):w},r=f.forwardRef(k);r.displayName="Tag",r.CheckableTag=S;var z=r},71153:function(Y,M,e){"use strict";var m=e(38663),C=e.n(m),Z=e(13277),f=e.n(Z)}}]);
