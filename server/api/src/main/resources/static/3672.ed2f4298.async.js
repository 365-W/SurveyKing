(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3672],{57254:function(p,C,n){"use strict";n.d(C,{Z:function(){return D}});var l=n(28991),m=n(67294),y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},v=y,E=n(27029),e=function(N,d){return m.createElement(E.Z,(0,l.Z)((0,l.Z)({},N),{},{ref:d,icon:v}))};e.displayName="DownOutlined";var D=m.forwardRef(e)},17707:function(p,C,n){"use strict";n.r(C),n.d(C,{default:function(){return Se}});var l=n(40807),m=n(78210),y=n(67294),v=n(54707),E=n(48187),e=n(85893);function D(i){var t=i.schema,u=i.index,s=i.seqNo,a=(0,v.AK)("-body-questionSet"),g=(0,y.useContext)(l.ZX),h=g.questionNumber;return(0,e.jsxs)("div",{className:a,children:[(0,e.jsxs)("div",{className:a+"-title",children:[h?s||"".concat(u+1,"."):"",(0,e.jsx)(m.Z,{html:t.title})]}),i.children,(0,e.jsx)("div",{className:a+"-splitLine"})]})}(0,E.eC)("QuestionSet",D,"antdForm");var T=n(9715),N=n(86835),d=n(94657),B=n(80937),S=n(67635),L=function(){var t=(0,v.AK)(),u=(0,y.useContext)(l.ZX),s=u.schema;return(0,e.jsxs)("div",{className:t+"-header",children:[(0,e.jsx)("div",{className:t+"-header-title",children:(0,e.jsx)(S.hl,{html:s.title})}),(0,e.jsx)("div",{className:t+"-header-description",children:(0,e.jsx)(S.hl,{html:s.description})})]})},P=function(t){var u=(0,v.AK)();return(0,e.jsx)("div",{className:u+"-body",children:t.children})},b=n(57663),I=n(71577),O=(0,B.Pi)(function(){var i,t,u=(0,v.AK)("-footer"),s=(0,y.useContext)(l.ZX),a=s.schema,g=s.loading,h=(0,v.Rk)(),f=h.pagination,r=f.pageSize>1,o=f.current===1,c=f.current===f.pageSize;return(0,e.jsxs)("div",{className:u,children:[c&&(0,e.jsx)("div",{className:u+"-desc",style:{userSelect:"none"},children:(0,e.jsx)(S.hl,{html:a==null||(i=a.attribute)===null||i===void 0?void 0:i.suffix})}),(0,e.jsxs)("div",{className:u+"-pagination",children:[r&&!o&&(0,e.jsx)("div",{children:(0,e.jsx)(I.Z,{type:"primary",block:!0,onClick:function(){return h.handlePrev()},children:"\u4E0A\u4E00\u9875"})}),r&&!c&&(0,e.jsx)("div",{children:(0,e.jsx)(I.Z,{type:"primary",block:!0,onClick:function(){return h.handleNext()},children:"\u4E0B\u4E00\u9875"})}),c&&(0,e.jsx)("div",{children:(0,e.jsx)(I.Z,{type:"primary",block:!0,onClick:function(){return h.submit()},loading:g,children:(0,e.jsx)(S.hl,{html:((t=a.attribute)===null||t===void 0?void 0:t.submitButton)||"\u63D0\u4EA4"})})}),r&&(0,e.jsxs)("div",{className:u+"-pagination-info",children:["\u7B2C",f.current,"\u9875/\u5171",f.pageSize,"\u9875"]})]})]})}),Q=n(47673),F=n(4107),z=n(39002),H=n(68351),te=n(14965),V=n(68318),X=n(77883),K=n(85482),k=n(29985),G=n(46842),J=n(64302),U=n(27484),j=n.n(U),M=n(33852);j().locale("zh-cn");var R="YYYY-MM-DD",Y="YYYY-MM-DD HH:mm:ss",le="HH:mm:ss";function w(i,t){if(!!i){if(t==="date")return j()(i,R);if(t==="dateTime")return j()(i,Y);if(t==="time")return j()(i,le)}}var de=function(t){var u=t.onChange,s=t.type,a=t.value,g=t.suffix,h=t.style,f=h===void 0?{width:"100%"}:h;return s==="number"?(0,e.jsx)(K.Z,{onChange:u,value:a,style:f,addonAfter:g}):s==="date"?(0,e.jsx)(V.Z,{onChange:function(o,c){u(c)},value:w(a,s),style:f}):s==="dateTime"?(0,e.jsx)(V.Z,{showTime:!0,onChange:function(o,c){return u(c)},value:w(a,s),style:f}):s==="time"?(0,e.jsx)(H.Z,{value:w(a,s),onChange:function(o,c){return u(c)},style:f}):s==="mobile"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(k.Z,{}),onChange:function(o){return u(o.target.value)},value:a}):s==="idCard"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(G.Z,{}),onChange:function(o){return u(o.target.value)},value:a,style:f}):s==="email"?(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(J.Z,{}),onChange:function(o){return u(o.target.value)},value:a,style:f}):(0,e.jsx)(F.Z,{onChange:function(o){return u(o.target.value)},value:a,suffix:g,style:f})},De=n(49111),Ie=function(t){var u=t.onChange,s=useRef(null),a=useRef(),g=useRef(),h=useState(0),f=_slicedToArray(h,2),r=f[0],o=f[1];return useEffect(function(){var c=s.current;if(c){var x,Z=new SignaturePad(s.current);Z.addEventListener("beginStroke",function(){o(1)}),a.current=Z;var A=Math.max(window.devicePixelRatio||1,1);c.width=c.offsetWidth*A,c.height=c.offsetHeight*A,(x=c.getContext("2d"))===null||x===void 0||x.scale(A,A)}},[]),_jsxs("div",{className:"signature-pad",children:[_jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#aaa",visibility:g.current?"hidden":"visible"},children:"\u70B9\u51FB\u7B7E\u540D"}),_jsxs("div",{className:"signature",children:[_jsx("canvas",{ref:s,style:{width:"100%",height:"100%",touchAction:"none",userSelect:"none",display:r!==2?"block":"none"}}),r===2&&_jsx("img",{src:g.current||void 0})]}),_jsxs("div",{className:"save-signature",children:[_jsx("span",{children:"\u7B7E\u540D\u5B8C\u6210\u540E\uFF0C\u8BF7\u70B9\u51FB\u3010\u5B8C\u6210\u3011\u6309\u94AE"}),_jsx("div",{children:_jsxs(_Space,{children:[r===1&&_jsx(_Button,{type:"link",onClick:function(){var x;(x=a.current)===null||x===void 0||x.clear(),o(0)},children:"\u6E05\u7A7A"}),(r===0||r===1)&&_jsx(_Button,{type:"primary",disabled:r!==1,ghost:!0,size:"small",onClick:function(){var x;u(a.current.toDataURL()),g.current=(x=a.current)===null||x===void 0?void 0:x.toDataURL(),o(2)},children:"\u5B8C\u6210"}),r===2&&_jsx(_Button,{type:"primary",ghost:!0,size:"small",onClick:function(){var x;o(0),(x=a.current)===null||x===void 0||x.clear()},children:"\u91CD\u7B7E"})]})})]})]})},ce=n(3024),ve=(0,B.Pi)(function(){var i=(0,y.useContext)(l.ZX),t=i.progressBar,u=(0,v.AK)(),s=(0,v.Rk)(),a=s.progress;return t?(0,e.jsx)(ce.Z,{enabled:!0,top:0,innerActiveClass:"fixed",children:(0,e.jsx)("div",{className:u+"-progress",children:(0,e.jsx)("div",{className:"progress-bar s-prog-wait",children:(0,e.jsx)("div",{className:"progress-done  s-prog-done",style:{width:"".concat(a*100,"%")}})})})}):(0,e.jsx)(e.Fragment,{})}),Ze=function(t){var u,s=t.optionId,a=t.questionId,g=t.checked,h=t.checkedCount,f=useSurvey(),r=f.statistics,o=r==null?void 0:r.questionStatistics[a],c=((o==null?void 0:o.optionStatistics.reduce(function(A,W){return A+W.count},0))||0)+h,x=(o==null||(u=o.optionStatistics.find(function(A){return A.optionId===s}))===null||u===void 0?void 0:u.count)||0;x=g?x+1:x;var Z="".concat(Math.floor(x/c*1e3)/10,"%");return h===0?_jsx(_Fragment,{}):_jsxs("span",{className:"vote-info",children:[_jsxs("span",{className:"vote-info-cnt ",children:[x,"\u7968"]}),_jsx("span",{className:"vote-info-percent ",children:Z}),_jsx("div",{className:"vote-info-bar",children:_jsx("div",{className:"vote-info-bar-fill",style:{width:Z}})})]})},fe=function(t){var u=t.schema,s=t.type,a=u.attribute,g=a===void 0?{}:a,h=g.examCorrectAnswer,f=(0,v.Al)(),r=f.correctAnswerVisible,o=f.mode;return h&&r&&o==="exam"?s==="FillBlank"||s==="HorzBlank"||s==="MultipleBlank"?(0,e.jsx)("span",{className:"correct-answer",children:h}):(0,e.jsx)("span",{className:"correct-answer",children:"\uFF08\u6B63\u786E\u7B54\u6848\uFF09"}):(0,e.jsx)(e.Fragment,{})},me=function(t){var u=t.schema,s=u.attribute,a=s===void 0?{}:s,g=a.examScore,h=(0,v.Al)(),f=h.mode,r=h.examScoreVisible;return g&&f==="exam"&&r?(0,e.jsxs)("span",{className:"question-score",children:["\uFF08",g,"\u5206\uFF09"]}):(0,e.jsx)(e.Fragment,{})};function he(i){var t=i.schema,u=i.index,s=i.qsIndex,a=i.required,g=i.error,h=i.replaceTitle,f=i.seqNo,r=(0,y.useContext)(l.ZX),o=r.questionNumber,c=(0,v.AK)("-body-question"),x=(0,y.useState)(),Z=(0,d.Z)(x,2),A=Z[0],W=Z[1],ie=(0,v.Rk)();(0,y.useEffect)(function(){if(A){var $,_;($=document.querySelector("[data-id='".concat(t.id,"']")))===null||$===void 0||$.classList.remove("ant-form-item-has-error"),(_=document.querySelector("[data-id='".concat(t.id,"']")))===null||_===void 0||_.querySelectorAll("[data-id]").forEach(function(be){be.classList.remove("ant-form-item-has-error")})}if(g.length>0){var ee,Be=g[0].split("^"),se=(0,d.Z)(Be,2),oe=se[0],ue=se[1],ne;ue?(ne=document.querySelector("[data-id='".concat(oe,"']")),W(ue)):(ne=document.querySelector("[data-id='".concat(t.id,"']")),W(oe)),(ee=ne)===null||ee===void 0||ee.classList.add("ant-form-item-has-error")}else A&&W(void 0)},[g]);var q="";s!==void 0&&(q+=s+1+"-"),u!==void 0&&(q+=u+1+".");var Ae=function(){return A?(0,e.jsx)("span",{className:"question-tag error animated",children:(0,e.jsx)("span",{children:A})}):(0,e.jsx)(e.Fragment,{})};return(0,e.jsx)("div",{className:c,children:(0,e.jsx)(N.Z.Item,{label:(0,e.jsxs)("span",{className:c+"-header",children:[o?f||q:"",(0,e.jsx)(S.hl,{html:h||t.title}),(0,e.jsx)(me,{schema:t}),Ae()]}),labelCol:{span:24},wrapperCol:{span:24},required:a,children:i.children})})}(0,E.eC)("Question",(0,B.Pi)(he),"antdForm");var Fe=n(84305),xe=n(88182),ge=n(82925),je=n(94184),ye=n.n(je);j().locale("zh-cn");function Ce(i){var t=i.headerVisible,u=i.footerVisible,s=i.schema,a=(0,v.AK)(),g=(0,v.Al)(),h=function(){var r,o=(r=s.attribute)===null||r===void 0?void 0:r.headerImage;if(o)return(0,e.jsx)("img",{src:"/api/public/preview/".concat(o),style:{maxWidth:"100%"}})};return(0,e.jsxs)("div",{className:ye()(a,{preview:g.isPreview}),children:[(0,e.jsx)(ve,{}),(0,e.jsx)("div",{className:a+"-banner",children:h()}),t&&(0,e.jsx)(L,{}),(0,e.jsx)(xe.ZP,{locale:ge.Z,children:(0,e.jsx)(P,{children:i.children})}),u&&(0,e.jsx)(O,{})]})}(0,E.eC)("Survey",Ce,"antdForm");var Te=n(13062),pe=n(71230),Me=n(89032),re=n(15746),Ee=n(11849);function ae(i){var t=i.schema,u=i.onChange,s=i.value,a=s===void 0?{}:s,g=t.children,h=(0,v.AK)("-body-question");function f(r,o){a[r]=o,o===""&&delete a[r],u((0,Ee.Z)({},a))}return(0,e.jsx)("div",{children:g==null?void 0:g.map(function(r){var o=r.id,c=r.attribute,x=r.title,Z=c==null?void 0:c.suffix,A=c==null?void 0:c.dataType;return(0,e.jsxs)(pe.Z,{style:{marginBottom:10},"data-id":o,children:[x&&(0,e.jsx)(re.Z,{className:h+"-option",span:4,children:r.title&&(0,e.jsx)("span",{className:h+"-option-title",children:(0,e.jsx)(S.hl,{html:r.title})})},r.id),(0,e.jsxs)(re.Z,{span:24,children:[(0,e.jsx)(de,{type:A,value:a[o],onChange:function(ie){return f(o,ie)},suffix:Z&&(0,e.jsx)("span",{className:h+"-option-suffix",children:(0,e.jsx)(S.hl,{html:Z})})}),(0,e.jsx)(fe,{schema:r,type:t.type})]})]},o)})})}(0,E.RM)("FillBlank",ae,"antdForm"),(0,E.RM)("MultipleBlank",ae,"antdForm");var Ne=function(t){return(0,e.jsx)(e.Fragment,{children:t.children})},Se=Ne},78210:function(p,C,n){"use strict";var l=n(15020),m=n(85893),y=function(E){var e=E.html,D=e===void 0?"":e,T=E.replaceP,N=T===void 0?!0:T;return N?(0,m.jsx)(m.Fragment,{children:typeof D=="string"&&(0,l.ZP)(D.replace(/<p>/,"<span>").replace(/<\/p>/,"</span>"))}):(0,m.jsx)(m.Fragment,{children:typeof D=="string"&&(0,l.ZP)(D)})};C.Z=y},15746:function(p,C,n){"use strict";var l=n(21584);C.Z=l.Z},89032:function(p,C,n){"use strict";var l=n(38663),m=n.n(l),y=n(6999)},71230:function(p,C,n){"use strict";var l=n(92820);C.Z=l.Z},13062:function(p,C,n){"use strict";var l=n(38663),m=n.n(l),y=n(6999)},27561:function(p,C,n){var l=n(67990),m=/^\s+/;function y(v){return v&&v.slice(0,l(v)+1).replace(m,"")}p.exports=y},67990:function(p){var C=/\s/;function n(l){for(var m=l.length;m--&&C.test(l.charAt(m)););return m}p.exports=n},23279:function(p,C,n){var l=n(13218),m=n(7771),y=n(14841),v="Expected a function",E=Math.max,e=Math.min;function D(T,N,d){var B,S,L,P,b,I,O=0,Q=!1,F=!1,z=!0;if(typeof T!="function")throw new TypeError(v);N=y(N)||0,l(d)&&(Q=!!d.leading,F="maxWait"in d,L=F?E(y(d.maxWait)||0,N):L,z="trailing"in d?!!d.trailing:z);function H(j){var M=B,R=S;return B=S=void 0,O=j,P=T.apply(R,M),P}function te(j){return O=j,b=setTimeout(K,N),Q?H(j):P}function V(j){var M=j-I,R=j-O,Y=N-M;return F?e(Y,L-R):Y}function X(j){var M=j-I,R=j-O;return I===void 0||M>=N||M<0||F&&R>=L}function K(){var j=m();if(X(j))return k(j);b=setTimeout(K,V(j))}function k(j){return b=void 0,z&&B?H(j):(B=S=void 0,P)}function G(){b!==void 0&&clearTimeout(b),O=0,B=I=S=b=void 0}function J(){return b===void 0?P:k(m())}function U(){var j=m(),M=X(j);if(B=arguments,S=this,I=j,M){if(b===void 0)return te(I);if(F)return clearTimeout(b),b=setTimeout(K,N),H(I)}return b===void 0&&(b=setTimeout(K,N)),P}return U.cancel=G,U.flush=J,U}p.exports=D},33448:function(p,C,n){var l=n(44239),m=n(37005),y="[object Symbol]";function v(E){return typeof E=="symbol"||m(E)&&l(E)==y}p.exports=v},7771:function(p,C,n){var l=n(55639),m=function(){return l.Date.now()};p.exports=m},14841:function(p,C,n){var l=n(27561),m=n(13218),y=n(33448),v=0/0,E=/^[-+]0x[0-9a-f]+$/i,e=/^0b[01]+$/i,D=/^0o[0-7]+$/i,T=parseInt;function N(d){if(typeof d=="number")return d;if(y(d))return v;if(m(d)){var B=typeof d.valueOf=="function"?d.valueOf():d;d=m(B)?B+"":B}if(typeof d!="string")return d===0?d:+d;d=l(d);var S=e.test(d);return S||D.test(d)?T(d.slice(2),S?2:8):E.test(d)?v:+d}p.exports=N}}]);
