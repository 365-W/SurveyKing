(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[650],{71605:function(Ct,U,t){"use strict";t.r(U),t.d(U,{Data:function(){return W},default:function(){return ft}});var i=t(67294),pt=t(60674),C=t(18111),M=t(11849),Z=t(94657),_=t(5527),B=t(80937),k=t(11628),G=t(21063),ee=t(1013),te=t.n(ee),yt=t(71194),P=t(50146),gt=t(57663),S=t(71577),H=t(68068),e=t(85893),ne=(0,B.Pi)(function(u){var n=u.onCancel,s=(0,i.useContext)(C.xi),a=s.dataStore,r=(0,k.IE)(),d=r.schema,c=(0,i.useRef)(null),v=(0,i.useRef)(null),f=(0,i.useRef)(new Date().getTime()),x=(0,i.useState)(!1),m=(0,Z.Z)(x,2),l=m[0],o=m[1],y=function(){return d?(0,e.jsx)(H.O,{ref:v,schema:d,headerVisible:!1,paginationVisible:!1,footerVisible:!1,onUpload:a.upload}):(0,e.jsx)(e.Fragment,{})},A=function(p){var E;o(!0),(E=v.current)===null||E===void 0||E.submit().then(function(F){F?a.saveData({answer:F.values,attachment:F.attachments,metaInfo:{answerInfo:{startTime:f.current,endTime:new Date().getTime()}}}).then(function(){f.current=new Date().getTime(),o(!1),a.loadData(),p&&p()}):o(!1)})};return(0,e.jsx)("div",{ref:c,className:"add-data",children:(0,e.jsx)(P.Z,{visible:!0,maskClosable:!1,getContainer:function(){return c.current},title:"\u6DFB\u52A0\u6570\u636E",width:600,onCancel:n,footer:(0,e.jsxs)("div",{className:"footer",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(S.Z,{type:"primary",loading:l,onClick:function(){return A(n)},children:"\u63D0\u4EA4"}),(0,e.jsx)(S.Z,{onClick:function(){n()},children:"\u53D6\u6D88"})]}),(0,e.jsx)("div",{children:(0,e.jsx)(S.Z,{loading:l,type:"link",onClick:function(){A(function(){var p;return(p=v.current)===null||p===void 0?void 0:p.reset()})},children:"\u63D0\u4EA4\u5E76\u518D\u586B\u4E00\u4EFD"})})]}),children:(0,e.jsx)("div",{style:{maxHeight:300,overflowY:"auto"},children:y()})})})}),ae=(0,B.Pi)(function(){var u=(0,i.useState)(!1),n=(0,Z.Z)(u,2),s=n[0],a=n[1];return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){return a(!0)},children:[(0,e.jsx)(te(),{size:18,style:{cursor:"pointer"}}),"\u6DFB\u52A0\u6570\u636E"]}),s&&(0,e.jsx)(ne,{onCancel:function(){return a(!1)}})]})}),se=t(93756),re=t.n(se),le=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore;return(0,e.jsx)("div",{className:"toolbar-item",style:{width:45,borderRight:"1px solid #c5c5c5"},children:(0,e.jsx)("a",{onClick:function(){n.loadData()},children:(0,e.jsx)(re(),{size:18,style:{cursor:"pointer"}})})})}),Ft=t(34792),O=t(48086),ie=t(57119),ue=t(73171),oe=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore,s=n.selected,a=(0,i.useRef)(null),r=function(){(s==null?void 0:s.length)===0?O.default.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u533A\u57DF"):P.Z.confirm({title:"\u5220\u9664\u6570\u636E",getContainer:a.current,icon:(0,e.jsx)(ie.Z,{}),content:(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"delete-content",children:["\u786E\u5B9A\u8981\u5220\u9664\u8FD9 ",(0,e.jsx)("span",{children:s==null?void 0:s.length}),"\u6761\u6570\u636E\u5417\uFF1F"]}),(0,e.jsx)("div",{className:"delete-description",children:"\u63D0\u793A\uFF1A\u5220\u9664\u7684\u6570\u636E\u53EF\u4EE5\u5728\u56DE\u6536\u7AD9\u91CC\u9762\u627E\u56DE"})]}),okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){n.deleteData()},onCancel:function(){}})};return(0,e.jsx)("div",{className:"toolbar-item",ref:a,children:(0,e.jsxs)("a",{onClick:r,children:[(0,e.jsx)(ue.Z,{size:18,style:{cursor:"pointer"}}),"\u5220\u9664\u6570\u636E"]})})}),Zt=t(88983),N=t(66253),Dt=t(22385),Q=t(94199),St=t(9715),b=t(86835),ce=t(90631),V=t(1870),de=t(1997),ve=function(n){var s=n.value,a=n.onChange,r=(0,k.IE)(),d=(0,i.useState)(!1),c=(0,Z.Z)(d,2),v=c[0],f=c[1],x=r.schema;return(0,e.jsxs)("div",{children:[(0,e.jsx)(S.Z,{type:"link",onClick:function(){return f(!0)},children:"\u70B9\u51FB\u9009\u62E9"}),x&&(0,e.jsx)(de.ZP,{visible:v,helpLink:(0,e.jsx)(S.Z,{type:"link",onClick:function(){return window.open("https://surveyking.cn/docs/guides/data/export")},children:"\u5982\u4F55\u81EA\u5B9A\u4E49\u5BFC\u51FA"}),value:s,fieldTypes:["FillBlank","MultipleBlank","Textarea","Select"],title:"\u5BFC\u51FA\u9644\u4EF6\u547D\u540D\u89C4\u5219\u8BBE\u7F6E",schema:r.schema,onCancel:function(){return f(!1)},helperVariables:[{id:"sourceName",path:"sourceName",title:"\u539F\u59CB\u6587\u4EF6\u540D",type:"FillBlank",tooltip:"hello"},{id:"serialNum",path:"serialNum",title:"\u8FDE\u7EED\u5E8F\u53F7",type:"FillBlank",tooltip:"\u4ECE1\u5F00\u59CB\u7684\u5E8F\u53F7"},{id:"serialNumInAnswer",path:"serialNumInAnswer",title:"\u540C\u4E00\u95EE\u5377\u5185\u8FDE\u7EED\u5E8F\u53F7",type:"FillBlank",tooltip:"\u4ECE1\u5F00\u59CB\u7684\u5E8F\u53F7"},{id:"uploadDateTime",path:"uploadDateTime",title:"\u9644\u4EF6\u4E0A\u4F20\u65E5\u671F\u65F6\u95F4",type:"FillBlank",tooltip:"hello"},{id:"uploadDate",path:"uploadDate",title:"\u9644\u4EF6\u4E0A\u4F20\u65E5\u671F",type:"FillBlank",tooltip:"hello"}],functionVisible:!1,onOk:function(l){f(!1),a&&a(l)}})]})},fe={labelCol:{span:6},wrapperCol:{span:18}},he=function(){var n=b.Z.useForm(),s=(0,Z.Z)(n,1),a=s[0],r=(0,i.useContext)(C.xi),d=r.dataStore,c=(0,i.useState)(!1),v=(0,Z.Z)(c,2),f=v[0],x=v[1],m=(0,i.useState)("answer"),l=(0,Z.Z)(m,2),o=l[0],y=l[1],A=(0,i.useState)("source"),h=(0,Z.Z)(A,2),p=h[0],E=h[1],F=function(I){var w=I.exportMode;d.download({type:o,nameExp:I.nameExp,exportMode:w})};return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsx)("a",{title:"Download result",onClick:function(){return x(!0)},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(ce.Z,{}),"\u5BFC\u51FA\u6570\u636E"]})}),(0,e.jsx)(P.Z,{title:(0,e.jsxs)("span",{children:["\u5BFC\u51FA\u6570\u636E",(0,e.jsx)(Q.Z,{title:(0,e.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return window.open("https://surveyking.cn/docs/guides/custom_export")},children:"\u67E5\u770B\u6587\u6863"}),children:(0,e.jsx)(V.Z,{style:{marginLeft:10}})})]}),visible:f,onCancel:function(){return x(!1)},okText:"\u5BFC\u51FA",onOk:function(){F(a.getFieldsValue())},children:(0,e.jsxs)(b.Z,(0,M.Z)((0,M.Z)({name:"validate_other"},fe),{},{initialValues:{type:"answer",dataType:"excel",atttachNameType:"source",exportMode:"all"},form:a,children:[(0,e.jsx)(b.Z.Item,{name:"type",label:"\u5BFC\u51FA\u5185\u5BB9",children:(0,e.jsxs)(N.ZP.Group,{onChange:function(I){y(I.target.value)},children:[(0,e.jsx)(N.ZP,{value:"answer",children:"\u6570\u636E\u8BE6\u60C5\u8868"}),(0,e.jsx)(N.ZP,{value:"attachment",children:"\u7B54\u6848\u9644\u4EF6"}),(0,e.jsx)(N.ZP,{value:"answerAttachment",children:"\u6570\u636E+\u9644\u4EF6"})]})}),o==="answer"&&(0,e.jsx)(b.Z.Item,{name:"dataType",label:"\u5BFC\u51FA\u683C\u5F0F",children:(0,e.jsx)(N.ZP.Group,{children:(0,e.jsx)(N.ZP,{value:"excel",children:"Excel(.xlsx)"})})}),(o==="attachment"||o==="answerAttachment")&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Z.Item,{name:"atttachNameType",label:"\u9644\u4EF6\u547D\u540D",children:(0,e.jsxs)(N.ZP.Group,{onChange:function(I){return E(I.target.value)},children:[(0,e.jsx)(N.ZP,{value:"source",children:"\u539F\u59CB\u6587\u4EF6\u540D"}),(0,e.jsx)(N.ZP,{value:"byField",children:"\u901A\u8FC7\u586B\u5199\u7684\u5185\u5BB9\u547D\u540D"})]})}),p==="byField"&&(0,e.jsx)(b.Z.Item,{name:"nameExp",label:"\u5173\u8054\u5B57\u6BB5",children:(0,e.jsx)(ve,{})})]}),(0,e.jsx)(b.Z.Item,{name:"exportMode",label:"\u5BFC\u51FA\u6A21\u5F0F",children:(0,e.jsxs)(N.ZP.Group,{children:[(0,e.jsx)(N.ZP,{value:"all",children:"\u5168\u91CF\u5BFC\u51FA"}),(0,e.jsx)(N.ZP,{value:"current",children:"\u5BFC\u51FA\u5F53\u524D\u9875"}),(0,e.jsx)(N.ZP,{value:"selected",children:"\u5BFC\u51FA\u9009\u4E2D"})]})})]}))})]})},xe=t(14098),me=t.n(xe),Et=t(57338),je=t(25084),It=t(62350),Ce=t(75443),Bt=t(13062),T=t(71230),Nt=t(89032),j=t(15746),pe=t(58491),ye=t(57254),ge=t(27400),K=t(24843),Fe=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore,s=(0,k.IE)(),a=s.schema,r=(0,ge.a)(),d=r.isMobile,c=(0,i.useRef)(null),v=(0,i.useRef)(null),f=(0,K.A)("-edit"),x=n.currentIndex,m=n.records.length||0,l=n.records[x],o=l.metaInfo,y=(0,i.useState)(!0),A=(0,Z.Z)(y,2),h=A[0],p=A[1],E=(0,i.useState)(!1),F=(0,Z.Z)(E,2),g=F[0],I=F[1],w=(0,i.useState)(!1),Y=(0,Z.Z)(w,2),ht=Y[0],J=Y[1];(0,i.useEffect)(function(){var D,R=l.answer,z=l.attachment;(D=v.current)===null||D===void 0||D.setValues(R,z)},[l]),(0,i.useEffect)(function(){var D;(D=v.current)===null||D===void 0||D.toggleReadOnly(h)},[h]);var xt=function(){n.currentIndex=-1},mt=function(){return a?(0,e.jsx)(H.O,{ref:v,schema:a,headerVisible:!1,footerVisible:!1,paginationVisible:!1,readOnly:h,onUpload:n.upload}):(0,e.jsx)(e.Fragment,{})},X=function(R){R==="up"?n.currentIndex=n.currentIndex-1:n.currentIndex=n.currentIndex+1},q=function(){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u5E8F\u53F7:"}),(0,e.jsx)(j.Z,{span:16,children:x+1})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u63D0\u4EA4\u4EBA:"}),(0,e.jsx)(j.Z,{span:16,children:"\u65E0"})]}),o&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u7B54\u5377\u65F6\u957F:"}),(0,e.jsx)(j.Z,{span:16,children:(0,C.gh)(o.answerInfo.endTime-o.answerInfo.startTime)})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u63D0\u4EA4\u65F6\u95F4:"}),(0,e.jsx)(j.Z,{span:16,children:l.createAt})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u4FEE\u6539\u65F6\u95F4:"}),(0,e.jsx)(j.Z,{span:16,children:l.updateAt||"-"})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u586B\u5199\u8BBE\u5907:"}),(0,e.jsx)(j.Z,{span:16,children:o.clientInfo.deviceType})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u64CD\u4F5C\u7CFB\u7EDF:"}),(0,e.jsx)(j.Z,{span:16,children:o.clientInfo.platform})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"\u6D4F\u89C8\u5668:"}),(0,e.jsx)(j.Z,{span:16,children:o.clientInfo.browser})]}),(0,e.jsxs)(T.Z,{children:[(0,e.jsx)(j.Z,{span:8,children:"IP:"}),(0,e.jsx)(j.Z,{span:16,children:o.clientInfo.remoteIp})]})]})]})},jt=function(){return h?(0,e.jsxs)("div",{children:[(0,e.jsx)(S.Z,{type:"primary",onClick:function(){return p(!1)},children:"\u4FEE\u6539"}),(0,e.jsx)(S.Z,{type:"primary",danger:!0,style:{marginLeft:5},children:(0,e.jsx)(Ce.Z,{title:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u6570\u636E\u5417\uFF1F",icon:(0,e.jsx)(V.Z,{style:{color:"red"}}),okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onConfirm:function(){n.deleteData(x).then(function(){return xt()})},children:(0,e.jsx)("a",{href:"#",children:"\u5220\u9664"})})}),(0,e.jsx)(S.Z,{type:"link",style:{marginLeft:5},onClick:function(){return J(!0)},children:(0,e.jsx)("a",{href:"#",children:"\u8BE6\u60C5"})}),(0,e.jsx)(je.Z,{placement:"right",autoFocus:!1,visible:ht,onClose:function(){return J(!1)},children:q()})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)(S.Z,{type:"primary",loading:g,onClick:function(){var z;I(!0),(z=v.current)===null||z===void 0||z.submit().then(function($){$?n.updateData({answer:$.values,attachment:$.attachments,id:l.id,projectId:l.projectId}).then(function(){I(!1),p(!0)}):I(!1)})},children:"\u63D0\u4EA4"}),(0,e.jsx)(S.Z,{style:{marginLeft:10},onClick:function(){return p(!0)},children:"\u53D6\u6D88"})]})};return(0,e.jsx)("div",{ref:c,className:"edit-data ".concat(f),children:(0,e.jsx)(P.Z,{visible:x>=0,maskClosable:!1,getContainer:function(){return c.current},title:!1,width:800,onCancel:function(){return n.currentIndex=-1},footer:!1,children:(0,e.jsxs)(T.Z,{gutter:16,children:[(0,e.jsxs)(j.Z,{xs:24,sm:16,className:f+"-survey-container",children:[(0,e.jsx)("div",{className:f+"-survey-container-title",children:"\u6570\u636E\u8BE6\u60C5"}),(0,e.jsx)("div",{className:f+"-survey-container-content",children:mt()}),(0,e.jsxs)("div",{className:f+"-survey-container-footer",children:[jt(),(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[x+1,"/",m]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(S.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(pe.Z,{}),disabled:x===0,onClick:function(){return X("up")}}),(0,e.jsx)(S.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(ye.Z,{}),disabled:x===m-1,onClick:function(){return X("down")}})]})]})]})]}),!d&&(0,e.jsxs)(j.Z,{span:8,className:f+"-metaInfo-container",children:[(0,e.jsx)("div",{className:f+"-metaInfo-container-title",children:"\u57FA\u672C\u4FE1\u606F"}),(0,e.jsx)("div",{className:f+"-metaInfo-container-content",children:q()}),(0,e.jsx)("div",{className:f+"-metaInfo-container-footer"})]})]})})})}),Ze=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore,s=n.selected;return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsxs)("a",{onClick:function(){s&&s.length>0?n.currentIndex=s[0]:O.default.error("\u8BF7\u70B9\u51FB\u8981\u7F16\u8F91\u7684\u884C")},children:[(0,e.jsx)(me(),{size:14,style:{cursor:"pointer"}}),"\u7F16\u8F91\u6570\u636E"]}),n.currentIndex!==-1&&(0,e.jsx)(Fe,{})]})}),De=t(25769),Se=t.n(De),At=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore;return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:"Download result",onClick:function(){n.downloadSurveyAttachment()},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Se(),{size:18,style:{cursor:"pointer"}}),"\u5BFC\u51FA\u9644\u4EF6"]})})})}),Ee=t(72850),Tt=t(49111),Ie=t(19650),Be=function(n){var s=n.onClose,a=(0,i.useContext)(C.xi),r=a.dataStore,d=(0,k.IE)(),c=d.schema,v=r.deletedRecords||[],f=r.recycleSelected,x=d.mode;(0,i.useEffect)(function(){r.loadDeletedData()},[]);var m=(0,i.useMemo)(function(){var l=(0,C.ZZ)(c);return l.length==0?l.push({name:"\u6682\u65E0\u6570\u636E!"}):(x==="exam"&&l.push({name:"examScore",title:"\u5206\u6570",width:100}),l.push({name:"startTime",title:"\u5F00\u59CB\u65F6\u95F4",width:180}),l.push({name:"endTime",title:"\u63D0\u4EA4\u65F6\u95F4",width:180}),l.push({name:"totalTime",title:"\u7B54\u9898\u65F6\u957F"}),l.push({name:"createByName",title:"\u63D0\u4EA4\u4EBA",width:180}),l.push({name:"remoteIp",title:"IP\u5730\u5740"}),l.push({name:"browserType",title:"\u6D4F\u89C8\u5668"}),l.push({name:"deviceType",title:"\u8BBE\u5907\u7C7B\u578B"}),l.push({name:"platform",title:"\u5E73\u53F0\u7C7B\u578B"})),l},[c]);return(0,e.jsx)(P.Z,{visible:!0,onCancel:s,width:750,bodyStyle:{padding:0},closable:!1,footer:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("span",{style:{float:"left"},children:["\u5DF2\u9009\u4E2D ",f==null?void 0:f.length," \u6761"]}),(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)(S.Z,{onClick:s,children:"\u53D6\u6D88"}),(0,e.jsx)(S.Z,{type:"primary",danger:!0,onClick:function(){var o;if(((o=r.recycleSelected)===null||o===void 0?void 0:o.length)===0){O.default.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E");return}P.Z.confirm({title:"\u5F7B\u5E95\u5220\u9664",content:"\u5F7B\u5E95\u5220\u9664\u4E4B\u540E\uFF0C\u8BE5\u6570\u636E\u5C31\u627E\u4E0D\u56DE\u6765\u4E86\uFF0C\u4ECD\u7136\u786E\u5B9A\u8FD9\u6837\u505A\u5417?",okText:"\u786E\u5B9A",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){r.physicalDeleteData()}})},children:"\u5F7B\u5E95\u5220\u9664"}),(0,e.jsx)(S.Z,{type:"primary",onClick:function(){var o;if(((o=r.recycleSelected)===null||o===void 0?void 0:o.length)===0){O.default.info("\u8BF7\u9009\u62E9\u8981\u6062\u590D\u7684\u6570\u636E");return}P.Z.confirm({title:"\u6062\u590D\u6570\u636E",content:"\u786E\u8BA4\u5C06\u9009\u4E2D\u7684\u6570\u636E\u4ECE\u56DE\u6536\u7AD9\u6062\u590D\u5417?",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){r.restoreData()}})},children:"\u6062\u590D"})]})]}),children:(0,e.jsx)(G._$,{editable:!1,height:450,width:730,selectionMode:"cell",allowSorting:!0,schema:m,data:(0,C.IR)(v,m),onSelect:function(o){r.recycleSelected=o.filter(function(y){return y}).map(function(y){return y._i})}})})},Ne=(0,B.Pi)(Be),Ae=(0,B.Pi)(function(){var u=(0,i.useRef)(null),n=(0,i.useState)(!1),s=(0,Z.Z)(n,2),a=s[0],r=s[1],d=(0,i.useContext)(C.xi),c=d.dataStore;return(0,e.jsxs)("div",{className:"toolbar-item",ref:u,style:{width:80,borderRight:"1px solid #c5c5c5"},children:[(0,e.jsxs)("a",{onClick:function(){return r(!0)},children:[(0,e.jsx)(Ee.Z,{size:18,style:{cursor:"pointer"}}),"\u56DE\u6536\u7AD9"]}),a&&(0,e.jsx)(Ne,{onClose:function(){r(!1),c.loadData()}})]})}),Te=(0,B.Pi)(function(){return(0,e.jsx)("div",{className:"toolbar-item",style:{width:45,borderRight:"1px solid #c5c5c5"},children:(0,e.jsx)("a",{onClick:function(){window.open("https://surveyking.cn/docs/guides/data")},children:(0,e.jsx)(V.Z,{size:18,style:{cursor:"pointer"}})})})}),Pt=t(59250),Pe=t(13013),Rt=t(30887),Re=t(28682),bt=t(77883),be=t(85482),ke=t(14603),Oe=t.n(ke),Me=t(83434),ze=t.n(Me),Ve=t(53758),Le=t.n(Ve),we=t(41198),$e=t.n(we),Ue=t(34994),Ge=t.n(Ue),He=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore,s=n.pagination,a=s.total,r=s.current,d=s.pageSize,c=(0,i.useRef)(d),v=Math.ceil(a/d);d<=0&&(v=1);var f=(r-1)*d+1,x=r*d;(x<=0||x>a)&&(x=a);var m=function(o){typeof o=="number"?n.loadData({current:r,pageSize:o,total:a}):o==="\u663E\u793A\u6240\u6709"?n.loadData({current:r,pageSize:-1,total:a}):P.Z.confirm({icon:null,content:(0,e.jsx)(b.Z.Item,{label:"\u81EA\u5B9A\u4E49\u9875\u7801",children:(0,e.jsx)(be.Z,{style:{width:200},defaultValue:d,onChange:function(A){c.current=A}})}),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){n.loadData({current:r,pageSize:c.current,total:a})}})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"toolbar-item",style:{borderLeft:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:r===1?"disabled":"",title:"First page",onClick:function(){r>1&&n.loadData({current:1,pageSize:d,total:a})},children:(0,e.jsx)(Oe(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:r===1?"disabled":"",onClick:function(){r>1&&n.loadData({current:r-1,pageSize:d,total:a})},title:"Previous page",children:(0,e.jsx)($e(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{title:"Page set",children:(0,e.jsx)(Pe.Z,{trigger:["click"],placement:"top",overlay:(0,e.jsx)(Re.Z,{style:{minWidth:80,padding:0},items:[20,50,100,500,1e3,"\u663E\u793A\u6240\u6709","\u81EA\u5B9A\u4E49\u9875\u7801"].map(function(l){return{label:l,key:l,onClick:function(){return m(l)},style:{padding:"0 1em"}}})}),children:(0,e.jsxs)("span",{style:{display:"flex",width:65,justifyContent:"center",alignItems:"center"},children:[a===0?"0 \u884C":"".concat(f,"-").concat(x),(0,e.jsx)(Ge(),{size:18,style:{cursor:"pointer"}})]})})})}),a>0&&(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{onClick:function(){n.loadData()},title:"Refresh total",children:(0,e.jsxs)("span",{style:{lineHeight:"16px"},children:["of ",a]})})}),(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsx)("a",{className:r===v?"disabled":"",onClick:function(){r<v&&n.loadData({current:r+1,pageSize:d,total:a})},title:"Next page",children:(0,e.jsx)(Le(),{size:18,style:{cursor:"pointer"}})})}),(0,e.jsx)("div",{className:"toolbar-item",style:{borderRight:"1px solid #d3cfcf"},children:(0,e.jsx)("a",{className:r===v?"disabled":"",onClick:function(){r<v&&n.loadData({current:d,pageSize:d,total:a})},title:"Last page",children:(0,e.jsx)(ze(),{size:18,style:{cursor:"pointer"}})})})]})}),Qe=(0,B.Pi)(function(){var u,n=(0,i.useContext)(C.xi),s=n.dataStore,a=((u=s.selected)===null||u===void 0?void 0:u.length)||0;return(0,e.jsx)("div",{className:"toolbar-item",children:(0,e.jsxs)("a",{children:["\u5DF2\u9009\u4E2D ",a," \u6761"]})})}),kt=t(38979),Ke=t(59466),We=function(){return(0,e.jsx)("div",{className:"toolbar-item tips",children:(0,e.jsxs)(Ke.Z,{dots:!1,dotPosition:"left",autoplay:!0,children:[(0,e.jsx)("div",{className:"tip",children:"\u{1F609} \u53CC\u51FB\u5355\u5143\u683C\u7F16\u8F91\u95EE\u5377"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F920} \u53F3\u952E\u5355\u5143\u683C\u4E5F\u6709\u5F88\u591A\u529F\u80FD"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F60B} \u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u51BB\u7ED3\u7A97\u683C"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F917} \u652F\u6301\u81EA\u5B9A\u4E49\u5206\u9875"}),(0,e.jsx)("div",{className:"tip",children:"\u{1F913} \u53F3\u952E\u5355\u5143\u683C\u53EF\u4EE5\u8FC7\u6EE4\u884C"})]})})},Ye=t(77613);function L(u){return Math.round(u*100)/100}function Je(u){if(u<1024)return"".concat(L(u),"b");if(u<=1024*1024)return"".concat(L(u/1024),"Kb");if(u<=1024*1024*1024)return"".concat(L(u/1024/1024),"Mb")}var Xe=(0,Ye.P)(function(){var u=(0,K.a)(),n=u.progress;return typeof n!="number"?(0,e.jsx)(e.Fragment,{}):(0,e.jsx)("div",{className:"toolbar-item progress-bar",children:(0,e.jsx)("div",{"aria-valuemin":0,className:"bp3-progress-bar bp3-intent-primary",role:"progressbar",children:(0,e.jsx)("div",{className:"bp3-progress-meter",children:Je(n)})})})}),qe=t(11949),_e=t.n(qe),et=function(n){var s=n.files,a=n.onClose,r=(0,i.useRef)(),d=s.filter(function(c){var v=c.originalName.substring(c.originalName.lastIndexOf(".")+1).toLowerCase();return!!["png","jpg","jpeg","bmp","webp","gif","tif"].includes(v)});return(0,i.useEffect)(function(){if(r.current){var c=new(_e())(r.current,{viewed:function(){},hidden:function(){a()}});c.show()}},[s]),(0,e.jsx)("div",{ref:r,children:d.map(function(c){return(0,e.jsx)("img",{style:{display:"none"},src:"/api/public/preview/".concat(c.id)},c.id)})})},tt=et,nt=function(n){var s=n.cell,a=n.onClose;return s.type==="image"&&s.value instanceof Array?(0,e.jsx)(tt,{files:s.value,onClose:a}):(0,e.jsx)(e.Fragment,{})},Ot=t(17462),at=t(76772),st=t(3980),rt=t(84391),lt=t(43347),it=t(58602),ut=function(){var n=(0,i.useState)(!1),s=(0,Z.Z)(n,2),a=s[0],r=s[1],d=(0,i.useState)(!1),c=(0,Z.Z)(d,2),v=c[0],f=c[1],x=(0,i.useState)([]),m=(0,Z.Z)(x,2),l=m[0],o=m[1],y=(0,k.IE)(),A=(0,i.useContext)(C.xi),h=A.dataStore,p={multiple:!1,accept:".xlsx",beforeUpload:function(F){return o([F]),!1},onRemove:function(){o([])},maxCount:1};return(0,e.jsxs)("div",{className:"toolbar-item",children:[(0,e.jsx)("a",{title:"Download result",onClick:function(){return r(!0)},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(rt.Z,{}),"\u5BFC\u5165\u6570\u636E"]})}),(0,e.jsxs)(P.Z,{confirmLoading:v,title:(0,e.jsxs)("span",{children:["\u5BFC\u5165\u6570\u636E",(0,e.jsx)(Q.Z,{title:(0,e.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return window.open("https://surveyking.cn/docs/guides/custom_import")},children:"\u67E5\u770B\u6587\u6863"}),children:(0,e.jsx)(V.Z,{style:{marginLeft:10}})})]}),visible:a,onCancel:function(){return r(!1)},okText:"\u5BFC\u5165",onOk:function(){if(l.length===0){O.default.error("\u8BF7\u9009\u62E9\u6587\u4EF6");return}f(!0),st.hi.upload("/api/answers/upload",{file:l[0],autoSchema:!0,projectId:y.id},function(F){}).then(function(F){F.success?(O.default.success("\u5BFC\u5165\u6210\u529F"),h.loadData()):O.default.error(F.message),f(!1)})},children:[(0,e.jsxs)(it.Z,(0,M.Z)((0,M.Z)({},p),{},{children:[(0,e.jsx)("p",{className:"ant-upload-drag-icon",children:(0,e.jsx)(lt.Z,{})}),(0,e.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u8005\u62D6\u62FDExcel\u6587\u4EF6\u5230\u6B64\u5904"})]})),(0,e.jsx)("div",{style:{marginTop:10},children:(0,e.jsx)(at.Z,{message:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{children:"1. \u5BFC\u5165 Excel \u7684\u7B2C\u4E00\u884C\u4E3A\u6807\u9898\uFF0C\u4E14\u6807\u9898\u5FC5\u987B\u4E0E\u5DF2\u6709\u6570\u636E\u4FDD\u6301\u4E00\u81F4"}),(0,e.jsx)("div",{children:"2. \u76EE\u524D\u4EC5\u652F\u6301\u586B\u7A7A\u9898\u7684\u5BFC\u5165"})]}),type:"info"})})]})]})},ot=(0,B.Pi)(function(){var u=(0,i.useContext)(C.xi),n=u.dataStore,s=(0,k.IE)(),a=s.schema,r=n.records||[],d=s.mode,c=(0,i.useState)(),v=(0,Z.Z)(c,2),f=v[0],x=v[1],m=(0,i.useMemo)(function(){var h=(0,C.ZZ)(a);return h.length==0?h.push({name:"\u6682\u65E0\u6570\u636E!"}):(d==="exam"&&h.push({name:"examScore",title:"\u5206\u6570",width:100,type:"number"}),h.push({name:"openid",title:"\u81EA\u5B9A\u4E49\u5B57\u6BB5",width:120}),h.push({name:"startTime",title:"\u5F00\u59CB\u65F6\u95F4",width:180}),h.push({name:"endTime",title:"\u63D0\u4EA4\u65F6\u95F4",width:180}),h.push({name:"totalTime",title:"\u7B54\u9898\u65F6\u957F"}),h.push({name:"createByName",title:"\u63D0\u4EA4\u4EBA",width:180}),h.push({name:"remoteIp",title:"IP\u5730\u5740"}),h.push({name:"browserType",title:"\u6D4F\u89C8\u5668"}),h.push({name:"deviceType",title:"\u8BBE\u5907\u7C7B\u578B"}),h.push({name:"platform",title:"\u5E73\u53F0\u7C7B\u578B"})),h},[a]),l=(0,i.useState)({width:-1,height:-1}),o=(0,Z.Z)(l,2),y=o[0],A=o[1];return(0,i.useEffect)(function(){a&&n.loadData()},[a]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_.Z,{bounds:!0,onResize:function(p){p.bounds&&A(p.bounds)},children:function(p){var E=p.measureRef;return(0,e.jsx)("div",{className:"dataTable-container",ref:E,children:(0,e.jsx)(G._$,{editable:!1,height:y.height,width:y.width,selectionMode:"cell",allowSorting:!0,schema:m,data:(0,C.IR)(r,m),onSelect:function(g){n.selected=g.filter(function(I){return I}).map(function(I){return I._i})},onClick:function(g){(g.style==="cell"||g.style==="activeCell")&&x({cell:g,visible:!0})},onDoubleClick:function(g){return g.style==="cell"||g.style==="activeCell"?(n.currentIndex=g.data._i,!0):!1}})})}}),f&&f.visible&&(0,e.jsx)(nt,{cell:f.cell,onClose:function(){return x((0,M.Z)((0,M.Z)({},f),{},{visible:!1}))}})]})}),ct=function(){return(0,e.jsxs)("div",{className:"toolbar-container",children:[(0,e.jsx)(le,{}),(0,e.jsx)(ae,{}),(0,e.jsx)(Ze,{}),(0,e.jsx)(oe,{}),(0,e.jsx)(he,{}),(0,e.jsx)(ut,{}),(0,e.jsx)(Ae,{}),(0,e.jsx)(Te,{})]})},dt=function(){return(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)(Qe,{})}),(0,e.jsx)("div",{children:(0,e.jsx)(He,{})}),(0,e.jsxs)("div",{className:"right-content",children:[(0,e.jsx)(Xe,{}),(0,e.jsx)(We,{})]})]})},vt=t(23156),W=function(){var n=(0,k.IE)(),s=(0,i.useMemo)(function(){return new vt.Cu(n)},[n]);return(0,e.jsx)(C.fQ,{value:{dataStore:s,prefixCls:"survey-data"},children:(0,e.jsxs)("div",{className:"survey-data",children:[(0,e.jsx)(ct,{}),(0,e.jsx)(ot,{}),(0,e.jsx)(dt,{})]})})},ft=W}}]);
