(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[8068],{68068:function(re,X,a){"use strict";a.d(X,{O:function(){return ie},Z:function(){return Pe}});var L=a(9761),V=a(67294),H=a(67635),U=a(86052),K=a(48187),Y=a(91220),k=a(93224),x=a(39428),B=a(83279),M=a(3182),P=a(11849),_=a(94657),ae=a(69610),se=a(54941),I=a(64031),y=a(54531);function ue(u,e){}var F=a(40807),le=["visible"],oe=function(){function u(e){var r=this;(0,ae.Z)(this,u),this.props=void 0,this.progress=0,this.form=void 0,this.pagination={current:1,pageSize:1,currentIndex:0,paginationNodes:[]},this.notNoneInQuestionGroup=[],this.answerSheet=[],this.answerSheetVisible=!1,this.reviewAnswer={},this.autoNextPage=void 0,this.compute=void 0;var i=e.initialValues,n=e.readOnly,t=e.fieldPermission,s=e.theme,l=e.schema,o=e.mode,d=e.onePageOneQuestion,f=d===void 0?!1:d,v=e.paginationVisible;this.props=e,this.initPagination(l,v,f);var g=(0,I.Np)({initialValues:i,readOnly:n,validateFirst:!0,pattern:e.pattern,effects:function(p){(0,I.dQ)(function(){if(t){var m=[],c=[];Object.entries(t).forEach(function(b){var N=(0,_.Z)(b,2),O=N[0],Z=N[1];Z===0?m.push(O):Z===1&&c.push(O)}),m.length>0&&g.setFieldState("*(".concat(m.join(","),")"),function(b){return b.display="none"}),c.length>0&&g.setFieldState("*(".concat(c.join(","),")"),function(b){return b.pattern="readPretty"})}r.handleFormValuesChange(),r.highlightJs(),r.setVisible(0)}),(0,I.pO)(function(m){r.handleFormValuesChange()}),(0,I.Zj)("*",function(m,c){r.handleFieldValueChange(m,c)}),ue(l,p)}});this.form=g,this.answerSheet=(0,F.Xn)(l).filter(function(h){var p;return(0,F.a1)(h.type)&&((p=h.attribute)===null||p===void 0?void 0:p.display)!=="hidden"}).map(function(h){return{finished:!1,id:h.id,marked:!1,display:"visible"}})||[],s==="antd"&&o==="exam"&&(this.answerSheetVisible=!0),this.autoNextPage=0,e.exerciseMode&&e.onePageOneQuestion&&(this.autoNextPage=1),this.makeObservable(),this.props.correctAnswerVisible&&i&&(0,F.Xn)(l).forEach(function(h){r.computeReviewAnswer(h,i[h.id]).then(function(p){p&&(r.reviewAnswer[h.id].visible=!0)})}),this.compute=de(function(){r.reOrder(),r.computeProgress(),r.computePagination()},10)}return(0,se.Z)(u,[{key:"makeObservable",value:function(){(0,y.Ou)(this,{progress:y.LO.ref,pagination:y.LO.shallow,form:y.LO.ref,props:y.LO.shallow,answerSheet:y.LO,answerSheetVisible:y.LO.ref,reviewAnswer:y.LO,notNoneInQuestionGroup:y.LO,schema:y.LO.computed,autoNextPage:y.LO.ref,computeProgress:y.aD,validate:y.aD,handlePrev:y.aD,handleNext:y.aD,submit:y.aD,handleFormValuesChange:y.aD,changePageIndex:y.aD,handleFieldValueChange:y.aD,computeReviewAnswer:y.aD,reOrder:y.aD})}},{key:"schema",get:function(){return this.props.schema}},{key:"questionsGroupByPagination",get:function(){return this.pagination.paginationNodes}},{key:"initPagination",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i?this.pagination.paginationNodes=(0,F._T)(r,n):this.pagination.paginationNodes=[r.children],this.pagination.pageSize=this.pagination.paginationNodes.length}},{key:"computePagination",value:function(){if(this.props.paginationVisible===!1)return;var r=this.form.fields;function i(v){return t[v].every(function(g){var h=r[g.id].data;return h.some(function(p){return p==="self_display"||p.startsWith("rule_")})})}for(var n=this.pagination,t=n.paginationNodes,s=n.currentIndex,l=0,o=0,d=0;d<t.length;d++){var f=t[d];if(f.some(function(v){var g=r[v.id].data;return g.length===0}))o++,l++;else{if(i(d))continue;o++,d<=s&&l++}}this.pagination=(0,P.Z)((0,P.Z)({},this.pagination),{},{current:l,pageSize:o,currentIndex:s})}},{key:"highlightJs",value:function(){document.querySelectorAll(".ql-syntax").forEach(function(r){})}},{key:"validate",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(n){var t,s;return(0,x.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(s=((t=this.questionsGroupByPagination[n])===null||t===void 0?void 0:t.reduce(function(d,f){return d.push.apply(d,(0,B.Z)((0,F.Xn)(f))),d},[]))||[],s.length!==0){o.next=3;break}return o.abrupt("return",!0);case 3:return o.abrupt("return",this.form.validate("*(".concat(s.map(function(d){return d.id}).join(","),")")));case 4:case"end":return o.stop()}},i,this)}));function r(i){return e.apply(this,arguments)}return r}()},{key:"setVisible",value:function(r){var i=this.pagination,n=i.currentIndex,t=i.paginationNodes,s=this.form.fields,l=r===void 0?n:r;function o(h){return t[h].every(function(p){var m=s[p.id].data;return m.some(function(c){return c==="self_display"||c.startsWith("rule_")})})}if(r!==void 0){if(r===n+1){var d=o(r);if(d){this.pagination.currentIndex=n+1,this.setVisible(r+1);return}}else if(r===n-1){var f=o(r);if(f){this.pagination.currentIndex=n-1,this.setVisible(r-1);return}}}for(var v=0;v<t.length;v++){var g=t[v];v===l?g==null||g.forEach(function(h){var p=s[h.id].data;s[h.id].data=p.filter(function(m){return m!=="hidden"})}):g.forEach(function(h){var p=s[h.id].data;p.includes("hidden")||(s[h.id].data=[].concat((0,B.Z)(p),["hidden"]))})}this.pagination.currentIndex=l}},{key:"handlePrev",value:function(){var r=this.pagination.currentIndex;this.setVisible(r-1)}},{key:"handleNext",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(n){var t;return(0,x.Z)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=this.pagination.currentIndex,l.prev=1,l.next=4,this.validate(t);case 4:this.setVisible(t+1),setTimeout(function(){return window.scroll({top:0})},10),l.next=11;break;case 8:l.prev=8,l.t0=l.catch(1),console.log(l.t0);case 11:case"end":return l.stop()}},i,this,[[1,8]])}));function r(i){return e.apply(this,arguments)}return r}()},{key:"changePageIndex",value:function(r){var i=this.questionsGroupByPagination.findIndex(function(n){return!!(n.reduce(function(t,s){return t.push.apply(t,(0,B.Z)((0,F.Xn)(s))),t},[])||[]).find(function(t){return t.id===r})});this.setVisible(i),(0,F.lA)(r,this.props.progressBar?-25:0)}},{key:"handleFormValuesChange",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(){return(0,x.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.computeProgress(),this.props.onChange&&this.props.onChange(this.form.values,this.progress);case 2:case"end":return t.stop()}},i,this)}));function r(){return e.apply(this,arguments)}return r}()},{key:"handleFieldValueChange",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(n,t){var s,l,o;return(0,x.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=n.path.toString(),(s=(l=this.props).onFieldChange)===null||s===void 0||s.call(l,o,(0,y.ZN)(n.value)),this.props.exerciseMode&&this.computeReviewAnswer(n.componentProps.schema,n.value);case 3:case"end":return f.stop()}},i,this)}));function r(i,n){return e.apply(this,arguments)}return r}()},{key:"computeReviewAnswer",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(n,t){var s,l,o,d,f,v,g,h;return(0,x.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=!1,this.props.mode!=="exam"){m.next=12;break}if(o=this.reviewAnswer[n.id]||{},d=n.type,["FillBlank","MultipleBlank","HorzBlank","Radio","Checkbox"].includes(n.type)){m.next=6;break}return m.abrupt("return");case 6:if(d==="Radio"&&(o.visible=!0),(l=n.attribute)!==null&&l!==void 0&&l.examAnswerMode&&["selectAll","selectCorrect","onlyOne","select"].includes(n.attribute.examAnswerMode)){m.next=9;break}return m.abrupt("return");case 9:s=!0,this.reviewAnswer[n.id]=n.children.reduce(function(c,b){var N,O=!!((N=b.attribute)!==null&&N!==void 0&&N.examCorrectAnswer);if(d==="FillBlank"||d==="MultipleBlank"||d==="Textarea"||d==="HorzBlank"){var Z,w,G=(Z=b.attribute)===null||Z===void 0?void 0:Z.examMatchRule,z=t==null?void 0:t[b.id],W=(w=b.attribute)===null||w===void 0?void 0:w.examCorrectAnswer;!z||!W?O=!1:G==="contain"&&z.includes(W.trim())||z===W?O=!0:O=!1}return c[b.id]={selected:!!(t!=null&&t.hasOwnProperty(b.id)),isCorrect:O},c},{visible:!!(o!=null&&o.visible)}),this.autoNextPage===1&&(f=this.reviewAnswer[n.id],v=f.visible,g=(0,k.Z)(f,le),h=Object.values(g).filter(function(c){return c.selected&&c.isCorrect}).length===1,h&&d==="Radio"&&this.handleNext());case 12:return m.abrupt("return",s);case 13:case"end":return m.stop()}},i,this)}));function r(i,n){return e.apply(this,arguments)}return r}()},{key:"computeProgress",value:function(){var r=this;if(!!this.props.progressBar){var i=0,n=0;this.form.query("*").forEach(function(t){var s=r.answerSheet.find(function(l){return l.id===t.path.toString()});t.displayName==="Field"&&!t.path.toString().startsWith("_")&&(s&&(s.display=t.display),t.data.filter(function(l){return l!=="hidden"}).length===0&&i++,!(0,F.xb)(t.value)&&t.componentProps.schema.attribute.display!=="hidden"?(n++,s&&(s.finished=!0)):s&&(s.finished=!1))}),this.progress=n/i}}},{key:"reOrder",value:function(){var r,i=this;if(!!this.props.questionNumber){var n=1;(r=this.schema.children)===null||r===void 0||r.filter(function(t){return!(0,F.nj)(t.type)||t.type==="QuestionSet"}).forEach(function(t){var s,l=t.id,o=i.form.query(l).get("display");if(o!=="none"&&((s=t.attribute)===null||s===void 0?void 0:s.display)!=="hidden"){var d=i.form.query(l).take();d&&(d.setDecoratorProps((0,P.Z)((0,P.Z)({},d.decoratorProps),{},{seqNo:n})),n++);var f=1;if(t.type==="QuestionSet"){var v;(v=t.children)===null||v===void 0||v.filter(function(g){return!(0,F.nj)(g.type)}).forEach(function(g){var h=g.id,p=i.form.query(h).get("display");if(p==="visible"){var m=i.form.query(h).take();m&&(m.setDecoratorProps((0,P.Z)((0,P.Z)({},m.decoratorProps),{},{seqNo:f})),f++)}})}}})}}},{key:"submit",value:function(){var e=(0,M.Z)((0,x.Z)().mark(function i(){var n,t,s,l,o,d,f,v,g,h,p;return(0,x.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:n="",t=this.form.query("*").map().filter(function(b){return!(0,I.JF)(b)}),s=(0,Y.Z)(t),c.prev=3,s.s();case 5:if((l=s.n()).done){c.next=31;break}if(v=l.value,!(0,I.JF)(v)){c.next=9;break}return c.abrupt("continue",29);case 9:if(n=v.path.toString(),g=((o=this.props.schema.children)===null||o===void 0||(d=o.find(function(b){return b.id===n}))===null||d===void 0||(f=d.attribute)===null||f===void 0?void 0:f.display)==="hidden",!g){c.next=13;break}return c.abrupt("continue",29);case 13:if(h=v.display,h!=="none"){c.next=16;break}return c.abrupt("continue",29);case 16:return p=v.selfDisplay,v.display="visible",c.prev=18,c.next=21,v.validate();case 21:v.display=p,c.next=29;break;case 24:return c.prev=24,c.t0=c.catch(18),this.changePageIndex(n),(0,F.lA)(n,this.props.progressBar?-25:0),c.abrupt("return");case 29:c.next=5;break;case 31:c.next=36;break;case 33:c.prev=33,c.t1=c.catch(3),s.e(c.t1);case 36:return c.prev=36,s.f(),c.finish(36);case 39:return this.props.onSubmit&&this.props.onSubmit((0,y.ZN)(this.form.values)),c.abrupt("return",{values:(0,y.ZN)(this.form.values)});case 41:case"end":return c.stop()}},i,this,[[3,33,36,39],[18,24]])}));function r(){return e.apply(this,arguments)}return r}()},{key:"markQuestion",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.answerSheet,t=n.findIndex(function(s){return s.id===r});this.answerSheet.splice(t,1,(0,P.Z)((0,P.Z)({},n[t]),{},{marked:i}))}}]),u}();function de(u,e,r){var i=void 0,n=void 0;return function(){var t=+new Date;n||(n=t),r&&t-n>r?(u(),n=t,window.clearTimeout(i)):(window.clearTimeout(i),i=window.setTimeout(function(){u(),n=void 0},e))}}var fe=a(76826),ee=a(99439),ce=a(27484),he=a.n(ce),ve=a(90019),J=a(10192);function me(u,e){var r,i,n=e.id,t=[];if((r=e.parent)!==null&&r!==void 0&&(i=r.type)!==null&&i!==void 0&&i.startsWith("Matrix"))if(e.parent.type==="MatrixAuto"&&Array.isArray(u))u.forEach(function(d,f){t.push(["".concat(f,"-").concat(n),d[e.id]])});else{var s;(s=e.parent.row)===null||s===void 0||s.forEach(function(d){u[d.id]?t.push(["".concat(d.id,"-").concat(n),u[d.id][e.id]]):t.push(["".concat(d.id,"-").concat(n),void 0])})}else{var l,o=(l=e.parent)===null||l===void 0?void 0:l.type;o==="Radio"||o==="Checkbox"?Object.keys(u).includes(e.id)&&t.push([e.id,u[e.id]]):t.push([e.id,u[e.id]])}return t}function te(u){return!isNaN(parseFloat(u))&&isFinite(u)}function ge(u){return!!(te(u)&&Number.isInteger(parseFloat(u)))}function A(u){var e=u.errMsg,r=u.schema,i=u.regEx,n=u.value;return r?$({schema:r,value:n,errMsg:e,isValid:function(s){return s?i.test("".concat(s)):!0}}):null}function pe(u){var e,r=u.schema,i=u.value,n=u.errMsg,t=((e=r.children)===null||e===void 0?void 0:e.filter(function(d){var f;return(f=d.attribute)===null||f===void 0?void 0:f.exclusiveFillBlankInMatrix}))||[],s=JSON.parse(JSON.stringify(i));Object.values(s).forEach(function(d){t.map(function(f){return f.id}).forEach(function(f){delete d[f]})});var l=!1;if(r.type==="MatrixAuto")i&&i.length>0&&(l=!0);else{var o;l=(o=r.row)===null||o===void 0?void 0:o.every(function(d){var f=s[d.id];return!(0,F.xb)(f)})}return l?null:n}function $(u){var e=u.value,r=u.schema,i=u.isValid,n=u.errMsg;return!r||!r.parent?null:me(e,r).map(function(t){var s=(0,_.Z)(t,2),l=s[0],o=s[1];return i(o)?null:"".concat(l,"^").concat(n)}).filter(function(t){return t})[0]}function $e(u){if(Object.keys(u).length===0)return!0}function ye(u){var e=u.substring(6,8),r=u.substring(8,10),i=u.substring(10,12),n=new Date(parseFloat(e),parseFloat(r)-1,parseFloat(i));return!(n.getFullYear()-1900!==parseFloat(e)||n.getMonth()!==parseFloat(r)-1||n.getDate()!==parseFloat(i))}function Ve(u){var e=u;if(u.length!==15&&u.length!==18)return!1;if(u.length===15)return ye(e);var r={11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F ",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317 ",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF ",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916 "},i=!0;if(!e||!/^([1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx])|([1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2})$/i.test(e))i=!1;else if(!r[e.substr(0,2)])i=!1;else if(e.length>18)i=!1;else if(e.length===18){for(var n=e.split(""),t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],s=[1,0,"X",9,8,7,6,5,4,3,2],l=0,o=0,d=0,f=0;f<17;f+=1)o=parseInt(n[f],10),d=t[f],l+=o*d;var v=n[17].toUpperCase()==="X"?"X":Number(n[17]);s[l%11]!==v&&(i=!1)}return i}function E(u,e){return!!(!u||!e||(0,F.xb)(u[e.id]))}var be={required:function(e,r){var i,n=r.schema,t=r.theme;return r&&r.required===!1?null:(0,F.xb)(e)?t==="antdForm"?"\u8BF7\u8F93\u5165":"\u8FD9\u9053\u9898\u672A\u56DE\u7B54":n!=null&&(i=n.type)!==null&&i!==void 0&&i.startsWith("Matrix")?pe({schema:n,errMsg:"\u95EE\u9898\u672A\u56DE\u7B54\u5B8C\u6574",value:e}):n!=null&&n.parent?$({schema:n,value:e,errMsg:"\u8FD9\u4E2A\u9009\u9879\u672A\u56DE\u7B54",isValid:function(l){var o;return(0,fe.Kn)(n)&&(o=n.attribute)!==null&&o!==void 0&&o.dataType&&l===!0?!1:!(0,F.xb)(l)}}):null},answerLimit:function(e,r){var i,n=r.schema,t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.answerLimit;if(!t)return null;var s=t.slice(1,t.length-1).split(","),l=parseInt(s[0]||"0"),o=parseInt(s[1]||"0"),d=Object.keys(e||{}).length;return e&&(d<l&&l!==0||d>o&&o!==0)?l===0?"\u6700\u591A\u9009\u62E9".concat(o,"\u9879"):o===0?"\u6700\u5C11\u9009\u62E9".concat(l,"\u9879"):"\u6700\u5C11\u9009\u62E9".concat(l,"\u9879,\u6700\u591A\u9009\u62E9").concat(o,"\u9879"):null},number:function(e,r){var i,n=r.schema;if(E(e,n))return null;var t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.numericScale,s="\u8BF7\u8F93\u5165\u6570\u5B57";return t===0?s="\u8BF7\u8F93\u5165\u6574\u6570":t&&t>0&&(s="\u8BF7\u4FDD\u7559".concat(t,"\u4F4D\u5C0F\u6570")),$({errMsg:s,schema:n,value:e,isValid:function(o){return!(o!==void 0&&(!te(o)||t===0&&!ge(o)||t!==void 0&&t>0&&("".concat(o).split(".")[1]||"").length>t))}})},date:function(e,r){var i,n=r.schema;if(E(e,n))return null;if(n!=null&&(i=n.attribute)!==null&&i!==void 0&&i.dateTimeFormat&&e&&e[n.id]){var t=he()(e[n.id],n.attribute.dateTimeFormat).isValid();return t?null:"\u65E5\u671F\u683C\u5F0F\u4E0D\u6B63\u786E"}return A({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F",schema:n,regEx:/^(?:(?:1[6-9]|[2-9][0-9])[0-9]{2}([-/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:(?:1[6-9]|[2-9][0-9])(?:0[48]|[2468][048]|[13579][26])|(?:16|[2468][048]|[3579][26])00)([-/.]?)0?2\2(?:29))(\s+([01][0-9]:|2[0-3]:)?[0-5][0-9]:[0-5][0-9])?$/,value:e})},dateTime:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u8BF7\u8F93\u5165\u65E5\u671F\u65F6\u95F4",schema:i,regEx:/^\d{4}[-]([0][1-9]|(1[0-2]))[-]([1-9]|([012]\d)|(3[01]))\s(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:e})},time:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u8BF7\u8F93\u5165\u65F6\u95F4",schema:i,regEx:/^(([0-1]{1}[0-9]{1})|([2]{1}[0-4]{1}))([:])(([0-5]{1}[0-9]{1}|[6]{1}[0]{1}))([:])((([0-5]{1}[0-9]{1}|[6]{1}[0]{1})))$/,value:e})},mobile:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^1([358][0-9]|4[579]|66|7[01235678]|9[189])[0-9]{8}$/,value:e})},decimal:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u8BF7\u8F93\u5165\u6570\u5B57",schema:i,regEx:/^[+-]?\d+(\.\d+)?$/,value:e})},email:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u90AE\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,regEx:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,value:e})},idCard:function(e,r){var i=r.schema;return E(e,i)?null:$({errMsg:"\u8EAB\u4EFD\u8BC1\u683C\u5F0F\u4E0D\u6B63\u786E",schema:i,value:e,isValid:function(t){return!(t&&!Ve("".concat(t)))}})},chinese:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u8BF7\u8F93\u5165\u6C49\u5B57",schema:i,regEx:/^[\u4e00-\u9fa5]+$/,value:e})},alphabet:function(e,r){var i=r.schema;return E(e,i)?null:A({errMsg:"\u8BF7\u8F93\u5165\u5B57\u6BCD",schema:i,regEx:/^[a-zA-Z]+$/,value:e})},textLimit:function(e,r){var i,n=r.schema;if(E(e,n))return null;var t=n==null||(i=n.attribute)===null||i===void 0?void 0:i.textLimit;if(!t)return null;var s=t.slice(1,t.length-1).split(","),l=parseInt(s[0]||"0"),o=parseInt(s[1]||"0");if(l===0&&o===0)return null;var d=$({errMsg:l!==o?"\u8BF7\u8F93\u5165".concat(l,"~").concat(o,"\u4E2A\u5B57"):"\u8BF7\u8F93\u5165".concat(l,"\u4E2A\u5B57"),schema:n,value:e,isValid:function(v){return!(v&&("".concat(v).length<l||"".concat(v).length>o))}});return d},scope:function(e,r){var i,n,t=r.schema,s=t==null||(i=t.attribute)===null||i===void 0?void 0:i.scope,l=t==null||(n=t.attribute)===null||n===void 0?void 0:n.dataType;if(s&&l){if(l==="number")return $({errMsg:"\u6570\u503C\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:t,value:e,isValid:function(d){return!(d&&!(0,J.$l)(s,"".concat(d)))}});if(l==="date")return $({errMsg:"\u65E5\u671F\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:t,value:e,isValid:function(d){return!(d&&!(0,J.sm)(s,"".concat(d)))}});if(l==="dateTime")return $({errMsg:"\u65E5\u671F\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:t,value:e,isValid:function(d){return!(d&&!(0,J.de)(s,"".concat(d)))}});if(l==="time")return $({errMsg:"\u65F6\u95F4\u8303\u56F4\u4E0D\u6B63\u786E ".concat(s),schema:t,value:e,isValid:function(d){return!(d&&!(0,J.YM)(s,"".concat(d)))}})}return null},horzBlank:function(e,r){return(0,M.Z)((0,x.Z)().mark(function i(){var n,t,s,l,o,d,f,v;return(0,x.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(t=r.schema,!((t==null||(n=t.attribute)===null||n===void 0?void 0:n.dataType)!=="horzBlank"||e[t.id]===void 0||!t.children||!t.parent)){h.next=3;break}return h.abrupt("return",null);case 3:s=null,l=0;case 5:if(!(l<((o=t.children)===null||o===void 0?void 0:o.length))){h.next=15;break}return d=t.children[l],f=(0,ve.j)(d,t),h.next=10,(0,ee.Gu)(e[t.id],f,{validateFirst:!0});case 10:v=h.sent,v.error&&v.error.length>0&&(s=v.error[0]);case 12:l++,h.next=5;break;case 15:return h.abrupt("return",s);case 16:case"end":return h.stop()}},i)}))()}};(0,ee.au)(be);var Fe=a(3980),xe=a(8166),ne=a(8373),T=a(85893);window.katex=xe.Z;var ie=(0,V.forwardRef)(function(u,e){var r=u.theme,i=r===void 0?K.uH:r,n=u.footerVisible,t=n===void 0?!0:n,s=u.headerVisible,l=s===void 0?!0:s,o=u.loading,d=u.questionNumber,f=d===void 0?!0:d,v=u.onUpload,g=u.progressBar,h=g===void 0?!1:g,p=u.statistics,m=u.isPreview,c=u.mode,b=c===void 0?"survey":c,N=u.correctAnswerVisible,O=N===void 0?!1:N,Z=u.examScoreVisible,w=Z===void 0?!1:Z,G=u.requiredVisible,z=G===void 0?!0:G,W=u.onDictSearch,q=(0,V.useMemo)(function(){return new oe(u)},[]),S=q.form,j=(0,V.useMemo)(function(){return(0,F.Gt)(u.schema)},[u.schema]),Ee=(0,V.useMemo)(function(){var C={},D=function Q(R){C[R.id]=R.title,R.children&&R.children.forEach(Q)};return D(j),document.title=(0,Fe.WO)(j.title),C},[j]),Me=(0,V.useMemo)(function(){return(0,F.R6)(u.schema)},[u.schema]);(0,V.useImperativeHandle)(e,function(){return{submit:function(){return q.submit()},reset:function(){S.reset()},setValues:function(D){S.setValues(D,"overwrite")},setValue:function(D,Q){S.setFieldState(D,function(R){return R.value=Q})},toggleReadOnly:function(D){S.setState(function(Q){Q.pattern=D?"readPretty":"editable"})},getValues:function(){return S.values}}}),(0,V.useEffect)(function(){u.onInit&&u.onInit(S)},[]);var Oe=(0,V.useMemo)(function(){return{theme:i,schema:j,footerVisible:t,questionNumber:f,headerVisible:l,optionTypes:Me,onUpload:v,loading:o,id2title:Ee,progressBar:h,innerStore:q,statistics:p,isPreview:m,mode:b,correctAnswerVisible:O,examScoreVisible:w,onDictSearch:W,requiredVisible:z}},[o,j,p]);return(0,T.jsx)(V.Suspense,{fallback:(0,T.jsx)(ne.gb,{}),children:(0,T.jsx)(ne.ZP,{theme:i,children:(0,T.jsx)(L.RV,{form:S,children:(0,T.jsx)(U.Z.Provider,{value:Oe,children:(0,T.jsx)(H.k9,{schema:j})})})})})}),Pe=ie},8373:function(re,X,a){"use strict";a.d(X,{gb:function(){return Y}});var L=a(67294),V=a(85893),H=L.lazy(function(){return Promise.all([a.e(1093),a.e(4409),a.e(1731),a.e(3136),a.e(4399),a.e(6806),a.e(5613),a.e(8550),a.e(5990),a.e(5724),a.e(3524),a.e(8867),a.e(7856),a.e(1044),a.e(2595),a.e(4980),a.e(7998),a.e(2051)]).then(a.bind(a,28161))}),U=L.lazy(function(){return Promise.all([a.e(9548),a.e(1093),a.e(4409),a.e(1731),a.e(4177),a.e(6779),a.e(4753),a.e(3136),a.e(4399),a.e(5613),a.e(8550),a.e(5990),a.e(5724),a.e(2684),a.e(8867),a.e(7856),a.e(6625),a.e(1044),a.e(8764),a.e(596),a.e(811),a.e(7998),a.e(7585)]).then(a.bind(a,9098))}),K=L.lazy(function(){return Promise.all([a.e(4409),a.e(4753),a.e(6806),a.e(5990),a.e(7856),a.e(1044),a.e(5524),a.e(9389)]).then(a.bind(a,17707))}),Y=function(){return(0,V.jsx)("div",{className:"page-loading-warp",children:(0,V.jsxs)("div",{className:"spinner",children:[(0,V.jsx)("div",{className:"rect1"}),(0,V.jsx)("div",{className:"rect2"}),(0,V.jsx)("div",{className:"rect3"}),(0,V.jsx)("div",{className:"rect4"}),(0,V.jsx)("div",{className:"rect5"})]})})},k=function(B){var M=B.theme,P=B.children;return M==="antdMobile"?(0,V.jsx)(U,{children:P}):M==="antdForm"?(0,V.jsx)(K,{children:P}):(0,V.jsx)(H,{children:P})};X.ZP=k}}]);
