(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6527],{41794:function(S,A,t){"use strict";t.r(A),t.d(A,{default:function(){return ne}});var x=t(11849),M=t(2824),ie=t(30887),R=t(54689),F=t(67294),z=t(21349),ue=t(34792),V=t(48086),le=t(43185),D=t(11324),oe=t(57663),b=t(71577),B=t(3182),T=t(94043),m=t.n(T),G=t(84391),U=t(15196),Z=t(5966),K=t(90672),$=t(30779),L=t(16345),h=t.n(L),P=t(68489),C=t(27400),E=t(2299),e=t(85893),O=(0,E.Pi)(function(){var g=(0,C.a)(),r=g.user,o=function(){var c=(0,B.Z)(m().mark(function s(u){var n,d,l,v;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n=u.onSuccess,d=u.onError,l=u.file,v=u.onProgress,P.hi.upload("/api/public/upload",{file:l},function(a){v&&v({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&n&&(n(a.data),P.hi.updateUserInfo({avatar:a.data.id}).then(function(p){p.success&&(r.avatar=a.data.id)})),!a.success&&d){var j=new Error("Some error");d({event:j})}});case 2:case"end":return i.stop()}},s)}));return function(u){return c.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().avatar_title,children:"\u5934\u50CF"}),(0,e.jsx)("div",{className:h().avatar,children:(0,e.jsx)("img",{style:{borderRadius:"50%"},src:"/api/public/preview/".concat(r==null?void 0:r.avatar),alt:"avatar"})}),(0,e.jsx)($.Z,{rotate:!0,shape:"round",children:(0,e.jsx)(D.Z,{showUploadList:!1,customRequest:o,children:(0,e.jsx)("div",{className:h().button_view,children:(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u5934\u50CF"]})})})})]})}),W=function(){var r=(0,C.a)(),o=r.user,c=r.loading,s=(0,F.useMemo)(function(){return o},[]),u=function(){var n=(0,B.Z)(m().mark(function d(l){return m().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:P.hi.updateUserInfo(l).then(function(i){i.success&&(r.user=(0,x.Z)((0,x.Z)({},o),l))}),V.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F");case 2:case"end":return f.stop()}},d)}));return function(l){return n.apply(this,arguments)}}();return(0,e.jsx)("div",{className:h().baseView,children:c?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().left,children:(0,e.jsxs)(U.ZP,{layout:"vertical",onFinish:u,submitter:{resetButtonProps:{style:{display:"none"}},submitButtonProps:{children:"\u66F4\u65B0\u57FA\u672C\u4FE1\u606F"}},initialValues:s,hideRequiredMark:!0,children:[(0,e.jsx)(Z.Z,{width:"md",name:"name",label:"\u59D3\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0!"}]}),(0,e.jsx)(Z.Z,{name:"phone",label:"\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8054\u7CFB\u7535\u8BDD!"}]}),(0,e.jsx)(Z.Z,{width:"md",name:"email",label:"\u90AE\u7BB1",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1!"}]}),(0,e.jsx)(K.Z,{name:"profile",label:"\u4E2A\u4EBA\u7B80\u4ECB",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E2A\u4EBA\u7B80\u4ECB!"}],placeholder:"\u4E2A\u4EBA\u7B80\u4ECB"})]})}),(0,e.jsx)("div",{className:h().right,children:(0,e.jsx)(O,{})})]})})},X=(0,E.Pi)(W),de=t(54421),w=t(38272),ce=t(77576),H=t(12028),J=function(){var r=function(){var s=(0,e.jsx)(H.Z,{checkedChildren:"\u5F00",unCheckedChildren:"\u5173",defaultChecked:!0});return[{title:"\u8D26\u6237\u5BC6\u7801",description:"\u5176\u4ED6\u7528\u6237\u7684\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[s]},{title:"\u7CFB\u7EDF\u6D88\u606F",description:"\u7CFB\u7EDF\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[s]},{title:"\u5F85\u529E\u4EFB\u52A1",description:"\u5F85\u529E\u4EFB\u52A1\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[s]}]},o=r();return(0,e.jsx)(F.Fragment,{children:(0,e.jsx)(w.ZP,{itemLayout:"horizontal",dataSource:o,renderItem:function(s){return(0,e.jsx)(w.ZP.Item,{actions:s.actions,children:(0,e.jsx)(w.ZP.Item.Meta,{title:s.title,description:s.description})})}})})},Q=J,Y=t(37476),k=function(){var r=(0,F.useState)(!1),o=(0,M.Z)(r,2),c=o[0],s=o[1],u=(0,C.a)(),n=u.user,d=(0,P.m2)(),l=(0,F.useRef)(),v=function(){return[{title:"\u8D26\u6237\u5BC6\u7801",actions:[(0,e.jsx)("a",{onClick:function(){return s(!0)},children:"\u4FEE\u6539"},"Modify")]}]},f=v();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(w.ZP,{itemLayout:"horizontal",dataSource:f,renderItem:function(a){return(0,e.jsx)(w.ZP.Item,{actions:a.actions,children:(0,e.jsx)(w.ZP.Item.Meta,{title:a.title})})}}),(0,e.jsxs)(Y.Z,{title:"\u4FEE\u6539\u5BC6\u7801",visible:c,formRef:l,width:400,modalProps:{onCancel:function(){s(!1)},okText:"\u786E\u8BA4\u4FEE\u6539",maskClosable:!1},onFinish:function(){var i=(0,B.Z)(m().mark(function a(j){return m().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:d.saveOrUpdateUser((0,x.Z)({id:n==null?void 0:n.userId},j)).then(function(N){N.success?(s(!1),V.default.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F")):V.default.error(N.message)});case 1:case"end":return y.stop()}},a)}));return function(a){return i.apply(this,arguments)}}(),children:[(0,e.jsx)(Z.Z.Password,{label:"\u65E7\u5BC6\u7801",name:"oldPassword",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5F53\u524D\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(Z.Z.Password,{name:"password",label:"\u65B0\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(Z.Z.Password,{name:"confirmPassword",label:"\u786E\u8BA4\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{validator:function(a,j){var p,y,N=(p=l.current)===null||p===void 0?void 0:p.getFieldValue("password");return j?N!==j&&(y="\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4"):y="\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",y?Promise.reject(new Error(y)):Promise.resolve()}}]})]})]})},q=(0,E.Pi)(k),_=(0,E.Pi)(function(){var g=(0,C.a)(),r=g.system,o=function(){var c=(0,B.Z)(m().mark(function s(u){var n,d,l,v;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n=u.onSuccess,d=u.onError,l=u.file,v=u.onProgress,P.hi.upload("/api/public/upload",{file:l},function(a){v&&v({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&n&&(n(a.data),P.hi.updateSysInfo({id:r==null?void 0:r.id,avatar:a.data.id}).then(function(p){p.success&&(r.avatar=a.data.id)})),!a.success&&d){var j=new Error("Some error");d({event:j})}});case 2:case"end":return i.stop()}},s)}));return function(u){return c.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().avatar_title,children:"\u7CFB\u7EDF\u56FE\u6807"}),(0,e.jsx)("div",{className:h().avatar,children:(0,e.jsx)("img",{src:"/api/public/preview/".concat(r==null?void 0:r.avatar),alt:"avatar"})}),(0,e.jsx)(D.Z,{showUploadList:!1,customRequest:o,children:(0,e.jsx)("div",{className:h().button_view,children:(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u56FE\u6807"]})})})]})}),ee=function(){var r=(0,C.a)(),o=r.system,c=r.loading,s=(0,F.useMemo)(function(){return o},[]),u=function(){var n=(0,B.Z)(m().mark(function d(l){return m().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:P.hi.updateSysInfo((0,x.Z)((0,x.Z)({},o),l)).then(function(i){i.success&&(r.system=(0,x.Z)((0,x.Z)({},o),l))}),V.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F");case 2:case"end":return f.stop()}},d)}));return function(l){return n.apply(this,arguments)}}();return(0,e.jsx)("div",{className:h().baseView,children:c?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:h().left,children:(0,e.jsxs)(U.ZP,{layout:"vertical",onFinish:u,submitter:{resetButtonProps:{style:{display:"none"}},submitButtonProps:{children:"\u66F4\u65B0\u57FA\u672C\u4FE1\u606F"}},initialValues:s,hideRequiredMark:!0,children:[(0,e.jsx)(Z.Z,{width:"md",name:"name",label:"\u7CFB\u7EDF\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u7CFB\u7EDF\u540D\u79F0!"}]}),(0,e.jsx)(K.Z,{name:"description",label:"\u63CF\u8FF0\u4FE1\u606F",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7CFB\u7EDF\u63CF\u8FF0\u4FE1\u606F!"}],placeholder:"\u7CFB\u7EDF\u63CF\u8FF0\u4FE1\u606F"})]})}),(0,e.jsx)("div",{className:h().right,children:(0,e.jsx)(_,{})})]})})},ae=(0,E.Pi)(ee),te=t(2799),I=t.n(te),re=R.Z.Item,se=function(){var r=(0,C.a)(),o=r.isAdmin,c={base:"\u57FA\u672C\u8BBE\u7F6E",security:"\u5B89\u5168\u8BBE\u7F6E",appInfo:"\u7CFB\u7EDF\u8BBE\u7F6E"},s=(0,F.useState)({mode:"inline",selectKey:"base"}),u=(0,M.Z)(s,2),n=u[0],d=u[1],l=(0,F.useRef)(),v=function(){return Object.keys(c).filter(function(a){return!(a==="appInfo"&&!o)}).map(function(a){return(0,e.jsx)(re,{children:c[a]},a)})},f=function(){var a=n.selectKey;switch(a){case"base":return(0,e.jsx)(X,{});case"security":return(0,e.jsx)(q,{});case"notification":return(0,e.jsx)(Q,{});case"appInfo":return(0,e.jsx)(ae,{});default:return null}};return(0,e.jsx)(z.Z,{children:(0,e.jsxs)("div",{className:I().main,ref:function(a){a&&(l.current=a)},children:[(0,e.jsx)("div",{className:I().leftMenu,children:(0,e.jsx)(R.Z,{mode:n.mode,selectedKeys:[n.selectKey],onClick:function(a){var j=a.key;d((0,x.Z)((0,x.Z)({},n),{},{selectKey:j}))},children:v()})}),(0,e.jsxs)("div",{className:I().right,children:[(0,e.jsx)("div",{className:I().title,children:c[n.selectKey]}),f()]})]})})},ne=(0,E.Pi)(se)},16345:function(S){S.exports={baseView:"baseView___3sRG3",left:"left___GavW0",right:"right___3-EXe",avatar_title:"avatar_title___13ztg",avatar:"avatar___1GisI",button_view:"button_view___o9apF",area_code:"area_code___3Tg4d",phone_number:"phone_number___1bV0u"}},2799:function(S){S.exports={main:"main___2yGev",leftMenu:"leftMenu___179-W",right:"right___2jdGg",title:"title___3cGwa"}}}]);
