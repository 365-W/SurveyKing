(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6420],{96:function(At,ae,n){"use strict";n.r(ae),n.d(ae,{Overview:function(){return Ie},default:function(){return kt}});var se=n(93224),C=n(11849),D=n(94657),a=n(67294),Ne=n(51615),ke=n(69968),ie=n(8935),Fe=[{key:"answerDailyStat",i:"answerDailyStat",name:"answerDailyStat",title:"\u65E5\u6536\u96C6\u95EE\u5377",layouts:{md:{x:0,y:0,w:12,h:2,i:"answerDailyStat"},lg:{x:0,y:0,w:12,h:2,i:"answerDailyStat"}}},{key:"quickSetting",i:"quickSetting",name:"quickSetting",title:"\u7CFB\u7EDF\u8BBE\u7F6E",layouts:{md:{x:0,y:2,w:6,h:1,i:"quickSetting"},lg:{x:0,y:2,w:6,h:1,i:"quickSetting"}}}],De=Fe,Te=n(91512),Ee=n(68654),Ae=n(54549),Q=n(11628),p=n(3980),H=n(80937),Re=n(69610),Oe=n(27361),Pe=n.n(Oe),e=n(85893),we=function l(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,Re.Z)(this,l),this._registry=void 0,this.registerComponent=function(u,c){t._registry[u]=c},this.getComponent=function(u){return Pe()(t._registry,"".concat(u),function(c){return(0,e.jsxs)("div",{children:[u,"\u5BF9\u5E94\u7EC4\u4EF6\u672A\u6CE8\u518C"]})})},this._registry=r},pe=new we,G=pe,Rt=a.createContext({}),q=n(21063),re=n(18111),Ot=n(71194),le=n(50146),Pt=n(49111),oe=n(19650),wt=n(59250),ze=n(13013),pt=n(57663),M=n(71577),zt=n(30887),ue=n(28682),Bt=n(34792),U=n(48086),Mt=n(18106),ce=n(51752),_=n(11075),de=n(15873),ee=n(73218),ve=n(64072),Be=n(44545),Me=n(58491),Ue=n(57254),Le=n(98244),Ye=n(19357),Ut=n(87593),fe=n(37636),Lt=n(22385),Ve=n(94199),Yt=n(94233),te=n(51890),We=n(94184),he=n.n(We),He=n(89366),Ke={save:"blue",agree:"green",refuse:"red",reject:"red",revoke:"red",transfer:"red",todo:"orange"},W=function(t){return(0,e.jsx)(Ve.Z,{placement:"bottom",title:(0,e.jsxs)("div",{style:{textAlign:"center",fontSize:12},children:[t.name,(0,e.jsx)("br",{}),t.email]}),children:t.avatar?(0,e.jsx)(te.C,{src:"/api/public/preview/".concat(t.avatar),size:22}):(0,e.jsx)(te.C,{icon:(0,e.jsx)(He.Z,{}),size:22})})},be=function(t){var r=function(){if(t.approvalType==="save"){var c;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(c=t.auditUser)===null||c===void 0?void 0:c.name," \u53D1\u8D77\u65B0\u7684"]})}else if(t.approvalType==="agree"){var i;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(i=t.auditUser)===null||i===void 0?void 0:i.name," \u5BA1\u6279\u901A\u8FC7"]})}else if(t.approvalType==="todo"){var v,s;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(te.C.Group,{maxCount:3,children:(v=t.waitAuditUserList)===null||v===void 0?void 0:v.filter(function(I){return!!I}).map(function(I){return(0,a.createElement)(W,(0,C.Z)((0,C.Z)({},I),{},{key:I.userId}))})}),(s=t.waitAuditUserList)===null||s===void 0?void 0:s.length,"\u6210\u5458\u5904\u7406\u4E2D..."]})}else if(t.approvalType==="refuse"){var h;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(h=t.auditUser)===null||h===void 0?void 0:h.name," \u5BA1\u6279\u62D2\u7EDD"]})}else if(t.approvalType==="rollback"){var x;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(x=t.auditUser)===null||x===void 0?void 0:x.name," \u56DE\u9000\u81F3 ",t.newActivityName]})}else if(t.approvalType==="revert"){var y;return(0,e.jsxs)(e.Fragment,{children:[t.auditUser&&(0,e.jsx)(W,(0,C.Z)({},t.auditUser)),(y=t.auditUser)===null||y===void 0?void 0:y.name," \u64A4\u9500\u5904\u7406"]})}};return(0,e.jsxs)(fe.Z.Item,{color:Ke[t.approvalType]||"gray",children:[(0,e.jsx)("div",{className:"audit-time",children:t.createAt}),(0,e.jsxs)("div",{className:"record-item",children:[(0,e.jsx)("div",{className:"item-header",children:t.activityName}),(0,e.jsxs)("div",{className:"item-content",children:[(0,e.jsxs)("div",{className:"content-row",children:[(0,e.jsx)("span",{className:he()("action",t.approvalType),children:r()}),(0,e.jsx)("span",{})]}),t.comment&&(0,e.jsx)("div",{className:"content-row",children:(0,e.jsx)("span",{className:"comment",children:t.comment})})]})]})]},t.id)},Qe=function(t){var r=t.processInstanceId,u=(0,a.useState)(),c=(0,D.Z)(u,2),i=c[0],v=c[1];return(0,a.useEffect)(function(){p.hi.getAuditRecord(r).then(function(s){v(s)})},[r]),(0,a.useEffect)(function(){var s=document.getElementsByClassName("ant-tabs-content-holder");s.length>0&&(s[0].scrollTop=s[0].scrollHeight)},[i]),(0,e.jsx)(fe.Z,{className:"audit-timeline",children:i==null?void 0:i.map(function(s){return(0,a.createElement)(be,(0,C.Z)((0,C.Z)({},s),{},{key:s.id||s.activityId}))})})},Vt=n(47673),me=n(4107),Ge=me.Z.TextArea;function Je(l){var t=(0,a.useState)(),r=(0,D.Z)(t,2),u=r[0],c=r[1];return(0,e.jsxs)(le.Z,{visible:!0,title:"\u786E\u8BA4",onOk:function(){return l.onOk(u)},onCancel:l.onCancel,okButtonProps:l.buttonProps,children:[(0,e.jsx)("div",{style:{fontWeight:"bold",marginBottom:10},children:"\u5904\u7406\u53CD\u9988"}),(0,e.jsx)(Ge,{placeholder:"\u5728\u6B64\u5904\u8F93\u5165\u5904\u7406\u53CD\u9988\uFF0C\u53EF\u4E0D\u586B\u76F4\u63A5\u63D0\u4EA4",value:u,onChange:function(v){return c(v.target.value)}})]})}var ge=ce.Z.TabPane,Y="task-edit-modal",$e=(0,H.Pi)(function(l){var t=l.currentRecord,r=l.currIndex,u=l.total,c=l.onClose,i=l.onNav,v=l.taskType,s=(0,a.useState)(345),h=(0,D.Z)(s,2),x=h[0],y=h[1],I=(0,a.useRef)(null),A=(0,a.useState)(),z=(0,D.Z)(A,2),R=z[0],O=z[1],k=(0,a.useRef)(null),F=(0,a.useState)([]),j=(0,D.Z)(F,2),Z=j[0],T=j[1],d=(0,a.useState)(),m=(0,D.Z)(d,2),o=m[0],f=m[1];(0,a.useEffect)(function(){p.hi.loadFlowSchema({activityId:t.activityId,projectId:t.projectId}).then(function(E){return O(E)})},[t]);var B=(0,a.useState)(!1),X=(0,D.Z)(B,2),w=X[0],S=X[1];(0,a.useEffect)(function(){var E,P=t.answer,g=t.attachment;(E=k.current)===null||E===void 0||E.setValues(P,g)},[t]);var V=function(){return R?(0,e.jsx)(Ye.O,{ref:k,schema:R,headerVisible:!1,footerVisible:!1,paginationVisible:!1,initialValues:t.answer,fieldPermission:t.fieldPermission}):(0,e.jsx)(e.Fragment,{})},Ze=function(P){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i(P==="up"?r-1:r+1,g)},Ft=function(){return(0,e.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",overflow:"hidden"},children:(0,e.jsxs)(ce.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(ge,{tab:"\u65E5\u5FD7",children:(0,e.jsx)(Qe,{processInstanceId:t.processInstanceId})},"1"),(0,e.jsx)(ge,{tab:"\u7559\u8A00",children:"Content of Tab Pane 2"},"2")]})})},Dt=function(){return(0,e.jsx)(ue.Z,{onClick:function(g){var N,b=g.key;(N=k.current)===null||N===void 0||N.submit().then(function(L){L?f({visible:!0,buttonProps:{type:"ghost",icon:(0,e.jsx)(_.Z,{})},callback:function(Et){S(!0),p.hi.approvalTask({answer:L.values,attachment:L.attachments,answerId:t.answerId,taskId:t.id,type:"rollback",activityId:t.activityId,comment:Et,projectId:t.projectId,processInstanceId:t.processInstanceId,newActivityId:b}).then(function(){U.default.success("\u5DF2\u56DE\u9000"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:Z==null?void 0:Z.map(function(P,g){return(0,e.jsx)(ue.Z.Item,{children:(0,e.jsx)("a",{children:g!==Z.length-1?P.activityName:"\u53D1\u8D77\u4EBA"})},P.activityId)})})},Tt=function(){return(0,e.jsxs)(oe.Z,{children:[v===1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(M.Z,{type:"primary",loading:w,icon:(0,e.jsx)(de.Z,{}),onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(de.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"agree",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5BA1\u6838\u901A\u8FC7"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:"\u901A\u8FC7"}),(0,e.jsx)(M.Z,{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{}),loading:w,onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"refuse",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u62D2\u7EDD"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},children:"\u62D2\u7EDD"}),(0,e.jsx)(ze.Z,{overlay:Dt,placement:"topCenter",trigger:["click"],children:(0,e.jsx)(M.Z,{onClick:function(){p.hi.getRevertNodes(t.processInstanceId).then(function(g){g&&T(g)})},icon:(0,e.jsx)(_.Z,{}),loading:w,children:"\u56DE\u9000"})})]}),v===2&&t.status===1&&t.latest&&t.approvalType!=="revert"&&(0,e.jsx)(M.Z,{onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",danger:!0,icon:(0,e.jsx)(ee.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"revert",activityId:t.activityId,newActivityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u64A4\u56DE"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},icon:(0,e.jsx)(_.Z,{}),loading:w,children:"\u64A4\u56DE"}),v===4&&t.status===6&&(0,e.jsx)(M.Z,{onClick:function(){var g;(g=k.current)===null||g===void 0||g.submit().then(function(N){N?f({visible:!0,buttonProps:{type:"primary",icon:(0,e.jsx)(ve.Z,{})},callback:function(L){S(!0),p.hi.approvalTask({answer:N.values,attachment:N.attachments,answerId:t.answerId,taskId:t.id,type:"save",activityId:t.activityId,comment:L,projectId:t.projectId,processInstanceId:t.processInstanceId}).then(function(){U.default.success("\u5DF2\u64A4\u56DE"),S(!1),f(void 0),i(r,!0)})}}):S(!1)})},icon:(0,e.jsx)(ve.Z,{}),loading:w,children:"\u518D\u6B21\u63D0\u4EA4"}),(0,e.jsx)(M.Z,{onClick:function(){},icon:(0,e.jsx)(Be.Z,{}),loading:w})]})};return(0,e.jsx)("div",{ref:I,className:"edit-data ",children:(0,e.jsxs)(le.Z,{visible:!0,maskClosable:!1,title:!1,width:900,onCancel:function(){return c()},className:"task-edit-modal",footer:!1,children:[(0,e.jsxs)("div",{style:{display:"flex"},children:[(0,e.jsxs)("div",{className:Y+"-survey-container",style:{flex:1},children:[(0,e.jsx)("div",{className:Y+"-survey-container-title",children:"\u6211\u7684\u5BA1\u6279"}),(0,e.jsx)("div",{className:Y+"-survey-container-content",children:V()}),(0,e.jsxs)("div",{className:Y+"-survey-container-footer",children:[(0,e.jsxs)("div",{className:"nav",children:[(0,e.jsxs)("span",{children:[r+1,"/",u]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(M.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Me.Z,{}),disabled:r===0,onClick:function(){return Ze("up")}}),(0,e.jsx)(M.Z,{type:"text",shape:"circle",icon:(0,e.jsx)(Ue.Z,{}),disabled:r===u-1,onClick:function(){return Ze("down")}})]})]}),Tt()]})]}),(0,e.jsxs)("div",{className:Y+"-metaInfo-container",style:{width:x},children:[(0,e.jsx)("div",{className:Y+"-metaInfo-container-title"}),(0,e.jsx)("div",{className:Y+"-metaInfo-container-content",children:Ft()}),(0,e.jsx)("div",{className:Y+"-metaInfo-container-resizer",style:{transform:x===0?"rotateY(180deg) translate3d(100%,-50%,0)":"translate3d(0,-50%,0)"},onClick:function(){y(x===0?350:0)},children:(0,e.jsx)(Le.Z,{})})]})]}),(o==null?void 0:o.visible)&&(0,e.jsx)(Je,{onOk:function(P){return o.callback(P)},onCancel:function(){return f(void 0)},buttonProps:o.buttonProps})]})})}),Xe=(0,H.Pi)(function(l){var t=l.projectId,r=l.taskType,u=(0,a.useContext)(ne),c=(0,p.iZ)(t),i=(0,p.Ge)(t),v=(0,a.useRef)(),s=i.tasks[r]||{list:[],total:0,current:1,pageSize:50},h=(0,a.useState)(),x=(0,D.Z)(h,2),y=x[0],I=x[1],A=(0,a.useState)(),z=(0,D.Z)(A,2),R=z[0],O=z[1];(0,a.useEffect)(function(){var d=s.list.length;if(y===void 0){O(void 0);return}if(d===0){I(void 0);return}if(y>=d){I(0);return}y!==void 0&&s.current&&s.total&&O({currIndex:y,total:s.total,currentRecord:s.list[y]})},[y,s]);var k=function(m,o){i.loadFlowTasks({type:r,projectId:t,current:m,pageSize:o})};(0,a.useEffect)(function(){(r||y===void 0)&&k()},[r,y]);var F=c.schema,j=(0,a.useMemo)(function(){var d=(0,re.ZZ)(F)||[];return d.splice(0,0,{name:"approvalStage",title:"\u5F53\u524D\u6D41\u7A0B\u72B6\u6001",width:180}),d.push({name:"createUser",title:"\u7533\u8BF7\u4EBA"}),d.push({name:"createAt",title:"\u7533\u8BF7\u65F6\u95F4",width:180}),d.push({name:"updateAt",title:"\u66F4\u65B0\u65F6\u95F4",width:180}),d},[F]),Z=(0,a.useMemo)(function(){var d=(0,re.IR)(s.list,j);return d.forEach(function(m){var o;m.createUser=(o=m.createUser)===null||o===void 0?void 0:o.name}),d},[s,j]),T=function(m,o){R&&(o?i.removeTask(R.currentRecord.id,r):I(m))};return(0,e.jsxs)("div",{children:[(0,e.jsx)(q._$,{ref:v,width:u.width-10,height:u.height-95,data:Z,schema:j,selectionMode:"row",allowSorting:!0,onDoubleClick:function(m){var o;if(((o=m.data)===null||o===void 0?void 0:o._i)!==void 0){var f;I((f=m.data)===null||f===void 0?void 0:f._i)}}}),(0,e.jsxs)("div",{className:"statusBar-container",children:[(0,e.jsx)("div",{children:(0,e.jsx)("div",{style:{fontSize:12,color:"##767e89",userSelect:"none"},children:"\u53CC\u51FB\u884C\u5BA1\u6279"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)(q.tl,{current:s.current,pageSize:s.pageSize,total:s.total,onChange:function(m){k(m.current,m.pageSize)}}),(0,e.jsx)(q.hY,{onClick:function(){return k(s.current,s.pageSize)}})]}),(0,e.jsx)("div",{})]}),R&&(0,e.jsx)($e,(0,C.Z)((0,C.Z)({},R),{},{taskType:r,onClose:function(){I(void 0)},onNav:T}))]})}),qe=(0,H.Pi)(function(l){var t=(0,a.useContext)(Q.xI),r=(t==null?void 0:t.id)||l.projectId,u=(0,p.iZ)(r),c=Ct();return(0,a.useEffect)(function(){u.loadProject()},[u,r]),(0,e.jsx)("div",{style:{padding:"2px 5px"},className:"task-widget",children:(0,e.jsx)(Xe,{projectId:r,taskType:parseInt(c.activeKey||"0")})})});G.registerComponent("taskCenter",qe);var Wt=n(13062),ye=n(71230),Ht=n(77576),xe=n(12028),Kt=n(89032),J=n(15746),bt=n(20136),_e=n(55241),je=n(3182),et=n(94043),$=n.n(et),tt=n(23538),Se=n(92592),nt=me.Z.Search;function at(l){return"".concat(window.location.origin,"/s/").concat(l)}var st=function(){var t,r,u,c,i=(0,Q.IE)(),v=i.loading,s=(t=i.project)===null||t===void 0||(r=t.setting)===null||r===void 0?void 0:r.status,h=(0,a.useState)(s===1),x=(0,D.Z)(h,2),y=x[0],I=x[1],A=(u=i.project)===null||u===void 0||(c=u.setting)===null||c===void 0?void 0:c.answerSetting.autoSave,z=(0,a.useState)(A),R=(0,D.Z)(z,2),O=R[0],k=R[1];(0,a.useEffect)(function(){I(s===1)},[s]),(0,a.useEffect)(function(){k(A)},[A]);var F=at(i.id),j=(0,a.useState)(""),Z=(0,D.Z)(j,2),T=Z[0],d=Z[1];(0,a.useEffect)(function(){function o(){return f.apply(this,arguments)}function f(){return f=(0,je.Z)($().mark(function B(){return $().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:Se.toDataURL(F,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"}}).then(function(S){d(S)}).catch(function(S){console.error(S)});case 1:case"end":return w.stop()}},B)})),f.apply(this,arguments)}o()},[F]);var m=(0,a.useCallback)(function(){var o=(0,je.Z)($().mark(function f(B){return $().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:Se.toDataURL(F,{errorCorrectionLevel:"H",margin:1,color:{dark:"#010599FF",light:"#FFBF60FF"},width:B}).then(function(S){d(S);var V=document.createElement("a");V.href=S,V.setAttribute("download","".concat(i.name,"_").concat(B,".png")),document.body.appendChild(V),V.click(),document.body.removeChild(V)});case 1:case"end":return w.stop()}},f)}));return function(f){return o.apply(this,arguments)}}(),[F,i]);return(0,e.jsx)(ye.Z,{gutter:[20,20],style:{padding:10},children:(0,e.jsx)(J.Z,{sm:24,xs:24,children:(0,e.jsxs)(ye.Z,{gutter:[10,10],children:[(0,e.jsxs)(J.Z,{span:24,className:"setting-item",children:[(0,e.jsx)(nt,{value:F,style:{width:360},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(i.id))}}),(0,e.jsx)(_e.Z,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("img",{src:T,height:150,width:150}),(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(oe.Z,{children:[(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(256)},children:"\u5C0F\u53F7"}),(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(512)},children:"\u4E2D\u53F7"}),(0,e.jsx)(M.Z,{size:"small",type:"link",onClick:function(){return m(1024)},children:"\u5927\u53F7"})]})})]}),title:"".concat(i.name,"(\u4E8C\u7EF4\u7801)"),trigger:["click"],children:(0,e.jsx)(tt.Z,{style:{fontSize:30}})})]}),(0,e.jsxs)(J.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u5F00\u542F/\u505C\u6B62"}),(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:y,onChange:function(f){I(f),p.hi.updateSetting({id:i.id,settingKey:"status",settingValue:f?1:0}).then(function(B){B.code===200?f?U.default.info("\u95EE\u5377\u5DF2\u5F00\u542F"):U.default.warn("\u95EE\u5377\u5DF2\u505C\u6B62"):U.default.error(B.message)})}})})]}),(0,e.jsxs)(J.Z,{className:"setting-item",span:24,children:[(0,e.jsx)("div",{className:"title",children:"\u95EE\u5377\u586B\u5199\u65F6\u81EA\u52A8\u4FDD\u5B58"}),(0,e.jsx)("div",{children:(0,e.jsx)(xe.Z,{checked:O,onChange:function(f){k(f),p.hi.updateSetting({id:i.id,settingKey:"answerSetting.autoSave",settingValue:f}).then(function(B){B.code===200?f?U.default.info("\u6682\u5B58\u5DF2\u5F00\u542F"):U.default.warn("\u6682\u5B58\u5DF2\u505C\u6B62"):U.default.error(B.message)})}})})]})]})})})};G.registerComponent("quickSetting",(0,H.Pi)(st));var it=n(68023),rt=n(81615),lt=n(8690),ot=n(17813),ut=n(63294),ct=n(73865),dt=n(60532),vt=n(37744),ft=n(5931),ht=n(79813),mt=n(70012),gt=n(27484),K=n.n(gt),yt=n(37181),xt=n.n(yt);K().extend(xt()),it.D([lt.N,ot.N,ut.N,ct.N,ft.N,mt.N,ht.z,dt.N,vt.N]);var Ce=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=K()(),u=K().min(Object.keys(t).map(function(h){return K()(h,"YYYY-MM-DD")}).concat(r.add(-6,"day"))),c=[],i=[],v=u;!K()().add(1,"day").isSame(v,"day");v=v.add(1,"day")){var s=v.format("YYYY-MM-DD");c.push(s),i.push(t[s]||0)}return{dateList:c,data:i}},jt=function(t){var r=(0,Q.IE)(),u=r.reportData,c=(0,a.useRef)(),i=(0,a.useRef)(null);return(0,a.useEffect)(function(){if(i.current){var v=rt.S1(i.current);c.current=v;var s,h=Ce();s={visualMap:[{show:!1,type:"continuous",seriesIndex:0,min:0,max:400}],tooltip:{trigger:"axis"},xAxis:[{data:h.dateList}],dataZoom:[{type:"inside",startValue:"2022-05-03",endValue:"2022-05-08"},{start:0,end:20}],yAxis:[{}],series:[{type:"line",showSymbol:!1,smooth:!0,symbol:"none",areaStyle:{},data:h.data}]},s&&v.setOption(s),v.resize({height:t.height-30})}},[]),(0,a.useEffect)(function(){r.loadReportData()},[]),(0,a.useEffect)(function(){if(u&&c.current&&u.dailyCountStat){var v=Ce(u.dailyCountStat),s=v.dateList,h=v.data;c.current.setOption({xAxis:[{data:s}],series:[{data:h}]})}},[u]),(0,a.useEffect)(function(){c.current&&c.current.resize({height:t.height-30,width:t.width})},[t.width,t.height]),(0,e.jsx)("div",{ref:i,children:"AnswerDailyStat"})};G.registerComponent("answerDailyStat",(0,H.Pi)(jt));var St=function(t){var r=t.tabs,u=t.defaultActive,c=(0,a.useState)(u||r[0].key),i=(0,D.Z)(c,2),v=i[0],s=i[1],h=function(y){s(y),t.onChange(y)};return(0,e.jsx)("div",{className:"tabs-nav-list",children:r.map(function(x){return(0,e.jsx)("div",{onClick:function(){return h(x.key)},className:he()("tabs-tab",{active:v===x.key}),children:x.title},x.key)})})},ne=a.createContext({});function Ct(){return(0,a.useContext)(ne)}var It=a.forwardRef(function(l,t){var r=l.style,u=l.className,c=l.key,i=l.children,v=l.name,s=l.title,h=l.tabs,x=l.widgetProps,y=l.toggleFullScreen,I=(0,se.Z)(l,["style","className","key","children","name","title","tabs","widgetProps","toggleFullScreen"]),A=(0,a.useState)(h&&h[0].key),z=(0,D.Z)(A,2),R=z[0],O=z[1],k=(0,a.useState)(!1),F=(0,D.Z)(k,2),j=F[0],Z=F[1],T=function(){return h?(0,e.jsx)(St,{tabs:h,onChange:function(o){return O(o)}}):(0,e.jsx)("span",{className:"",children:s})};return(0,e.jsxs)("div",(0,C.Z)((0,C.Z)({style:(0,C.Z)({},r),className:["widget",u].join(" ")},I),{},{ref:t,children:[(0,e.jsxs)("div",{className:"header",children:[(0,e.jsxs)("span",{className:"title",children:[T(),(0,e.jsx)("div",{className:"drag-handle"})]}),(0,e.jsxs)("div",{className:"widget-controls",children:[j&&(0,e.jsx)(Te.Z,{className:"control-item",onClick:function(){Z(!1),y()}}),!j&&(0,e.jsx)(Ee.Z,{className:"control-item",onClick:function(){Z(!0),y()}}),(0,e.jsx)(Ae.Z,{className:"control-item"})]})]}),(0,e.jsx)(ie.SizeMe,{monitorHeight:!0,children:function(m){var o=m.size;return(0,e.jsx)(ne.Provider,{value:{height:o.height||0,width:o.width||0,activeKey:R},children:(0,e.jsx)("div",{style:{height:"100%"},children:a.createElement(G.getComponent(v),(0,C.Z)((0,C.Z)({},x),{},{height:o.height,width:o.width}))})})}}),i]}),c)}),Zt=It,Nt=n(78505),Ie=function(t){var r=(0,Ne.UO)(),u=r.id,c=(0,Q.IE)(),i=c.id,v=(0,a.useState)(function(){return De}),s=(0,D.Z)(v,2),h=s[0],x=s[1],y=(0,a.useState)(function(){var F=localStorage.getItem("layout-".concat(i));return F!=null?JSON.parse(F):h.reduce(function(j,Z){return j.lg.push(Z.layouts.lg),j.md.push(Z.layouts.md),j},{lg:[],md:[]})}),I=(0,D.Z)(y,2),A=I[0],z=I[1],R=(0,a.useRef)(0),O=(0,a.useRef)();if(u==="new")return(0,e.jsx)(Nt.default,(0,C.Z)({},t));var k=function(j){if(O.current)z(O.current.cacheLayouts),x(O.current.cacheData),O.current=void 0;else if(A){O.current={key:j,cacheData:h,cacheLayouts:A};var Z=Object.keys(A).reduce(function(T,d){var m=A[d].filter(function(o){return o.i===j})[0];return T[d]=[(0,C.Z)((0,C.Z)({},m),{},{x:0,y:0,h:(R.current-100)/150,i:j,statusbar:!0})],T},{});z(Z),x(h.filter(function(T){return T.key===j}))}};return(0,e.jsx)("div",{className:"survey-overview",children:(0,e.jsx)(ie.SizeMe,{monitorHeight:!0,children:function(j){var Z=j.size;return R.current=Z.height||0,(0,e.jsx)(ke.Responsive,{autoSize:!1,className:"layout",onDrag:function(d){},draggableHandle:".drag-handle",breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:12,sm:12,xs:4,xxs:2},width:Z.width||0,layouts:A,useCSSTransforms:!1,onLayoutChange:function(d,m){O.current||localStorage.setItem("layout-".concat(i),JSON.stringify(m))},children:h.map(function(T){var d=T.key,m=(0,se.Z)(T,["key"]);return(0,e.jsx)(Zt,(0,C.Z)((0,C.Z)({},m),{},{toggleFullScreen:function(){return k(d)}}),d)})})}})})},kt=Ie}}]);
