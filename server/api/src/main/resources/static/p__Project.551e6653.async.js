(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7562],{26788:function(Dn,M,t){"use strict";t.r(M),t.d(M,{Home:function(){return Q},default:function(){return jn}});var Tn=t(14781),$=t(58998),On=t(59250),P=t(13013),Fn=t(57663),Z=t(71577),In=t(13062),w=t(71230),Pn=t(89032),b=t(15746),Nn=t(88983),N=t(47933),d=t(11849),An=t(47673),z=t(4107),Bn=t(17462),q=t(76772),pn=t(30887),v=t(54689),O=t(2824),Mn=t(71194),U=t(50146),S=t(67294),_=t(15873),k=t(57119),nn=t(18401),tn=t(34707),K=t(49101),en=t(51615),L=t(2299),R=t(72706),on=t(70844),T=t(68489),zn=t(54421),A=t(38272),Un=t(58024),an=t(39144),kn=t(54029),J=t(79166),rn=t(86582),Kn=t(71153),F=t(60331),Ln=t(13254),V=t(14277),sn=t(8212),ln=t(92570),un=t(57820),cn=t(24616),G=t(44545),y=t(42285),n=t(85893),dn=(0,L.Pi)(function(h){var C=h.moreMenu,f=(0,T.ok)(),g=f.loading,m=f.projects,i={},c=function(e,r,s){e.stopPropagation(),s!=="more"&&y.m8.push("/survey/".concat(r.id,"/").concat(s,"?mode=").concat(r.mode||"survey"))};if(m.length===0)return(0,n.jsx)(V.Z,{image:V.Z.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:60},description:(0,n.jsx)("span",{children:"\u5F53\u524D\u8FD8\u6CA1\u6709\u521B\u5EFA\u95EE\u5377"})});var l=function(e){return e==="exam"?(0,n.jsx)(F.Z,{color:"red",children:"\u8003\u8BD5"}):(0,n.jsx)(F.Z,{color:"blue",children:"\u95EE\u5377"})};return(0,n.jsx)(A.ZP,{rowKey:"id",className:"survey-home-content",loading:g,grid:{gutter:16,xs:1,sm:2,md:3,lg:3,xl:4,xxl:4},dataSource:[i].concat((0,rn.Z)(m)),renderItem:function(e){return e&&e.id?(0,n.jsx)(A.ZP.Item,{children:(0,n.jsx)(an.Z,{onClick:function(){return y.m8.push("/survey/".concat(e.id,"?mode=").concat(e.mode||"survey"))},hoverable:!0,actions:[(0,n.jsx)(Z.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(sn.Z,{onClick:function(s){return c(s,e,"edit")}},"edit")}),(0,n.jsx)(Z.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(ln.Z,{onClick:function(s){return c(s,e,"data")}},"data")}),(0,n.jsx)(Z.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(un.Z,{onClick:function(s){return c(s,e,"report")}},"report")}),(0,n.jsx)(Z.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(cn.Z,{onClick:function(s){return c(s,e,"setting")}},"setting")}),(0,n.jsx)(Z.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(P.Z,{overlay:C(e),trigger:["click"],children:(0,n.jsx)(G.Z,{onClick:function(s){return c(s,e,"more")}},"ellipsis")})})],children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"title",children:[(0,n.jsx)("span",{children:e.name}),l(e.mode)]}),(0,n.jsxs)("div",{className:"content",children:[(0,n.jsx)("div",{className:"publish-status",children:e.setting.status===1?(0,n.jsx)(J.Z,{status:"processing",text:"\u6536\u96C6\u4E2D",className:"yes"}):(0,n.jsx)(J.Z,{status:"warning",text:"\u672A\u53D1\u5E03",className:"no"})}),(0,n.jsxs)("div",{className:"total",children:[(0,n.jsx)("span",{children:e.total}),"\u4EFD\u6570\u636E"]})]})]})})},e.id):(0,n.jsx)(A.ZP.Item,{children:(0,n.jsxs)(Z.Z,{type:"dashed",className:"newButton",onClick:function(){return y.m8.push("/survey/new")},children:[(0,n.jsx)(K.Z,{})," \u65B0\u589E\u95EE\u5377"]})})}})}),vn=dn,Rn=t(66456),mn=t(48995),fn=t(77613),xn=(0,fn.P)(function(h){var C=h.moreMenu,f=(0,T.ok)(),g=f.loading,m=f.projects,i=function(o,e){return{onClick:function(){e==="name"?y.m8.push("/survey/".concat(o.id,"/edit?mode=").concat(o.mode||"survey")):e==="total"?y.m8.push("/survey/".concat(o.id,"/data?mode=").concat(o.mode||"survey")):y.m8.push("/survey/".concat(o.id,"?mode=").concat(o.mode||"survey"))}}},c=[{title:"\u9879\u76EE\u540D\u79F0",dataIndex:"name",onCell:function(o){return i(o,"name")}},{title:"\u9879\u76EE\u72B6\u6001",dataIndex:"status",onCell:function(o){return i(o,"status")},render:function(o,e){var r=e.setting.status;return r===0?(0,n.jsx)(F.Z,{color:"warning",children:"\u672A\u5F00\u59CB"}):(0,n.jsx)(F.Z,{color:"processing",children:"\u6536\u96C6\u4E2D"})}},{title:"\u7C7B\u578B",dataIndex:"mode",render:function(o){return o==="exam"?"\u8003\u8BD5":"\u95EE\u5377"}},{title:"\u7B54\u5377\u6570",dataIndex:"total",onCell:function(o){return i(o,"total")}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createAt",onCell:function(o){return i(o,"createAt")}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateAt",onCell:function(o){return i(o,"updateAt")}},{title:"\u64CD\u4F5C",dataIndex:"operate",render:function(o,e){return(0,n.jsx)(P.Z,{overlay:C(e),trigger:["click"],children:(0,n.jsx)(G.Z,{},"ellipsis")})}}];return(0,n.jsx)("div",{children:(0,n.jsx)(mn.Z,{dataSource:m,loading:g,columns:c,rowKey:"id",pagination:!1,rowClassName:function(){return"project-list-row"}})})}),hn=xn,Jn=t(34792),H=t(48086),Vn=t(43185),Cn=t(11324),gn=t(43347),Zn=Cn.Z.Dragger,yn=function(C){var f=C.onCancel,g=(0,S.useState)(""),m=(0,O.Z)(g,2),i=m[0],c=m[1],l={multiple:!1,accept:".json",beforeUpload:function(e){var r=new FileReader;return r.readAsText(e,"UTF-8"),r.onload=function(s){try{var B=JSON.parse(s.target.result);c(B)}catch(p){H.default.error("\u6A21\u677F\u89E3\u6790\u5931\u8D25")}},r.onerror=function(){H.default.error("\u6A21\u677F\u8BFB\u53D6\u5931\u8D25")},!1}};return(0,n.jsx)(U.Z,{visible:!0,title:"\u901A\u8FC7 JSON \u5BFC\u5165\u95EE\u5377",okText:"\u5BFC\u5165",onOk:function(){setTimeout(function(){localStorage.setItem("temp-template",JSON.stringify(i)),y.m8.push("/survey/new?fromTemplate")},20)},onCancel:f,children:(0,n.jsxs)(Zn,(0,d.Z)((0,d.Z)({},l),{},{children:[(0,n.jsx)("p",{className:"ant-upload-drag-icon",children:(0,n.jsx)(gn.Z,{})}),(0,n.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u8005\u62D6\u62FD\u6A21\u677F\u6587\u4EF6\u5230\u6B64\u5904"})]}))})},I=U.Z.confirm,Y="home-content-type",Q=(0,L.Pi)(function(){var h=(0,T.ok)(),C=(0,S.useRef)(""),f=(0,S.useState)(localStorage.getItem(Y)||"card"),g=(0,O.Z)(f,2),m=g[0],i=g[1],c=(0,S.useState)({current:1,pageSize:11}),l=(0,O.Z)(c,2),o=l[0],e=l[1],r=(0,S.useState)(!1),s=(0,O.Z)(r,2),B=s[0],p=s[1],W=(0,en.k6)();(0,S.useEffect)(function(){h.loadProjects(o)},[o,h]);var X=function(a){return(0,n.jsxs)(v.Z,{onClick:function(D){return D.domEvent.stopPropagation()},children:[(0,n.jsx)(v.Z.Item,{onClick:function(){return window.open("/s/".concat(a.id))},children:"\u9884\u89C8"},"preview"),(0,n.jsx)(v.Z.Item,{onClick:function(){I({title:"\u95EE\u5377\u91CD\u547D\u540D",icon:void 0,content:(0,n.jsxs)("div",{children:[(0,n.jsx)(q.Z,{message:"\u95EE\u5377\u91CD\u547D\u540D\u6210\u529F\uFF0C\u7CFB\u7EDF\u5185\u5404\u5904\u5C06\u663E\u793A\u91CD\u547D\u540D\u6807\u9898\u3002\u6B64\u64CD\u4F5C\u4E0D\u5F71\u54CD\u516C\u5F00\u95EE\u5377\u540D\u79F0",type:"info",showIcon:!0}),(0,n.jsx)(z.Z,{style:{marginTop:10},onChange:function(x){return C.current=x.target.value},defaultValue:a.name})]}),okText:"\u786E\u8BA4",okType:"primary",cancelText:"\u53D6\u6D88",onOk:function(){new R.Uf(a.id).saveOrUpdateProject({name:C.current}).then(function(x){x.code===200&&e(function(E){return(0,d.Z)({},E)})})}})},children:"\u91CD\u547D\u540D"},"rename"),a.setting.status===0&&(0,n.jsx)(v.Z.Item,{onClick:function(){I({title:"\u786E\u5B9A\u53D1\u5E03\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(_.Z,{style:{color:"#1890ff"}}),content:"\u53EA\u6709\u53D1\u5E03\u7684\u95EE\u5377\u624D\u80FD\u6536\u96C6\u6570\u636E",okText:"\u53D1\u5E03",okType:"primary",cancelText:"\u53D6\u6D88",onOk:function(){T.hi.updateSetting({id:a.id,settingKey:"status",settingValue:1}).then(function(x){x.code===200&&e(function(E){return(0,d.Z)({},E)})})}})},children:"\u53D1\u5E03"},"publish"),a.setting.status===1&&(0,n.jsx)(v.Z.Item,{onClick:function(){I({title:"\u786E\u5B9A\u505C\u6B62\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(k.Z,{}),content:"\u505C\u6B62\u4E4B\u540E\u95EE\u5377\u5C06\u4E0D\u80FD\u7EE7\u7EED\u6536\u96C6\u6570\u636E",okText:"\u505C\u6B62",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){T.hi.updateSetting({id:a.id,settingKey:"status",settingValue:0}).then(function(x){x.code===200&&e(function(E){return(0,d.Z)({},E)})})}})},children:"\u505C\u6B62"},"stop"),(0,n.jsx)(v.Z.Item,{onClick:function(){I({title:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(k.Z,{}),content:"\u5220\u9664\u4E4B\u540E\u53EF\u4EE5\u5728\u56DE\u6536\u7AD9\u91CC\u9762\u627E\u56DE",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){new R.Uf(a.id).deleteProject(a.id).then(function(x){x.code===200&&e(function(E){return(0,d.Z)({},E)})})}})},children:"\u5220\u9664"},"delete")]})},En=function(){return m==="card"?(0,n.jsx)(vn,{moreMenu:X}):(0,n.jsx)(hn,{moreMenu:X})},Sn=(0,n.jsx)("div",{children:(0,n.jsx)(w.Z,{className:"survey-home-search",children:(0,n.jsxs)(b.Z,{span:24,children:[(0,n.jsxs)(N.ZP.Group,{value:m,onChange:function(a){i(a.target.value),localStorage.setItem(Y,a.target.value)},children:[(0,n.jsx)(N.ZP.Button,{value:"card",children:(0,n.jsx)(nn.Z,{})}),(0,n.jsx)(N.ZP.Button,{value:"list",children:(0,n.jsx)(tn.Z,{})})]}),(0,n.jsx)(z.Z.Search,{className:"search",placeholder:"\u641C\u7D22\u9879\u76EE\u540D\u79F0",onSearch:function(a){e(function(u){return(0,d.Z)((0,d.Z)({},u),{},{name:a})})}})]})})});return(0,n.jsxs)(on.ZP,{title:"\u6211\u7684\u95EE\u5377",content:Sn,extra:[(0,n.jsx)(P.Z,{trigger:["click"],overlay:(0,n.jsxs)(v.Z,{onClick:function(a){var u=a.key;u==="survey"?W.push("/survey/new"):u==="import"?p(!0):u==="exam"&&W.push("/survey/new?mode=exam")},children:[(0,n.jsx)(v.Z.Item,{children:(0,n.jsx)("a",{rel:"noopener noreferrer",href:"#",children:"\u95EE\u5377\u8C03\u67E5"})},"survey"),(0,n.jsx)(v.Z.Item,{children:(0,n.jsx)("a",{rel:"noopener noreferrer",href:"#",children:"\u5728\u7EBF\u8003\u8BD5"})},"exam"),(0,n.jsx)(v.Z.Item,{children:(0,n.jsx)("a",{rel:"noopener noreferrer",href:"#",children:"\u901A\u8FC7 JSON \u5BFC\u5165"})},"import")]}),placement:"bottomLeft",children:(0,n.jsx)(Z.Z,{type:"primary",icon:(0,n.jsx)(K.Z,{}),size:"large",style:{width:200},children:"\u65B0\u5EFA"},"add")},"add")],children:[(0,n.jsxs)("div",{className:"survey-home",children:[En(),(0,n.jsx)("div",{className:"pagination-container",children:(0,n.jsx)($.Z,{size:"small",current:o.current,pageSize:o.pageSize,total:h.total,showTotal:function(a){return"\u5171 ".concat(a," \u6761")},onChange:function(a){e(function(u){return(0,d.Z)((0,d.Z)({},u),{},{current:a})})}})})]}),B&&(0,n.jsx)(yn,{onCancel:function(){return p(!1)}})]})}),jn=Q}}]);
