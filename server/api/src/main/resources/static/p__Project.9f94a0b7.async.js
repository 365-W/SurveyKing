(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7562],{26788:function(Tn,B,t){"use strict";t.r(B),t.d(B,{Home:function(){return Q},default:function(){return jn}});var Dn=t(14781),X=t(58998),On=t(59250),I=t(13013),Fn=t(57663),g=t(71577),In=t(13062),$=t(71230),Pn=t(89032),w=t(15746),Nn=t(88983),P=t(47933),c=t(11849),pn=t(47673),M=t(4107),An=t(17462),b=t(76772),Bn=t(30887),v=t(54689),D=t(2824),Mn=t(71194),z=t(50146),E=t(67294),q=t(15873),U=t(57119),_=t(18401),nn=t(34707),k=t(49101),tn=t(51615),K=t(2299),L=t(72706),en=t(70844),T=t(68489),zn=t(54421),N=t(38272),Un=t(58024),an=t(39144),kn=t(54029),R=t(79166),on=t(86582),Kn=t(13254),J=t(14277),sn=t(8212),rn=t(92570),ln=t(57820),un=t(24616),V=t(44545),Z=t(42285),n=t(85893),cn=(0,K.Pi)(function(h){var x=h.moreMenu,m=(0,T.ok)(),C=m.loading,d=m.projects,u={},i=function(e,a,o){e.stopPropagation(),o!=="more"&&Z.m8.push("/survey/".concat(a.id,"/").concat(o))};return d.length===0?(0,n.jsx)(J.Z,{image:J.Z.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:60},description:(0,n.jsx)("span",{children:"\u5F53\u524D\u8FD8\u6CA1\u6709\u521B\u5EFA\u95EE\u5377"})}):(0,n.jsx)(N.ZP,{rowKey:"id",className:"survey-home-content",loading:C,grid:{gutter:16,xs:1,sm:2,md:3,lg:3,xl:4,xxl:4},dataSource:[u].concat((0,on.Z)(d)),renderItem:function(e){return e&&e.id?(0,n.jsx)(N.ZP.Item,{children:(0,n.jsx)(an.Z,{onClick:function(){return Z.m8.push("/survey/".concat(e.id))},hoverable:!0,actions:[(0,n.jsx)(g.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(sn.Z,{onClick:function(o){return i(o,e,"edit")}},"edit")}),(0,n.jsx)(g.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(rn.Z,{onClick:function(o){return i(o,e,"data")}},"data")}),(0,n.jsx)(g.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(ln.Z,{onClick:function(o){return i(o,e,"report")}},"report")}),(0,n.jsx)(g.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(un.Z,{onClick:function(o){return i(o,e,"setting")}},"setting")}),(0,n.jsx)(g.Z,{shape:"circle",size:"small",icon:(0,n.jsx)(I.Z,{overlay:x(e),trigger:["click"],children:(0,n.jsx)(V.Z,{onClick:function(o){return i(o,e,"more")}},"ellipsis")})})],children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"title",children:e.name}),(0,n.jsxs)("div",{className:"content",children:[(0,n.jsx)("div",{className:"publish-status",children:e.setting.status===1?(0,n.jsx)(R.Z,{status:"processing",text:"\u6536\u96C6\u4E2D",className:"yes"}):(0,n.jsx)(R.Z,{status:"warning",text:"\u672A\u53D1\u5E03",className:"no"})}),(0,n.jsxs)("div",{className:"total",children:[(0,n.jsx)("span",{children:e.total}),"\u4EFD\u6570\u636E"]})]})]})})},e.id):(0,n.jsx)(N.ZP.Item,{children:(0,n.jsxs)(g.Z,{type:"dashed",className:"newButton",onClick:function(){return Z.m8.push("/survey/new")},children:[(0,n.jsx)(k.Z,{})," \u65B0\u589E\u95EE\u5377"]})})}})}),dn=cn,Ln=t(66456),vn=t(48995),Rn=t(71153),G=t(60331),mn=t(77613),fn=(0,mn.P)(function(h){var x=h.moreMenu,m=(0,T.ok)(),C=m.loading,d=m.projects,u=function(e,a){return{onClick:function(){a==="name"?Z.m8.push("/survey/".concat(e.id,"/edit")):a==="total"?Z.m8.push("/survey/".concat(e.id,"/data")):Z.m8.push("/survey/".concat(e.id))}}},i=[{title:"\u9879\u76EE\u540D\u79F0",dataIndex:"name",onCell:function(e){return u(e,"name")}},{title:"\u9879\u76EE\u72B6\u6001",dataIndex:"status",onCell:function(e){return u(e,"status")},render:function(e,a){var o=a.setting.status;return o===0?(0,n.jsx)(G.Z,{color:"warning",children:"\u672A\u5F00\u59CB"}):(0,n.jsx)(G.Z,{color:"processing",children:"\u6536\u96C6\u4E2D"})}},{title:"\u7B54\u5377\u6570",dataIndex:"total",onCell:function(e){return u(e,"total")}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createAt",onCell:function(e){return u(e,"createAt")}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateAt",onCell:function(e){return u(e,"updateAt")}},{title:"\u64CD\u4F5C",dataIndex:"operate",render:function(e,a){return(0,n.jsx)(I.Z,{overlay:x(a),trigger:["click"],children:(0,n.jsx)(V.Z,{},"ellipsis")})}}];return(0,n.jsx)("div",{children:(0,n.jsx)(vn.Z,{dataSource:d,loading:C,columns:i,rowKey:"id",pagination:!1,rowClassName:function(){return"project-list-row"}})})}),hn=fn,Jn=t(34792),H=t(48086),Vn=t(43185),xn=t(11324),Cn=t(43347),gn=xn.Z.Dragger,Zn=function(x){var m=x.onCancel,C=(0,E.useState)(""),d=(0,D.Z)(C,2),u=d[0],i=d[1],r={multiple:!1,accept:".json",beforeUpload:function(a){var o=new FileReader;return o.readAsText(a,"UTF-8"),o.onload=function(F){try{var p=JSON.parse(F.target.result);i(p)}catch(A){H.default.error("\u6A21\u677F\u89E3\u6790\u5931\u8D25")}},o.onerror=function(){H.default.error("\u6A21\u677F\u8BFB\u53D6\u5931\u8D25")},!1}};return(0,n.jsx)(z.Z,{visible:!0,title:"\u901A\u8FC7 JSON \u5BFC\u5165\u95EE\u5377",okText:"\u5BFC\u5165",onOk:function(){setTimeout(function(){localStorage.setItem("temp-template",JSON.stringify(u)),Z.m8.push("/survey/new?fromTemplate")},20)},onCancel:m,children:(0,n.jsxs)(gn,(0,c.Z)((0,c.Z)({},r),{},{children:[(0,n.jsx)("p",{className:"ant-upload-drag-icon",children:(0,n.jsx)(Cn.Z,{})}),(0,n.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u8005\u62D6\u62FD\u6A21\u677F\u6587\u4EF6\u5230\u6B64\u5904"})]}))})},O=z.Z.confirm,Y="home-content-type",Q=(0,K.Pi)(function(){var h=(0,T.ok)(),x=(0,E.useRef)(""),m=(0,E.useState)(localStorage.getItem(Y)||"card"),C=(0,D.Z)(m,2),d=C[0],u=C[1],i=(0,E.useState)({current:1,pageSize:11}),r=(0,D.Z)(i,2),e=r[0],a=r[1],o=(0,E.useState)(!1),F=(0,D.Z)(o,2),p=F[0],A=F[1],yn=(0,tn.k6)();(0,E.useEffect)(function(){h.loadProjects(e)},[e,h]);var W=function(s){return(0,n.jsxs)(v.Z,{onClick:function(S){return S.domEvent.stopPropagation()},children:[(0,n.jsx)(v.Z.Item,{onClick:function(){return window.open("/s/".concat(s.id))},children:"\u9884\u89C8"},"preview"),(0,n.jsx)(v.Z.Item,{onClick:function(){O({title:"\u95EE\u5377\u91CD\u547D\u540D",icon:void 0,content:(0,n.jsxs)("div",{children:[(0,n.jsx)(b.Z,{message:"\u95EE\u5377\u91CD\u547D\u540D\u6210\u529F\uFF0C\u7CFB\u7EDF\u5185\u5404\u5904\u5C06\u663E\u793A\u91CD\u547D\u540D\u6807\u9898\u3002\u6B64\u64CD\u4F5C\u4E0D\u5F71\u54CD\u516C\u5F00\u95EE\u5377\u540D\u79F0",type:"info",showIcon:!0}),(0,n.jsx)(M.Z,{style:{marginTop:10},onChange:function(f){return x.current=f.target.value},defaultValue:s.name})]}),okText:"\u786E\u8BA4",okType:"primary",cancelText:"\u53D6\u6D88",onOk:function(){new L.Uf(s.id).saveOrUpdateProject({name:x.current}).then(function(f){f.code===200&&a(function(y){return(0,c.Z)({},y)})})}})},children:"\u91CD\u547D\u540D"},"rename"),s.setting.status===0&&(0,n.jsx)(v.Z.Item,{onClick:function(){O({title:"\u786E\u5B9A\u53D1\u5E03\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(q.Z,{style:{color:"#1890ff"}}),content:"\u53EA\u6709\u53D1\u5E03\u7684\u95EE\u5377\u624D\u80FD\u6536\u96C6\u6570\u636E",okText:"\u53D1\u5E03",okType:"primary",cancelText:"\u53D6\u6D88",onOk:function(){T.hi.updateSetting({id:s.id,settingKey:"status",settingValue:1}).then(function(f){f.code===200&&a(function(y){return(0,c.Z)({},y)})})}})},children:"\u53D1\u5E03"},"publish"),s.setting.status===1&&(0,n.jsx)(v.Z.Item,{onClick:function(){O({title:"\u786E\u5B9A\u505C\u6B62\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(U.Z,{}),content:"\u505C\u6B62\u4E4B\u540E\u95EE\u5377\u5C06\u4E0D\u80FD\u7EE7\u7EED\u6536\u96C6\u6570\u636E",okText:"\u505C\u6B62",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){T.hi.updateSetting({id:s.id,settingKey:"status",settingValue:0}).then(function(f){f.code===200&&a(function(y){return(0,c.Z)({},y)})})}})},children:"\u505C\u6B62"},"stop"),(0,n.jsx)(v.Z.Item,{onClick:function(){O({title:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u95EE\u5377?",icon:(0,n.jsx)(U.Z,{}),content:"\u5220\u9664\u4E4B\u540E\u53EF\u4EE5\u5728\u56DE\u6536\u7AD9\u91CC\u9762\u627E\u56DE",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:function(){new L.Uf(s.id).deleteProject(s.id).then(function(f){f.code===200&&a(function(y){return(0,c.Z)({},y)})})}})},children:"\u5220\u9664"},"delete")]})},En=function(){return d==="card"?(0,n.jsx)(dn,{moreMenu:W}):(0,n.jsx)(hn,{moreMenu:W})},Sn=(0,n.jsx)("div",{children:(0,n.jsx)($.Z,{className:"survey-home-search",children:(0,n.jsxs)(w.Z,{span:24,children:[(0,n.jsxs)(P.ZP.Group,{value:d,onChange:function(s){u(s.target.value),localStorage.setItem(Y,s.target.value)},children:[(0,n.jsx)(P.ZP.Button,{value:"card",children:(0,n.jsx)(_.Z,{})}),(0,n.jsx)(P.ZP.Button,{value:"list",children:(0,n.jsx)(nn.Z,{})})]}),(0,n.jsx)(M.Z.Search,{className:"search",placeholder:"\u641C\u7D22\u9879\u76EE\u540D\u79F0",onSearch:function(s){a(function(l){return(0,c.Z)((0,c.Z)({},l),{},{name:s})})}})]})})});return(0,n.jsxs)(en.ZP,{title:"\u6211\u7684\u95EE\u5377",content:Sn,extra:[(0,n.jsx)(I.Z,{trigger:["click"],overlay:(0,n.jsxs)(v.Z,{onClick:function(s){var l=s.key;l==="add"?yn.push("/survey/new"):l==="import"&&A(!0)},children:[(0,n.jsx)(v.Z.Item,{children:(0,n.jsx)("a",{rel:"noopener noreferrer",href:"#",children:"\u65B0\u5EFA\u95EE\u5377"})},"add"),(0,n.jsx)(v.Z.Item,{children:(0,n.jsx)("a",{rel:"noopener noreferrer",href:"#",children:"\u901A\u8FC7 JSON \u5BFC\u5165"})},"import")]}),placement:"bottomLeft",children:(0,n.jsx)(g.Z,{type:"primary",icon:(0,n.jsx)(k.Z,{}),size:"large",style:{width:200},children:"\u65B0\u5EFA"},"add")},"add")],children:[(0,n.jsxs)("div",{className:"survey-home",children:[En(),(0,n.jsx)("div",{className:"pagination-container",children:(0,n.jsx)(X.Z,{size:"small",current:e.current,pageSize:e.pageSize,total:h.total,showTotal:function(s){return"\u5171 ".concat(s," \u6761")},onChange:function(s){a(function(l){return(0,c.Z)((0,c.Z)({},l),{},{current:s})})}})})]}),p&&(0,n.jsx)(Zn,{onCancel:function(){return A(!1)}})]})}),jn=Q}}]);
