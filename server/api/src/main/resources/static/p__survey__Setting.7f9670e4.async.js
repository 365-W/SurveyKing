(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[1117],{92079:function(Se,G,t){"use strict";t.r(G),t.d(G,{Setting:function(){return Ze},default:function(){return Ft}});var ee=t(13062),b=t(71230),pe=t(89032),A=t(15746),ie=t(34792),V=t(48086),F=t(2299),m=t(67294),te=(0,m.createContext)({});function re(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=(0,m.useContext)(te),n=u.prefixCls;return n+o}var St=t(58024),K=t(39144),pt=t(22385),I=t(31097),Be=t(99008),O=t(84387),Bt=t(63185),e=t(85893),At=function(u){var n=u.children,s=_objectWithoutProperties(u,["children"]),i=function(a){return _jsx(_Checkbox,{checked:a.value,onChange:function(d){a.onChange(d.target.checked)},children:n})};return _jsx(Field,_objectSpread({component:[i]},s))},Pt=t(47673),Dt=function(u){var n=u.children,s=u.style,i=_objectWithoutProperties(u,["children","style"]),l=function(r){return _jsx(_Input,{value:r.value,style:s,onChange:function(v){r.onChange(v.target.value)},children:n})};return _jsx(Field,_objectSpread({component:[l]},i))},U=t(11849),Nt=t(71194),M=t(50146),It=t(57663),P=t(71577),Ot=t(77576),W=t(12028),B=t(2824),le=t(40520),z=t(54531),w=t(11628),Ae=function(u){var n=u.value,s=u.onChange,i=(0,m.useState)(!1),l=(0,B.Z)(i,2),a=l[0],r=l[1],d=(0,w.IE)(),v=(0,m.useRef)(null);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"setting-item",children:[(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u8BBE\u7F6E\u95EE\u5377\u9ED8\u8BA4\u7B54\u6848",(0,e.jsx)(I.Z,{overlay:"\u8BBE\u7F6E\u7684\u7B54\u6848\u5C06\u4F5C\u4E3A\u9ED8\u8BA4\u7B54\u6848\u5E26\u5165\u95EE\u5377",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(W.Z,{checked:!!n,onChange:function(h){h?r(!0):s(void 0)}})]}),(a||!!n)&&(0,e.jsx)("div",{className:"setting-item-content",children:(0,e.jsx)(P.Z,{onClick:function(){return r(!0)},style:{marginLeft:10},type:"dashed",children:n?"\u70B9\u51FB\u4FEE\u6539":"\u70B9\u51FB\u8BBE\u7F6E"})})]}),a&&(0,e.jsx)(M.Z,{visible:!0,onCancel:function(){return r(!1)},bodyStyle:{maxHeight:600,overflowY:"auto",padding:0},maskClosable:!1,width:650,onOk:function(){var h;s((0,z.ZN)((h=v.current)===null||h===void 0?void 0:h.getValues())),r(!1)},children:d.schema?(0,e.jsx)(le.Z,{ref:v,initialValues:n,schema:d.schema,footerVisible:!1,onSubmit:function(h){console.log(h)}}):"\u95EE\u5377\u4E3A\u7A7A"})]})},Pe=function(u){return(0,e.jsx)(F.gN,(0,U.Z)({component:[Ae]},u))},De=t(76039),Ne=function(u){var n=u.value,s=u.onChange,i=(0,m.useState)(!1),l=(0,B.Z)(i,2),a=l[0],r=l[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"setting-item",children:[(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u7B54\u9898\u5B8C\u6210\u540E\u8DF3\u8F6C\u81EA\u5B9A\u4E49\u9875\u9762",(0,e.jsx)(I.Z,{overlay:"\u4F60\u53EF\u4EE5\u5728\u8868\u5355\u63D0\u4EA4\u9875\u9762\u8BBE\u7F6E\u66F4\u4E3A\u4E30\u5BCC\u591A\u5F69\u7684\u5185\u5BB9\uFF0C\u5305\u62EC\u63D2\u5165\u56FE\u7247\u3001\u8BBE\u7F6E\u5B57\u53F7\u3001\u5B57\u4F53\u989C\u8272\u3001\u5E8F\u53F7\u3001\u8BBE\u7F6E\u8D85\u94FE\u63A5\u7B49\u7B49\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(W.Z,{checked:!!n,onChange:function(v){v?r(!0):s(void 0)}})]}),(a||!!n)&&(0,e.jsx)("div",{className:"setting-item-content",children:(0,e.jsx)(P.Z,{onClick:function(){return r(!0)},style:{marginLeft:10},type:"dashed",children:n?"\u70B9\u51FB\u4FEE\u6539":"\u70B9\u51FB\u8BBE\u7F6E"})})]}),a&&(0,e.jsx)(De.cM,{value:n,title:"\u63D0\u4EA4\u540E\u56FE\u6587\u5C55\u793A",width:750,onChange:function(v){s(v),r(!1)},onClose:function(){r(!1)}})]})},Ie=function(u){return(0,e.jsx)(F.gN,(0,U.Z)({component:[Ne]},u))},T=function(u){var n=function(i){return(0,e.jsx)(W.Z,{checked:i.value,onChange:function(a){i.onChange(a)}})};return(0,e.jsx)(F.gN,(0,U.Z)({component:[n]},u))},oe=t(93224),bt=t(77883),ce=t(85482),wt=t(43358),k=t(97268),Oe=function(u){var n=u.value,s=u.onChange,i=u.title,l=u.tooltip,a=(0,m.useState)(!!n),r=(0,B.Z)(a,2),d=r[0],v=r[1];return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"setting-item",children:[(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:[i,(0,e.jsx)(I.Z,{overlay:l,children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(W.Z,{checked:!!n,onChange:function(h){h?(v(!0),s({limitFreq:"only",limitNum:1})):(v(!1),s(void 0))}})]}),d&&(0,e.jsx)("div",{className:"setting-item-content",children:(0,e.jsxs)("div",{children:[(0,e.jsx)(k.Z,{style:{width:100},value:n==null?void 0:n.limitFreq,onChange:function(h){return s({limitFreq:h,limitNum:(n==null?void 0:n.limitNum)||1})},options:[{label:"\u53EA\u80FD",value:"only"},{label:"\u6BCF\u5C0F\u65F6",value:"hour"},{label:"\u6BCF\u5929",value:"day"},{label:"\u6BCF\u81EA\u7136\u5468",value:"week"},{label:"\u6BCF\u81EA\u7136\u6708",value:"month"},{label:"\u6BCF\u5B63\u5EA6",value:"quarter"},{label:"\u6BCF\u81EA\u7136\u5E74",value:"year"}]}),(0,e.jsx)("span",{style:{margin:"0 10px"},children:"\u7B54\u9898"}),(0,e.jsx)(ce.Z,{min:1,max:9999,defaultValue:1,value:n==null?void 0:n.limitNum,onChange:function(h){return s({limitNum:h,limitFreq:(n==null?void 0:n.limitFreq)||"only"})}}),(0,e.jsx)("span",{style:{margin:"0 10px"},children:"\u6B21"})]})})]})})},de=function(u){var n=u.name,s=u.basePath,i=(0,oe.Z)(u,["name","basePath"]);return(0,e.jsx)(F.gN,{component:[Oe,i],name:n,basePath:s})},ve=t(25782),be=t(69816),we=function(){var u=function(s){var i=s.value,l=s.onChange;return i===1?(0,e.jsx)(P.Z,{type:"primary",icon:(0,e.jsx)(ve.Z,{}),onClick:function(){return l(0)},children:"\u6B63\u5728\u56DE\u6536"}):(0,e.jsx)(P.Z,{type:"primary",danger:!0,icon:(0,e.jsx)(be.Z,{}),onClick:function(){return l(1)},children:"\u6682\u505C\u56DE\u6536"})};return(0,e.jsx)(F.gN,{name:"status",component:[u],basePath:""})},Lt=t(59250),Le=t(13013),Rt=t(30887),X=t(54689),J=t(3182),q=t(4107),Re=t(94043),L=t.n(Re),_=t(92592),$=t(86582),Vt=t(20136),Ve=t(55241),Ut=t(49111),Q=t(19650),Ue=t(54977),Te=t(23538),ke=t(73171),$e=t(71211),He=q.Z.Search;function Me(o){return"".concat(window.location.origin,"/s/").concat(o)}var We=function(u){var n=u.item,s=u.onChange,i=u.onDelete,l=(0,w.IE)(),a=n.url,r=(0,m.useState)(""),d=(0,B.Z)(r,2),v=d[0],x=d[1],h=(0,m.useRef)(null),E=(0,w.IE)(),g=(0,m.useState)(!1),Z=(0,B.Z)(g,2),D=Z[0],N=Z[1];(0,m.useEffect)(function(){function f(){return j.apply(this,arguments)}function j(){return j=(0,J.Z)(L().mark(function R(){return L().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:_.toDataURL(a,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:5}).then(function(S){x(S)}).catch(function(S){console.error(S)});case 1:case"end":return C.stop()}},R)})),j.apply(this,arguments)}f()},[a]);var y=(0,m.useCallback)(function(){var f=(0,J.Z)(L().mark(function j(R){return L().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:_.toDataURL(a,{errorCorrectionLevel:"H",margin:5,width:R}).then(function(S){x(S);var p=document.createElement("a");p.href=S,p.setAttribute("download","".concat(l.name,"_").concat(R,".png")),document.body.appendChild(p),p.click(),document.body.removeChild(p)});case 1:case"end":return C.stop()}},j)}));return function(j){return f.apply(this,arguments)}}(),[a,l]);return(0,e.jsxs)("div",{style:{border:"1px solid #d9d9d9",margin:"5px 0",padding:"8px 4px"},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)(q.Z,{value:n.name,style:{width:200},placeholder:"\u8BF7\u8F93\u5165\u6807\u9898",onChange:function(j){return s((0,U.Z)((0,U.Z)({},n),{},{name:j.target.value}))}}),(0,e.jsxs)(Q.Z,{children:[(0,e.jsx)(P.Z,{icon:(0,e.jsx)(Ue.Z,{}),onClick:function(){return N(!0)}}),(0,e.jsx)(Ve.Z,{content:(0,e.jsxs)("div",{children:[(0,e.jsx)("img",{src:v,height:150,width:150}),(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsxs)(Q.Z,{children:[(0,e.jsx)(P.Z,{size:"small",type:"link",onClick:function(){return y(256)},children:"\u5C0F\u53F7"}),(0,e.jsx)(P.Z,{size:"small",type:"link",onClick:function(){return y(512)},children:"\u4E2D\u53F7"}),(0,e.jsx)(P.Z,{size:"small",type:"link",onClick:function(){return y(1024)},children:"\u5927\u53F7"})]})})]}),title:"".concat(l.name,"(\u4E8C\u7EF4\u7801)"),trigger:["click"],children:(0,e.jsx)(P.Z,{icon:(0,e.jsx)(Te.Z,{})})}),(0,e.jsx)(P.Z,{icon:(0,e.jsx)(ke.Z,{}),onClick:function(){return i(n.id)}})]})]}),(0,e.jsx)(He,{value:a,style:{margin:"5px 0 0 0"},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(l.id,"?id=").concat(n.id))}}),(0,e.jsx)(M.Z,{visible:D,onCancel:function(){return N(!1)},bodyStyle:{maxHeight:600,overflowY:"auto",padding:0},maskClosable:!1,width:650,onOk:function(){var j;N(!1),console.log((0,z.ZN)((j=h.current)===null||j===void 0?void 0:j.getValues()))},children:E.schema&&(0,e.jsx)(le.Z,{ref:h,initialValues:n.value,schema:E.schema,footerVisible:!1,onSubmit:function(j){console.log(j)}})})]})},ze=function(u){var n=u.visible,s=u.onClose,i=(0,m.useState)([]),l=(0,B.Z)(i,2),a=l[0],r=l[1],d=(0,w.IE)();return(0,e.jsxs)(M.Z,{visible:n,onCancel:s,title:"\u5E26\u503C\u94FE\u63A5\u8BBE\u7F6E",maskClosable:!1,bodyStyle:{maxHeight:360,overflow:"auto"},children:[a.map(function(v){return(0,e.jsx)(We,{item:v,onChange:function(h){var E=a.findIndex(function(g){return g.id===h.id});a.splice(E,1,h),r((0,$.Z)(a))},onDelete:function(h){r((0,$.Z)(a.filter(function(E){return E.id!==h})))}},v.id)}),(0,e.jsx)(P.Z,{block:!0,type:"primary",ghost:!0,onClick:function(){var x=(0,$e.Ox)();a.push({id:x,url:"".concat(Me(d.id),"?id=").concat(x)}),r((0,$.Z)(a))},children:"\u6DFB\u52A0"})]})},Qe=q.Z.Search;function Ye(o){return"".concat(window.location.origin,"/s/").concat(o)}var Ge=function(){var u=(0,w.IE)(),n=Ye(u.id),s=(0,m.useState)(""),i=(0,B.Z)(s,2),l=i[0],a=i[1],r=(0,m.useState)(!1),d=(0,B.Z)(r,2),v=d[0],x=d[1];(0,m.useEffect)(function(){function g(){return Z.apply(this,arguments)}function Z(){return Z=(0,J.Z)(L().mark(function D(){return L().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:_.toDataURL(n,{errorCorrectionLevel:"H",type:"image/jpeg",quality:.3,margin:5}).then(function(f){a(f)}).catch(function(f){console.error(f)});case 1:case"end":return y.stop()}},D)})),Z.apply(this,arguments)}g()},[n]);var h=(0,m.useCallback)(function(){var g=(0,J.Z)(L().mark(function Z(D){return L().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:_.toDataURL(n,{errorCorrectionLevel:"H",margin:5,width:D}).then(function(f){a(f);var j=document.createElement("a");j.href=f,j.setAttribute("download","".concat(u.name,"_").concat(D,".png")),document.body.appendChild(j),j.click(),document.body.removeChild(j)});case 1:case"end":return y.stop()}},Z)}));return function(Z){return g.apply(this,arguments)}}(),[n,u]),E=(0,e.jsxs)(X.Z,{onClick:function(Z){return h(parseInt(Z.key))},children:[(0,e.jsx)(X.Z.Item,{children:"\u5C0F\u53F7"},256),(0,e.jsx)(X.Z.Item,{children:"\u4E2D\u53F7"},512),(0,e.jsx)(X.Z.Item,{children:"\u5927\u53F7"},1024)]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsx)("span",{children:"\u95EE\u5377\u94FE\u63A5"}),(0,e.jsx)(Qe,{value:n,style:{width:300},enterButton:"\u6253\u5F00",className:"open-target",onSearch:function(){window.open("/s/".concat(u.id))}})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:10},children:[(0,e.jsx)("div",{style:{border:"1px solid #e1e7f2",borderRadius:3,boxShadow:"0px 3px 8px 0px rgb(224 229 236 / 40%)",width:100,height:100},children:(0,e.jsx)("img",{src:l,height:95,width:95})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,e.jsx)(Le.Z,{overlay:E,placement:"bottomLeft",children:(0,e.jsx)(P.Z,{children:"\u4E0B\u8F7D\u4E8C\u7EF4\u7801"})}),(0,e.jsxs)(P.Z,{type:"primary",ghost:!0,style:{marginTop:10},onClick:function(){return x(!0)},children:["\u5E26\u503C\u94FE\u63A5",(0,e.jsx)(I.Z,{overlay:"\u94FE\u63A5\u6DFB\u52A0\u53C2\u6570\uFF0C\u5C06\u81EA\u52A8\u5E94\u7528\u4E3A\u95EE\u5377\u7684\u7B54\u6848\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt",style:{color:"#1891ff"}})})]})]}),(0,e.jsx)(ze,{visible:v,onClose:function(){return x(!1)}})]})]})},Tt=t(14965),Ke=t(77121),Xe=t(30381),Je=t.n(Xe),qe=function(u){var n=u.value,s=u.onChange,i=u.title,l=u.tooltip,a=u.type,r=a===void 0?"text":a,d=u.prefix,v=u.suffix,x=u.style,h=(0,m.useState)(n!==void 0),E=(0,B.Z)(h,2),g=E[0],Z=E[1];(0,m.useEffect)(function(){n!==void 0&&Z(!0)},[n]);var D=function(){return r==="datepicker"?(0,e.jsx)(Ke.Z,{value:n?Je()(n):void 0,showTime:!0,style:x,onChange:function(f){s(f?f==null?void 0:f.valueOf():void 0)}}):r==="number"?(0,e.jsx)(ce.Z,{value:n,onChange:function(f){return s(f)},style:(0,U.Z)({width:200},x)}):(0,e.jsx)(q.Z,{value:n,onChange:function(f){return s(f.target.value)},style:(0,U.Z)({width:200},x)})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"setting-item",children:[(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:[i,(0,e.jsx)(I.Z,{overlay:l,children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(W.Z,{checked:n!==void 0,onChange:function(y){y?(Z(!0),s("")):(Z(!1),s(void 0))}})]}),g&&(0,e.jsxs)("div",{className:"setting-item-content",children:[d,D(),v]})]})})},ne=function(u){var n=u.name,s=u.basePath,i=(0,oe.Z)(u,["name","basePath"]);return(0,e.jsx)(F.gN,{component:[qe,i],name:n,basePath:s})};V.default.config({duration:1,maxCount:1});var _e=(0,F.Pi)(function(){var o=(0,F.cI)();return(0,e.jsx)(F.RV,{form:o,children:(0,e.jsx)(F.Wo,{name:"answerSetting",children:(0,e.jsx)("div",{children:(0,e.jsxs)(K.Z,{title:(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)(Be.Z,{style:{marginRight:10}}),"\u95EE\u5377\u663E\u793A"]}),className:"answer-setting",extra:(0,e.jsx)(we,{}),children:[(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u5F00\u542F\u81EA\u52A8\u6682\u5B58",(0,e.jsx)(I.Z,{overlay:"\u52FE\u9009\u540E\uFF0C\u53EF\u4EE5\u81EA\u52A8\u4FDD\u5B58\u672C\u6B21\u672A\u63D0\u4EA4\u7684\u586B\u5199\u5185\u5BB9\uFF0C\u518D\u6B21\u6253\u5F00\u95EE\u5377\u53EF\u663E\u793A\u4E0A\u6B21\u672A\u63D0\u4EA4\u7684\u586B\u5199\u5185\u5BB9\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(T,{name:"autoSave"})]})}),(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u663E\u793A\u9898\u76EE\u5E8F\u53F7",(0,e.jsx)(I.Z,{overlay:"\u52FE\u9009\u540E\uFF0C\u95EE\u5377\u4E2D\u7684\u9898\u76EE\u4F1A\u6309\u6392\u5217\u987A\u5E8F\u4ECE1\u5F00\u59CB\u663E\u793A\u9898\u76EE\u5E8F\u53F7\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(T,{name:"questionNumber"})]})}),(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u663E\u793A\u8FDB\u5EA6\u6761",(0,e.jsx)(I.Z,{overlay:"\u52FE\u9009\u540E\uFF0C\u586B\u5199\u8005\u6ED1\u52A8\u9875\u9762\u53EF\u4EE5\u770B\u5230\u5F53\u524D\u95EE\u5377\u586B\u5199\u8FDB\u5EA6\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(T,{name:"progressBar"})]})}),(0,e.jsx)(Pe,{name:"initialValues"})]})})})})}),kt=t(54421),ue=t(38272),$t=t(94233),he=t(51890),Ht=t(71153),se=t(60331),Mt=t(48736),et=t(27049),Wt=t(62999),me=t(51753),zt=t(18106),xe=t(67164),H=t(68489),tt=t(60780),nt=t.n(tt),ut=t(49101),st=k.Z.Option,at=(0,F.Pi)(function(o){var u=o.onChange,n=o.orgTreeData,s=o.positions,i=(0,m.useState)(),l=(0,B.Z)(i,2),a=l[0],r=l[1],d=(0,m.useState)(),v=(0,B.Z)(d,2),x=v[0],h=v[1];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(b.Z,{gutter:10,children:[(0,e.jsx)(A.Z,{span:16,children:(0,e.jsx)(me.Z,{onChange:function(g){return r(g)},style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:[{title:"\u53D1\u8D77\u4EBA\u5F53\u524D\u90E8\u95E8",value:"${currentOrgId}",key:"${currentOrgId}"},{title:"\u53D1\u8D77\u4EBA\u4E0A\u7EA7\u90E8\u95E8",value:"${parentOrgId}",key:"${parentOrgId}"}].concat((0,$.Z)(n)),placeholder:"\u8BF7\u9009\u62E9\u673A\u6784",treeDefaultExpandAll:!0,allowClear:!0,value:a})}),(0,e.jsx)(A.Z,{span:8,children:(0,e.jsx)(k.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D",allowClear:!0,value:x,onChange:function(g){return h(g)},children:s.map(function(E){return(0,e.jsx)(st,{value:E.id,children:E.name},E.id)})})})]}),(0,e.jsx)(b.Z,{style:{marginTop:10},children:(0,e.jsx)(A.Z,{children:(0,e.jsx)(P.Z,{icon:(0,e.jsx)(ut.Z,{}),onClick:function(){(a||x)&&u("P:".concat(a||"",":").concat(x||""))},children:"\u6DFB\u52A0"})})})]})}),ae=xe.Z.TabPane,fe=k.Z.Option,it=(0,F.Pi)(function(o){var u=o.onChange,n=o.tabs,s=n===void 0?["user","role","position"]:n,i=(0,H.m2)(),l=(0,m.useState)(o.value||[]),a=(0,B.Z)(l,2),r=a[0],d=a[1];(0,m.useEffect)(function(){d(o.value||[])},[o.value]);var v=(0,H.LF)(r),x=i.depts,h=i.users,E=i.roles,g=i.positions,Z=(0,m.useState)(),D=(0,B.Z)(Z,2),N=D[0],y=D[1];(0,m.useEffect)(function(){N&&i.loadUsers({orgId:N,pageSize:1024})},[N,i]);var f=(0,m.useMemo)(function(){return nt()(x.map(function(c){return{value:c.id,title:c.name,key:c.id,parentId:c.parentId}}),{parentProperty:"parentId",customID:"value"})},[x]),j=function(C){var S=(0,$.Z)(r);C.forEach(function(p){S.includes(p)||S.push(p)}),d(S),u(S)},R=function(){for(var C=arguments.length,S=new Array(C),p=0;p<C;p++)S[p]=arguments[p];var Y=(0,$.Z)(r.filter(function(Fe){return!S.includes(Fe)}));d(Y),u(Y)};return(0,e.jsx)("div",{style:{width:400},children:(0,e.jsxs)(xe.Z,{defaultActiveKey:"user",children:[(0,e.jsx)(ae,{tab:"\u6210\u5458",disabled:!s.includes("user"),children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsxs)(b.Z,{gutter:20,children:[(0,e.jsx)(A.Z,{span:16,children:(0,e.jsx)(me.Z,{onChange:function(C){return y(C)},style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:f,placeholder:"\u8BF7\u9009\u62E9\u673A\u6784",treeDefaultExpandAll:!0,allowClear:!0})}),(0,e.jsx)(A.Z,{span:8,children:(0,e.jsx)(k.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u6210\u5458",allowClear:!0,showSearch:!0,mode:"multiple",onChange:function(C){return j(C)},maxTagCount:0,value:r.filter(function(c){return c.startsWith("U:")}),dropdownRender:function(C){return(0,e.jsxs)("div",{children:[C,(0,e.jsx)(et.Z,{style:{margin:"4px 0"}}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",padding:8},children:(0,e.jsx)(P.Z,{size:"small",type:"link",onClick:function(){return j(h.map(function(p){return"U:".concat(p.id)}))},children:"\u5168\u9009"})})]})},children:h.map(function(c){return(0,e.jsx)(fe,{value:"U:".concat(c.id),children:c.name},c.id)})})})]}),(0,e.jsx)(Q.Z,{style:{marginTop:20},wrap:!0,children:r.filter(function(c){return c.startsWith("U:")}).map(function(c){return(0,e.jsx)(se.Z,{closable:!0,color:"blue",onClose:function(){return R(c)},children:v.user[c.split(":")[1]]},c)})})]})},"user"),(0,e.jsx)(ae,{tab:"\u89D2\u8272",disabled:!s.includes("role"),children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsx)(k.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",allowClear:!0,showSearch:!0,mode:"multiple",value:r.filter(function(c){return c.startsWith("R:")}),onChange:function(C){return j(C)},maxTagCount:0,children:E.map(function(c){return(0,e.jsx)(fe,{value:"R:".concat(c.id),children:c.name},c.id)})}),(0,e.jsx)(Q.Z,{style:{marginTop:20},wrap:!0,children:r.filter(function(c){return c.startsWith("R:")}).map(function(c){return(0,e.jsx)(se.Z,{closable:!0,color:"blue",onClose:function(){return R(c)},children:v.role[c.split(":")[1]]},c)})})]})},"role"),(0,e.jsx)(ae,{tab:"\u673A\u6784\u5C97\u4F4D",disabled:!s.includes("position"),children:(0,e.jsxs)("div",{style:{height:400,overflowY:"auto",overflowX:"hidden"},children:[(0,e.jsx)(at,{positions:g,orgTreeData:f,onChange:function(C){return j([C])}}),(0,e.jsx)(Q.Z,{style:{marginTop:20},wrap:!0,children:r.filter(function(c){return c.startsWith("P:")}).map(function(c){var C=c.split(":"),S=(0,B.Z)(C,3),p=S[1],Y=S[2];return(0,e.jsxs)(se.Z,{closable:!0,color:"blue",onClose:function(){return R(c)},children:[v.org[p],"-",v.position[Y]]},p+":"+Y)})})]})},"position")]})})}),rt=it,lt=t(37809),ot=function(u){var n=(0,m.useState)([]),s=(0,B.Z)(n,2),i=s[0],l=s[1];return(0,e.jsx)(M.Z,{title:"\u8BBE\u7F6E\u534F\u4F5C\u7BA1\u7406\u5458",visible:!0,onCancel:u.onCancel,onOk:function(){return u.onOk(i)},children:(0,e.jsx)(rt,{tabs:["user"],onChange:function(r){l(r.map(function(d){return d.split(":")[1]}))}})})},ct=function(){var u=(0,w.IE)(),n=u.id,s=(0,m.useState)([]),i=(0,B.Z)(s,2),l=i[0],a=i[1],r=(0,m.useState)(!1),d=(0,B.Z)(r,2),v=d[0],x=d[1],h=function(){return H.hi.getProjectPartner(n).then(function(g){g&&a(g)})};return(0,m.useEffect)(function(){h()},[]),(0,e.jsxs)("div",{children:[(0,e.jsx)(K.Z,{className:"answer-setting",title:(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)(lt.Z,{}),(0,e.jsxs)("div",{children:["\u534F\u4F5C\u7BA1\u7406\u5458\u5217\u8868",(0,e.jsx)(I.Z,{overlay:"\u534F\u4F5C\u8005\u53EF\u4EE5\u534F\u52A9\u521B\u5EFA\u8005\u8FDB\u884C\u7F16\u8F91\u95EE\u5377\u3001\u7BA1\u7406\u6570\u636E\u7B49\u64CD\u4F5C\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt",style:{marginLeft:5}})})]})]}),extra:(0,e.jsx)("a",{href:"#",onClick:function(){return x(!0)},children:"\u8BBE\u7F6E\u534F\u4F5C\u7BA1\u7406\u5458"}),children:(0,e.jsx)(ue.ZP,{itemLayout:"horizontal",dataSource:l,renderItem:function(g){var Z,D;return(0,e.jsxs)(ue.ZP.Item,{actions:g.type!==1?[(0,e.jsx)("a",{onClick:function(){var y;M.Z.confirm({title:"\u5220\u9664\u534F\u4F5C\u8005",content:(0,e.jsxs)("div",{children:["\u786E\u5B9A\u5220\u9664\u534F\u4F5C\u8005 ",(0,e.jsx)("b",{children:(y=g.user)===null||y===void 0?void 0:y.name}),"\u5417\uFF1F"]}),onOk:function(){H.hi.deleteProjectPartner(g.id,n).then(function(j){j.success&&h()})}})},children:"\u5220\u9664"},"list-loadmore-edit")]:[],children:[(0,e.jsx)(ue.ZP.Item.Meta,{avatar:(0,e.jsx)(he.C,{src:(Z=g.user)!==null&&Z!==void 0&&Z.avatar?"/api/public/preview/".concat(g.user.avatar):""}),title:(D=g.user)===null||D===void 0?void 0:D.name}),(0,e.jsx)("div",{children:g.type===1?"\u521B\u5EFA\u8005":"\u534F\u4F5C\u8005"})]})}})}),v&&(0,e.jsx)(ot,{onCancel:function(){return x(!1)},onOk:function(g){H.hi.addProjectPartner({userIds:g,projectId:n}).then(function(){h(),x(!1)})}})]})},dt=t(56931),vt=(0,F.Pi)(function(){return(0,e.jsx)(F.Wo,{name:"submittedSetting",children:(0,e.jsx)("div",{children:(0,e.jsxs)(K.Z,{title:(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)(dt.Z,{}),"\u6295\u653E\u4E0E\u5206\u4EAB"]}),className:"submitted-setting",children:[(0,e.jsx)(Ie,{name:"contentHtml"}),(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsx)(Ge,{})}),(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u5141\u8BB8\u4FEE\u6539\u7B54\u6848",(0,e.jsx)(I.Z,{overlay:"\u52FE\u9009\u540E\uFF0C\u518D\u6B21\u6253\u5F00\u95EE\u5377\u4F1A\u56DE\u663E\u4E4B\u524D\u586B\u5199\u7684\u7B54\u6848\uFF0C\u5E76\u4E14\u53EF\u4EE5\u4FEE\u6539\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(T,{name:"enableUpdate"})]})})]})})})}),ge=t(1603);V.default.config({duration:1,maxCount:1});var ht=(0,F.Pi)(function(){return(0,e.jsx)("div",{children:(0,e.jsxs)(K.Z,{title:(0,e.jsxs)("div",{className:"setting-title",children:[(0,e.jsx)(ge.Z,{style:{marginRight:10}}),"\u56DE\u6536\u8BBE\u7F6E"]}),className:"answer-setting",children:[(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsxs)("span",{children:["\u9700\u8981\u767B\u5F55",(0,e.jsx)(I.Z,{overlay:"\u52FE\u9009\u540E\uFF0C\u53EA\u6709\u767B\u5F55\u7528\u6237\u624D\u53EF\u4EE5\u586B\u5199\u95EE\u5377\u3002",children:(0,e.jsx)(O.Z,{className:"setting-prompt"})})]}),(0,e.jsx)(T,{name:"loginRequired",basePath:"answerSetting"})]})}),(0,e.jsx)("div",{className:"setting-item",children:(0,e.jsxs)("div",{className:"setting-item-switch",children:[(0,e.jsx)("span",{children:"\u53EA\u80FD\u5FAE\u4FE1\u586B\u5199"}),(0,e.jsx)(T,{name:"wechatOnly",basePath:"answerSetting"})]})}),(0,e.jsx)(ne,{name:"password",basePath:"answerSetting",title:"\u51ED\u5BC6\u7801\u586B\u5199",tooltip:"\u53EA\u6709\u8F93\u5165\u5BC6\u7801\u624D\u80FD\u586B\u5199\u95EE\u5377"}),(0,e.jsx)(de,{name:"cookieLimit",basePath:"answerSetting",title:"\u6BCF\u53F0\u7535\u8111\u6216\u624B\u673A\u7B54\u9898\u6B21\u6570\u9650\u5236",tooltip:"\u6839\u636E cookie \u8FDB\u884C\u9650\u5236"}),(0,e.jsx)(de,{name:"ipLimit",basePath:"answerSetting",title:"\u6BCF\u4E2AIP\u7B54\u9898\u6B21\u6570\u9650\u5236",tooltip:"\u6839\u636E IP \u8FDB\u884C\u9650\u5236"}),(0,e.jsx)(ne,{name:"endTime",basePath:"answerSetting",title:"\u8BBE\u7F6E\u95EE\u5377\u7ED3\u675F\u65F6\u95F4",type:"datepicker"}),(0,e.jsx)(ne,{name:"maxAnswers",basePath:"answerSetting",title:"\u8BBE\u7F6E\u95EE\u5377\u56DE\u6536\u4E0A\u9650",type:"number",prefix:"\u56DE\u6536",suffix:"\u4EFD\u95EE\u5377\u540E\uFF0C\u505C\u6B62\u6536\u96C6",style:{width:80,margin:"0 5px"}})]})})}),je=t(64031),mt=(0,F.Pi)(function(){var o=re("-content"),u=(0,w.IE)(),n=u.setting,s=(0,m.useMemo)(function(){return(0,je.Np)({initialValues:u.setting,effects:function(){(0,je.ge)("*",function(l){console.log(l.address.toString(),l.value);var a={};l.path.forEach(function(r,d){var v={};d===l.path.length-1?a[r]=l.value:a[r]=v,a=v}),H.hi.updateSetting({id:u.id,settingKey:l.address.toString(),settingValue:l.value}).then(function(r){r.success&&V.default.info("\u4FDD\u5B58\u4E2D")})})}})},[]);return(0,m.useEffect)(function(){n&&(console.log(2222),s.setInitialValues(n))},[n,s]),(0,e.jsx)(F.RV,{form:s,children:(0,e.jsx)("div",{className:o,children:(0,e.jsxs)(b.Z,{gutter:[2,2],children:[(0,e.jsx)(A.Z,{xs:24,sm:8,xl:6,children:(0,e.jsx)(_e,{})}),(0,e.jsx)(A.Z,{xs:24,sm:8,xl:6,children:(0,e.jsx)(ht,{})}),(0,e.jsx)(A.Z,{xs:24,sm:8,xl:6,children:(0,e.jsx)(vt,{})}),(0,e.jsx)(A.Z,{xs:24,sm:8,xl:6,children:(0,e.jsx)(ct,{})})]})})})}),Qt=t(7359),Ce=t(27279),Ee=t(8212),xt=t(50206),ft=t(94184),gt=t.n(ft),ye=Ce.Z.Panel,jt=[{key:"answerSetting",title:"\u6570\u636E\u6536\u96C6\u8BBE\u7F6E",icon:(0,e.jsx)(Ee.Z,{}),description:"\u57FA\u672C\u7684\u95EE\u5377\u586B\u5199\u8BBE\u7F6E"},{key:"answerLimitSetting",title:"\u7B54\u9898\u9650\u5236",icon:(0,e.jsx)(Ee.Z,{}),description:"\u95EE\u5377\u7B54\u9898\u9650\u5236"},{key:"memberSetting",title:"\u534F\u540C\u7F16\u8F91",icon:(0,e.jsx)(xt.Z,{}),description:"\u8BBE\u7F6E\u534F\u4F5C\u7BA1\u7406\u5458"},{key:"submittedSetting",title:"\u63D0\u4EA4\u95EE\u5377\u6570\u636E\u540E",icon:(0,e.jsx)(ge.Z,{}),description:"\u95EE\u5377\u63D0\u4EA4\u5B8C\u6210\u9875\u9762\u8BBE\u7F6E"}],Yt=(0,F.Pi)(function(){var o=re("-nav"),u=(0,m.useContext)(te),n=u.settingStore,s=n.activePanel;return(0,e.jsx)("div",{className:o,children:(0,e.jsxs)(Ce.Z,{accordion:!0,expandIcon:function(l){var a=l.isActive;return(0,e.jsx)(ve.Z,{rotate:a?90:0})},defaultActiveKey:"1",children:[(0,e.jsx)(ye,{header:"\u57FA\u7840\u8BBE\u7F6E",style:{padding:0},children:jt.map(function(i){return(0,e.jsxs)(b.Z,{className:gt()("nav-panel-item",{active:s===i.key}),onClick:function(){return n.activePanel=i.key},children:[(0,e.jsx)(A.Z,{span:4,children:(0,e.jsx)(he.C,{icon:i.icon,shape:"square"})}),(0,e.jsx)(A.Z,{span:20,children:(0,e.jsxs)(b.Z,{children:[(0,e.jsx)(A.Z,{span:24,children:i.title}),(0,e.jsx)(A.Z,{span:24,style:{fontSize:12,color:"#8c8c8c"},children:i.description})]})})]},i.key)})},"1"),(0,e.jsx)(ye,{header:"\u9AD8\u7EA7\u8BBE\u7F6E",children:(0,e.jsx)("p",{children:"todo"})},"2")]})})}),Ct=t(69610),Et=t(54941),yt=function(){function o(u){(0,Ct.Z)(this,o),this.rootStore=void 0,this.activePanel=void 0,this.rootStore=u,this.activePanel="answerSetting",this.makeObservable()}return(0,Et.Z)(o,[{key:"makeObservable",value:function(){(0,z.Ou)(this,{rootStore:z.LO.ref,activePanel:z.LO.ref})}}]),o}(),Zt=t(77613),Ze=(0,Zt.P)(function(){var o=(0,w.IE)(),u=(0,m.useMemo)(function(){return new yt(o)},[o]);return(0,e.jsx)(te.Provider,{value:{prefixCls:"survey-setting",settingStore:u},children:(0,e.jsx)("div",{className:"survey-setting",children:(0,e.jsx)(mt,{})})})}),Ft=Ze},11628:function(Se,G,t){"use strict";t.d(G,{xI:function(){return b},Ge:function(){return ie},IE:function(){return A}});var ee=t(67294),b=(0,ee.createContext)({}),pe=b.Provider;function A(){var V=(0,ee.useContext)(b);return V.store}function ie(){var V=A();return V.flowStore}}}]);
