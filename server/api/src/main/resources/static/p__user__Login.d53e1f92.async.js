(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[9531],{34687:function(b){b.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",top:"top___1C1Zi",header:"header___5xZ3f",logo:"logo___2hXsy",title:"title___1-xuF",desc:"desc___-njyT",main:"main___x4OjT",icon:"icon___rzGKO",other:"other___lLyaU",register:"register___11Twg",prefixIcon:"prefixIcon___23Xrx"}},29791:function(b,T,e){"use strict";var ve=e(27400),U=e(87859),f=e(85893),M=void 0==="1";T.Z=function(){var u,$,re=(0,ve.a)(),X=re.system,ne=(u=X.setting)===null||u===void 0?void 0:u.copyright;return M?(0,f.jsx)(U.qc,{copyright:ne||!1,links:[{key:"recordNumber",title:($=X.setting)===null||$===void 0?void 0:$.recordNum,href:"https://beian.miit.gov.cn/",blankTarget:!0}]}):(0,f.jsx)(f.Fragment,{})}},88699:function(b,T,e){"use strict";e.r(T),e.d(T,{default:function(){return at}});var ve=e(34792),U=e(48086),f=e(39428),M=e(3182),u=e(94657),$=e(17462),re=e(76772),X=e(29791),ne=e(89366),We=e(2603),ie=e(82837),s=e(67294),B=e(42285),ze=e(73727),Pe=e(27400),Oe=e(80582),pt=e(71194),Fe=e(50146),Ae=e(59879),De=e(8812),He=e(81354),P=e.n(He),ge=function(n){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"XwKsGlMcdPMEhR1B",m=P().enc.Utf8.parse(j),l=P().enc.Utf8.parse(n),W=P().AES.encrypt(l,m,{mode:P().mode.ECB,padding:P().pad.Pkcs7});return W.toString()},he=e(3980),Ue=e(9669),$e=e.n(Ue),pe=$e().create({timeout:4e4,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json; charset=UTF-8"}});pe.interceptors.request.use(function(h){return h},function(h){Promise.reject(h)}),pe.interceptors.response.use(function(h){var n=h.data;return n});var Xe=function(n){return he.hi.post("/captcha/get",n)};function Ve(h){return oe.apply(this,arguments)}function oe(){return oe=(0,M.Z)((0,f.Z)().mark(function h(n){return(0,f.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",he.hi.post("/captcha/check",n));case 1:case"end":return m.stop()}},h)})),oe.apply(this,arguments)}var Ge=e(79743),Ke=e.n(Ge),t=e(85893),O={mode:"fixed",vSpace:5,imgSize:{width:"310px",height:"200px"},barSize:{width:"310px",height:"40px"},setSize:{imgHeight:"200px",imgWidth:"310px",barHeight:"40px",barWidth:"310px"},blockSize:{width:"40px",height:"40px"}},Ye=function(n){var j=O.vSpace,m=O.blockSize,l=O.setSize,W=O.imgSize,I=O.barSize,ce=n.isShow,F=n.captchaType,V=F===void 0?"blockPuzzle":F,G=n.transitionLeft,K=G===void 0?"":G,d=n.transitionWidth,z=d===void 0?"":d,le=n.verifyCaptcha,Y=(0,s.useState)(""),J=(0,u.Z)(Y,2),A=J[0],Q=J[1],q=(0,s.useState)(""),_=(0,u.Z)(q,2),ee=_[0],C=_[1],v=(0,s.useState)("#1890ff"),p=(0,u.Z)(v,2),i=p[0],w=p[1],g=(0,s.useState)(!1),L=(0,u.Z)(g,2),E=L[0],y=L[1],me=(0,s.useState)(!1),r=(0,u.Z)(me,2),st=r[0],de=r[1],rt=(0,s.useState)(""),ye=(0,u.Z)(rt,2),xe=ye[0],D=ye[1],nt=(0,s.useState)("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),Se=(0,u.Z)(nt,2),it=Se[0],je=Se[1],H=(0,s.useRef)(!1),Ce=(0,s.useRef)(0),R=(0,s.useRef)(0),ot=(0,s.useState)(0),we=(0,u.Z)(ot,2),ut=we[0],Ze=we[1],ct=(0,s.useState)(0),Be=(0,u.Z)(ct,2),lt=Be[0],Le=Be[1],fe=(0,s.useRef)(0),be=(0,s.useRef)(0),Me=(0,s.useRef)(""),Ie=(0,s.useRef)("");(0,s.useEffect)(function(){return dt(),Ee(),ft(),vt},[]);var dt=function(){for(var a=[],o="0123456789abcdef",x=0;x<36;x++)a[x]=o.substring(Math.floor(Math.random()*16),1);a[14]="4",a[19]=o.substring(Number(a[19])&3|8,1),a[8]=a[13]=a[18]=a[23]="-";var c="slider-".concat(a.join(""));localStorage.getItem("slider")||localStorage.setItem("slider",c)},ft=function(){window.addEventListener("touchmove",te),window.addEventListener("mousemove",te),window.addEventListener("touchend",ae),window.addEventListener("mouseup",ae)},vt=function(){window.removeEventListener("touchmove",te),window.removeEventListener("mousemove",te),window.removeEventListener("touchend",ae),window.removeEventListener("mouseup",ae)},Ee=function(){Xe({ts:Date.now(),captchaType:V,clientUid:localStorage.getItem("slider")}).then(function(a){if(a.success){var o=a.data||{},x=o.repCode,c=o.repData,N=o.repMsg,k=N===void 0?"":N;x==="0000"&&(Me.current=c.token,Ie.current=c.secretKey,Q(c.originalImageBase64),C(c.jigsawImageBase64)),x=="6201"&&(Q(""),C(""),de(!1),D(k),setTimeout(function(){D("")},1e3))}})},Re=function(a){a=a||window.event;var o=a.touches?a.touches[0].pageX:a.clientX;Ce.current=Math.floor(o-fe.current),E==!1&&(je(""),H.current=!0,w("#1890ff"),a.stopPropagation())},te=function(a){if(a=a||window.event,H.current&&E==!1){var o=a.touches?a.touches[0].pageX:a.clientX,x=fe.current,c=o-x,N=parseInt(m.width),k=parseInt("".concat(N/2)),se=be.current-k-2;c>=se&&(c=se),c<=24&&(c=k),R.current=c-Ce.current,Ze(R.current),Le(R.current)}},Ne=function(){Ee(),R.current=0,Ze(R.current),Le(R.current),je("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),w("#1890ff"),y(!1),H.current=!1},ae=function(){if(H.current&&E==!1){var a=Me.current,o=Ie.current,x=parseInt("".concat(R.current))*310/parseInt(l.imgWidth),c=JSON.stringify({x,y:5});Ve({captchaType:V,ts:Date.now(),token:a,pointJson:o?ge(c,o):c}).then(function(N){if(N.success){var k=N.data||{},se=k.repCode,ht=k.repMsg;if(se==="0000"){y(!0),de(!0),D("\u9A8C\u8BC1\u6210\u529F");var Te="".concat(a,"---").concat(c);ke(o?ge(Te,o):Te)}else y(!0),de(!1),w("#d9534f"),D(ht||"\u9A8C\u8BC1\u5931\u8D25");setTimeout(function(){Ne(),D("")},1e3)}}),H.current=!1}},gt=function(a){var o=a&&a.getBoundingClientRect().left,x=a&&a.offsetWidth;fe.current=o,be.current=x},ke=function(a){le(!1,a)};return(0,t.jsx)(Fe.Z,{title:"\u8BF7\u5B8C\u6210\u5B89\u5168\u9A8C\u8BC1",visible:ce,footer:!1,destroyOnClose:!0,keyboard:!1,maskClosable:!1,width:parseInt(W.width)+48,onCancel:function(){return ke()},bodyStyle:{padding:"12px 24px"},children:(0,t.jsx)("div",{className:"verifybox",children:(0,t.jsxs)("div",{style:{position:"relative"},className:"stop-user-select",children:[(0,t.jsx)("div",{className:"verify-img-out",style:{height:parseInt(l.imgHeight)+j},children:(0,t.jsxs)("div",{className:"verify-img-panel",style:{width:l.imgWidth,height:l.imgHeight},children:[(0,t.jsx)("div",{onClick:Ne,style:{height:32,width:32,lineHeight:"32px",borderRadius:32,backgroundColor:"rgb(0, 0, 0, 0.2)",textAlign:"center",position:"absolute",top:4,right:4},children:(0,t.jsx)(Ae.Z,{style:{color:"#fff",fontSize:"16px",fontWeight:800}})}),(0,t.jsx)("img",{alt:"",src:A?"data:image/png;base64,".concat(A):Ke(),style:{width:"100%",height:"100%",display:"block"}}),!!xe&&(0,t.jsx)("div",{className:"tips",children:(0,t.jsx)("span",{className:"verify-tips ".concat(st?"suc-bg":"err-bg"),children:xe})})]})}),(0,t.jsxs)("div",{className:"verify-bar-area",style:{width:l.imgWidth,height:I.height,lineHeight:I.height},ref:function(a){return gt(a)},children:[(0,t.jsx)("span",{className:"verify-msg",children:it}),(0,t.jsx)("div",{className:"verify-left-bar",style:{width:"".concat(ut,"px")||0,height:I.height,transition:z},children:(0,t.jsxs)("div",{onMouseDown:Re,onTouchStart:Re,className:"verify-move-block",style:{width:m.height,height:m.height,backgroundColor:i,left:"".concat(lt,"px"),transition:K},children:[(0,t.jsx)(De.Z,{style:{color:"#fff"}}),(0,t.jsx)("div",{className:"verify-sub-block",style:{width:"".concat(Math.floor(parseInt(l.imgWidth)*48/310),"px"),height:l.imgHeight,top:"-".concat(parseInt(l.imgHeight)+j,"px"),backgroundSize:"".concat(l.imgWidth," ").concat(l.imgHeight)},children:(0,t.jsx)("img",{alt:"",src:"data:image/png;base64,".concat(ee),style:{width:"100%",height:"100%",display:"block"}})})]})})]})]})})})},Je=Ye,Qe=e(5481),qe=e.n(Qe),_e=e(34687),S=e.n(_e),et=function(n){var j=n.content;return(0,t.jsx)(re.Z,{style:{marginBottom:24},message:j,type:"error",showIcon:!0})},ue=void 0==="1",mt=null,tt=function(n){var j,m=(0,s.useState)(!1),l=(0,u.Z)(m,2),W=l[0],I=l[1],ce=(0,s.useState)(),F=(0,u.Z)(ce,2),V=F[0],G=F[1],K=(0,Pe.a)(),d=K.system,z=(0,B.YB)(),le=function(){var C=(0,M.Z)((0,f.Z)().mark(function v(){return(0,f.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:case"end":return i.stop()}},v)}));return function(){return C.apply(this,arguments)}}(),Y=(0,s.useRef)(),J=(0,s.useState)(!1),A=(0,u.Z)(J,2),Q=A[0],q=A[1],_=function(){var C=(0,M.Z)((0,f.Z)().mark(function v(p,i){var w,g,L;return(0,f.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(q(p),w=Y.current.getFieldsValue(),g=w.username,L=w.password,!(g&&L&&i)){y.next=5;break}return y.next=5,ee({username:g,password:L,captchaVerification:i});case 5:I(!1);case 6:case"end":return y.stop()}},v)}));return function(p,i){return C.apply(this,arguments)}}(),ee=function(){var C=(0,M.Z)((0,f.Z)().mark(function v(p){var i,w,g,L,E,y;return(0,f.Z)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,K.login(p);case 3:if(i=r.sent,!i.success){r.next=18;break}if(w=z.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),U.default.success(w),!n.onOk){r.next=10;break}return n.onOk(),r.abrupt("return");case 10:return r.next=12,le();case 12:if(B.m8){r.next=14;break}return r.abrupt("return");case 14:return g=B.m8.location.query,L=g,E=L.redirect,B.m8.push(E||"/"),r.abrupt("return");case 18:G(i.message&&"error"),r.next=25;break;case 21:r.prev=21,r.t0=r.catch(0),y=z.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),U.default.error(y);case 25:I(!1);case 26:case"end":return r.stop()}},v,null,[[0,21]])}));return function(p){return C.apply(this,arguments)}}();return(0,t.jsxs)("div",{className:S().container,children:[(0,t.jsx)("div",{className:S().lang,"data-lang":!0,children:B.pD&&(0,t.jsx)(B.pD,{})}),(0,t.jsxs)("div",{className:S().content,children:[(0,t.jsxs)("div",{className:S().top,children:[(0,t.jsxs)("div",{className:S().header,children:[(0,t.jsx)("img",{alt:"logo",className:S().logo,src:d.avatar?"/api/public/preview/".concat(d==null?void 0:d.avatar):qe()}),(0,t.jsx)("span",{className:S().title,children:d==null?void 0:d.name})]}),(0,t.jsx)("div",{className:S().desc,children:d==null?void 0:d.description})]}),(0,t.jsx)("div",{className:S().main,children:(0,t.jsxs)(ie.ZP,{formRef:Y,initialValues:ue?{autoLogin:!0,username:"admin",password:"123456"}:{autoLogin:!0},submitter:{searchConfig:{submitText:z.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})},render:function(v,p){return p.pop()},submitButtonProps:{loading:W,size:"large",style:{width:"100%"},htmlType:"submit"}},isKeyPressSubmit:!0,onFinish:function(){var C=(0,M.Z)((0,f.Z)().mark(function v(p){var i;return(0,f.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!W){g.next=2;break}return g.abrupt("return");case 2:(i=d.setting)!==null&&i!==void 0&&i.captchaEnabled?q(!0):ee(p),I(!0);case 4:case"end":return g.stop()}},v)}));return function(v){return C.apply(this,arguments)}}(),children:[V==="error"&&(0,t.jsx)(et,{content:z.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,t.jsx)(ie.V,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(ne.Z,{className:S().prefixIcon})},placeholder:ue?"\u7528\u6237\u540D(admin)":"\u7528\u6237\u540D",rules:[{required:!0,message:(0,t.jsx)(B._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(ie.V.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(We.Z,{className:S().prefixIcon})},placeholder:ue?"\u5BC6\u7801(123456)":"\u5BC6\u7801",rules:[{required:!0,message:(0,t.jsx)(B._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),((j=d.registerInfo)===null||j===void 0?void 0:j.registerEnabled)&&(0,t.jsx)("div",{style:{marginBottom:24,display:"flex",justifyContent:"flex-end"},children:(0,t.jsx)(ze.rU,{to:"/user/register",children:(0,t.jsx)(B._H,{id:"pages.login.registerAccount",defaultMessage:"\u6CE8\u518C"})})})]})})]}),(0,t.jsx)(Je,{isShow:Q,verifyCaptcha:_}),(0,t.jsx)(X.Z,{})]})},at=(0,Oe.Pi)(tt)},5481:function(b,T,e){b.exports=e.p+"static/logo.eaa834e3.svg"},79743:function(b,T,e){b.exports=e.p+"static/default.aac93cd7.jpg"},42480:function(){}}]);
