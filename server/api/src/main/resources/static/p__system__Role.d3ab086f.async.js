(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[7905],{1145:function(ht,ee,x){"use strict";x.r(ee),x.d(ee,{default:function(){return ut}});var vt=x(57663),De=x(71577),M=x(39428),te=x(3182),pt=x(71194),Ee=x(50146),gt=x(34792),U=x(48086),be=x(94657),ne=x(3980),Se=x(57119),Ze=x(49101),Te=x(87859),Pe=x(91186),re=x(80582),P=x(67294),A=x(93224),m=x(11849),T=x(32059),B=x(69610),W=x(54941),S=x(3372),z=x(43028),V=x(15818),Le=x(94184),L=x.n(Le),R=x(45598),oe=P.createContext(null),Oe=x(45916),y=x(85893),je=["className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","expanded","selected","checked","halfChecked"],ae="open",se="close",$e="---",Ie=function(c){(0,z.Z)(l,c);var i=(0,V.Z)(l);function l(){var e;(0,B.Z)(this,l);for(var a=arguments.length,v=new Array(a),s=0;s<a;s++)v[s]=arguments[s];return e=i.call.apply(i,[this].concat(v)),e.state={dragNodeHighlight:!1},e.selectHandle=void 0,e.onSelectorClick=function(t){var n=e.props.context.onNodeClick;n(t,(0,S.Z)(e)),e.isSelectable()?e.onSelect(t):e.onCheck(t)},e.onSelectorDoubleClick=function(t){var n=e.props.context.onNodeDoubleClick;n(t,(0,S.Z)(e))},e.onSelect=function(t){if(!e.isDisabled()){var n=e.props.context.onNodeSelect;t.preventDefault(),n(t,(0,S.Z)(e))}},e.onCheck=function(t){if(!e.isDisabled()){var n=e.props,r=n.disableCheckbox,d=n.checked,o=e.props.context.onNodeCheck;if(!(!e.isCheckable()||r)){t.preventDefault();var f=!d;o(t,(0,S.Z)(e),f)}}},e.onMouseEnter=function(t){var n=e.props.context.onNodeMouseEnter;n(t,(0,S.Z)(e))},e.onMouseLeave=function(t){var n=e.props.context.onNodeMouseLeave;n(t,(0,S.Z)(e))},e.onContextMenu=function(t){var n=e.props.context.onNodeContextMenu;n(t,(0,S.Z)(e))},e.onDragStart=function(t){var n=e.props.context.onNodeDragStart;t.stopPropagation(),e.setState({dragNodeHighlight:!0}),n(t,(0,S.Z)(e));try{t.dataTransfer.setData("text/plain","")}catch(r){}},e.onDragEnter=function(t){var n=e.props.context.onNodeDragEnter;t.preventDefault(),t.stopPropagation(),n(t,(0,S.Z)(e))},e.onDragOver=function(t){var n=e.props.context.onNodeDragOver;t.preventDefault(),t.stopPropagation(),n(t,(0,S.Z)(e))},e.onDragLeave=function(t){var n=e.props.context.onNodeDragLeave;t.stopPropagation(),n(t,(0,S.Z)(e))},e.onDragEnd=function(t){var n=e.props.context.onNodeDragEnd;t.stopPropagation(),e.setState({dragNodeHighlight:!1}),n(t,(0,S.Z)(e))},e.onDrop=function(t){var n=e.props.context.onNodeDrop;t.preventDefault(),t.stopPropagation(),e.setState({dragNodeHighlight:!1}),n(t,(0,S.Z)(e))},e.onExpand=function(t){var n=e.props.context.onNodeExpand;n(t,(0,S.Z)(e))},e.setSelectHandle=function(t){e.selectHandle=t},e.getNodeChildren=function(){var t=e.props.children,n=(0,R.Z)(t).filter(function(d){return d}),r=le(n);return n.length!==r.length&&de(),r},e.getNodeState=function(){var t=e.props.expanded;return e.isLeaf()?null:t?ae:se},e.isLeaf=function(){var t=e.props,n=t.isLeaf,r=t.loaded,d=e.props.context.loadData,o=e.getNodeChildren().length!==0;return n===!1?!1:n||!d&&!o||d&&r&&!o},e.isDisabled=function(){var t=e.props.disabled,n=e.props.context.disabled;return t===!1?!1:!!(n||t)},e.isCheckable=function(){var t=e.props.checkable,n=e.props.context.checkable;return!n||t===!1?!1:n},e.syncLoadData=function(t){var n=t.expanded,r=t.loading,d=t.loaded,o=e.props.context,f=o.loadData,h=o.onNodeLoad;if(!r&&f&&n&&!e.isLeaf()){var u=e.getNodeChildren().length!==0;!u&&!d&&h((0,S.Z)(e))}},e.renderSwitcher=function(){var t=e.props,n=t.expanded,r=t.switcherIcon,d=e.props.context,o=d.prefixCls,f=d.switcherIcon,h=r||f;if(e.isLeaf())return(0,y.jsx)("span",{className:L()("".concat(o,"-switcher"),"".concat(o,"-switcher-noop")),children:typeof h=="function"?h((0,m.Z)((0,m.Z)({},e.props),{},{isLeaf:!0})):h});var u=L()("".concat(o,"-switcher"),"".concat(o,"-switcher_").concat(n?ae:se));return(0,y.jsx)("span",{onClick:e.onExpand,className:u,children:typeof h=="function"?h((0,m.Z)((0,m.Z)({},e.props),{},{isLeaf:!1})):h})},e.renderCheckbox=function(){var t=e.props,n=t.checked,r=t.halfChecked,d=t.disableCheckbox,o=e.props.context.prefixCls,f=e.isDisabled(),h=e.isCheckable();if(!h)return null;var u=typeof h!="boolean"?h:null;return(0,y.jsx)("span",{className:L()("".concat(o,"-checkbox"),n&&"".concat(o,"-checkbox-checked"),!n&&r&&"".concat(o,"-checkbox-indeterminate"),(f||d)&&"".concat(o,"-checkbox-disabled")),onClick:e.onCheck,children:u})},e.renderIcon=function(){var t=e.props.loading,n=e.props.context.prefixCls;return(0,y.jsx)("span",{className:L()("".concat(n,"-iconEle"),"".concat(n,"-icon__").concat(e.getNodeState()||"docu"),t&&"".concat(n,"-icon_loading"))})},e.renderSelector=function(){var t=e.state.dragNodeHighlight,n=e.props,r=n.title,d=n.selected,o=n.icon,f=n.loading,h=e.props.context,u=h.prefixCls,p=h.showIcon,C=h.icon,N=h.draggable,k=h.loadData,g=e.isDisabled(),K="".concat(u,"-node-content-wrapper"),D;if(p){var b=o||C;D=b?(0,y.jsx)("span",{className:L()("".concat(u,"-iconEle"),"".concat(u,"-icon__customize")),children:typeof b=="function"?b(e.props):b}):e.renderIcon()}else k&&f&&(D=e.renderIcon());var Z=(0,y.jsx)("span",{className:"".concat(u,"-title"),children:r});return(0,y.jsxs)("span",{ref:e.setSelectHandle,title:typeof r=="string"?r:"",className:L()("".concat(K),"".concat(K,"-").concat(e.getNodeState()||"normal"),!g&&(d||t)&&"".concat(u,"-node-selected"),!g&&N&&"draggable"),draggable:!g&&N||void 0,"aria-grabbed":!g&&N||void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onContextMenu:e.onContextMenu,onClick:e.onSelectorClick,onDoubleClick:e.onSelectorDoubleClick,onDragStart:N?e.onDragStart:void 0,children:[D,Z]})},e.renderChildren=function(){var t=e.props,n=t.expanded,r=t.pos,d=e.props.context,o=d.prefixCls,f=d.motion,h=d.renderTreeNode,u=e.getNodeChildren();if(u.length===0)return null;var p=!0;return u.forEach(function(C){C.props.children.length>0&&(p=!1)}),(0,y.jsx)(Oe.ZP,(0,m.Z)((0,m.Z)({visible:n},f),{},{children:function(N){var k=N.style,g=N.className;return(0,y.jsx)("ul",{className:L()(g,"".concat(o,"-child-tree"),n&&"".concat(o,"-child-tree-open")),style:(0,m.Z)((0,m.Z)({},k),{},{display:p?"flex":""}),"data-expanded":n,role:"group",children:fe(u,function(K,D){return h(K,D,r)})})}}))},e}return(0,W.Z)(l,[{key:"componentDidMount",value:function(){var a=this.props,v=a.eventKey,s=a.context.registerTreeNode;this.syncLoadData(this.props),s(v,this)}},{key:"componentDidUpdate",value:function(){this.syncLoadData(this.props)}},{key:"componentWillUnmount",value:function(){var a=this.props,v=a.eventKey,s=a.context.registerTreeNode;s(v,null)}},{key:"isSelectable",value:function(){var a=this.props.selectable,v=this.props.context.selectable;return typeof a=="boolean"?a:v}},{key:"render",value:function(){var a,v=this.props.loading,s=this.props,t=s.className,n=s.style,r=s.dragOver,d=s.dragOverGapTop,o=s.dragOverGapBottom,f=s.isLeaf,h=s.expanded,u=s.selected,p=s.checked,C=s.halfChecked,N=(0,A.Z)(s,je),k=this.props.context,g=k.prefixCls,K=k.filterTreeNode,D=k.draggable,b=this.isDisabled(),Z=Ne(N);return(0,y.jsxs)("li",(0,m.Z)((0,m.Z)({className:L()(t,(a={},(0,T.Z)(a,"".concat(g,"-treenode-disabled"),b),(0,T.Z)(a,"".concat(g,"-treenode-switcher-").concat(h?"open":"close"),!f),(0,T.Z)(a,"".concat(g,"-treenode-checkbox-checked"),p),(0,T.Z)(a,"".concat(g,"-treenode-checkbox-indeterminate"),C),(0,T.Z)(a,"".concat(g,"-treenode-selected"),u),(0,T.Z)(a,"".concat(g,"-treenode-loading"),v),(0,T.Z)(a,"drag-over",!b&&r),(0,T.Z)(a,"drag-over-gap-top",!b&&d),(0,T.Z)(a,"drag-over-gap-bottom",!b&&o),(0,T.Z)(a,"filter-node",K&&K(this)),a)),style:n,role:"treeitem",onDragEnter:D?this.onDragEnter:void 0,onDragOver:D?this.onDragOver:void 0,onDragLeave:D?this.onDragLeave:void 0,onDrop:D?this.onDrop:void 0,onDragEnd:D?this.onDragEnd:void 0},Z),{},{children:[this.renderSwitcher(),this.renderCheckbox(),this.renderSelector(),this.renderChildren()]}))}}]),l}(P.Component),Y=function(i){return(0,y.jsx)(oe.Consumer,{children:function(e){return(0,y.jsx)(Ie,(0,m.Z)((0,m.Z)({},i),{},{context:e}))}})};Y.defaultProps={title:$e},Y.isTreeNode=1;var J=Y,we=["children"],Fe=.25,Me=2,ie=!1;function de(){ie||(ie=!0)}function $(c,i){var l=c.slice(),e=l.indexOf(i);return e>=0&&l.splice(e,1),l}function I(c,i){var l=c.slice();return l.indexOf(i)===-1&&l.push(i),l}function Ae(c){return c.split("-")}function ce(c,i){return"".concat(c,"-").concat(i)}function Re(c){return c&&c.type&&c.type.isTreeNode}function le(c){return(0,R.Z)(c).filter(Re)}function w(c){var i=c.props||{},l=i.disabled,e=i.disableCheckbox,a=i.checkable;return!!(l||e)||a===!1}function ue(c,i){function l(e,a,v){var s=e?e.props.children:c,t=e?ce(v.pos,a):0,n=le(s);if(e){var r={node:e,index:a,pos:t,key:e.key||t,parentPos:v.node?v.pos:null};i(r)}P.Children.forEach(n,function(d,o){l(d,o,{node:e,pos:t})})}l(null)}function fe(c,i){var l=(0,R.Z)(c).map(i);return l.length===1?l[0]:l}function He(c,i){var l=i.props,e=l.eventKey,a=l.pos,v=[];return ue(c,function(s){var t=s.key;v.push(t)}),v.push(e||a),v}function he(c,i){var l=c.clientY,e=i.selectHandle.getBoundingClientRect(),a=e.top,v=e.bottom,s=e.height,t=Math.max(s*Fe,Me);return l<=a+t?-1:l>=v-t?1:0}function ve(c,i){if(!!c){var l=i.multiple;return l?c.slice():c.length?[c[0]]:c}}function pe(c){return c&&c.map(function(i){return String(i)})}var Ge=function(i){return i};function ge(c,i){if(!c)return[];var l=i||{},e=l.processProps,a=e===void 0?Ge:e,v=Array.isArray(c)?c:[c];return v.map(function(s){var t=s.children,n=(0,A.Z)(s,we),r=ge(t,i);return(0,y.jsx)(J,(0,m.Z)((0,m.Z)({},a(n)),{},{children:r}))})}function Ue(c){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.initWrapper,e=i.processEntity,a=i.onProcessFinished,v={},s={},t={posEntities:v,keyEntities:s};return l&&(t=l(t)||t),ue(c,function(n){var r=n.node,d=n.index,o=n.pos,f=n.key,h=n.parentPos,u={node:r,index:d,key:f,pos:o};v[o]=u,s[f]=u,u.parent=v[h],u.parent&&(u.parent.children=u.parent.children||[],u.parent.children.push(u)),e&&e(u,t)}),a&&a(t),t}function Q(c){if(!c)return null;var i;if(Array.isArray(c))i={checkedKeys:c,halfCheckedKeys:void 0};else if(typeof c=="object")i={checkedKeys:c.checked||void 0,halfCheckedKeys:c.halfChecked||void 0};else return null;return i.checkedKeys=pe(i.checkedKeys),i.halfCheckedKeys=pe(i.halfCheckedKeys),i}function ye(c,i,l){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a={},v={};(e.checkedKeys||[]).forEach(function(o){a[o]=!0}),(e.halfCheckedKeys||[]).forEach(function(o){v[o]=!0});function s(o){if(a[o]!==i){var f=l[o];if(!!f){var h=f.children,u=f.parent,p=f.node;if(!w(p)){var C=!0,N=!1;(h||[]).filter(function(k){return!w(k.node)}).forEach(function(k){var g=k.key,K=a[g],D=v[g];(K||D)&&(N=!0),K||(C=!1)}),i?a[o]=C:a[o]=!1,v[o]=N,u&&s(u.key)}}}}function t(o){if(a[o]!==i){var f=l[o];if(!!f){var h=f.children,u=f.node;w(u)||(a[o]=i,(h||[]).forEach(function(p){t(p.key)}))}}}function n(o){var f=l[o];if(!!f){var h=f.children,u=f.parent,p=f.node;a[o]=i,!w(p)&&((h||[]).filter(function(C){return!w(C.node)}).forEach(function(C){t(C.key)}),u&&s(u.key))}}(c||[]).forEach(function(o){n(o)});var r=[],d=[];return Object.keys(a).forEach(function(o){a[o]&&r.push(o)}),Object.keys(v).forEach(function(o){!a[o]&&v[o]&&d.push(o)}),{checkedKeys:r,halfCheckedKeys:d}}function xe(c,i){var l={};function e(a){if(!l[a]){var v=i[a];if(!!v){l[a]=!0;var s=v.parent,t=v.node;w(t)||s&&e(s.key)}}}return(c||[]).forEach(function(a){e(a)}),Object.keys(l)}function Ne(c){return Object.keys(c).reduce(function(i,l){return(l.substr(0,5)==="data-"||l.substr(0,5)==="aria-")&&(i[l]=c[l]),i},{})}var Ce=function(c){(0,z.Z)(l,c);var i=(0,V.Z)(l);function l(){var e;(0,B.Z)(this,l);for(var a=arguments.length,v=new Array(a),s=0;s<a;s++)v[s]=arguments[s];return e=i.call.apply(i,[this].concat(v)),e.domTreeNodes={},e.delayedDragEnterLogic=void 0,e.state={keyEntities:{},selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],dragNodesKeys:[],dragOverNodeKey:null,dropPosition:null,treeNode:[],prevProps:null},e.dragNode=void 0,e.onNodeDragStart=function(t,n){var r=e.state.expandedKeys,d=e.props.onDragStart,o=n.props,f=o.eventKey,h=o.children;e.dragNode=n,e.setState({dragNodesKeys:He(h,n),expandedKeys:$(r,f)}),d&&d({event:t,node:n})},e.onNodeDragEnter=function(t,n){var r=e.state.expandedKeys,d=e.props.onDragEnter,o=n.props,f=o.pos,h=o.eventKey;if(!!e.dragNode){var u=he(t,n);if(e.dragNode.props.eventKey===h&&u===0){e.setState({dragOverNodeKey:"",dropPosition:null});return}setTimeout(function(){e.setState({dragOverNodeKey:h,dropPosition:u}),e.delayedDragEnterLogic||(e.delayedDragEnterLogic={}),Object.keys(e.delayedDragEnterLogic).forEach(function(p){clearTimeout(e.delayedDragEnterLogic[p])}),e.delayedDragEnterLogic[f]=window.setTimeout(function(){var p=I(r,h);"expandedKeys"in e.props||e.setState({expandedKeys:p}),d&&d({event:t,node:n,expandedKeys:p})},400)},0)}},e.onNodeDragOver=function(t,n){var r=e.props.onDragOver,d=n.props.eventKey;if(e.dragNode&&d===e.state.dragOverNodeKey){var o=he(t,n);if(o===e.state.dropPosition)return;e.setState({dropPosition:o})}r&&r({event:t,node:n})},e.onNodeDragLeave=function(t,n){var r=e.props.onDragLeave;e.setState({dragOverNodeKey:""}),r&&r({event:t,node:n})},e.onNodeDragEnd=function(t,n){var r=e.props.onDragEnd;e.setState({dragOverNodeKey:""}),r&&r({event:t,node:n}),e.dragNode=null},e.onNodeDrop=function(t,n){var r=e.state,d=r.dragNodesKeys,o=d===void 0?[]:d,f=r.dropPosition,h=e.props.onDrop,u=n.props,p=u.eventKey,C=u.pos;if(e.setState({dragOverNodeKey:""}),o.indexOf(p)===-1){var N=Ae(C),k={event:t,node:n,dragNode:e.dragNode,dragNodesKeys:o.slice(),dropPosition:f+Number(N[N.length-1]),dropToGap:!1};f!==0&&(k.dropToGap=!0),h&&h(k),e.dragNode=null}},e.onNodeClick=function(t,n){var r=e.props.onClick;r&&r(t,n)},e.onNodeDoubleClick=function(t,n){var r=e.props.onDoubleClick;r&&r(t,n)},e.onNodeSelect=function(t,n){var r=e.state.selectedKeys,d=e.state.keyEntities,o=e.props,f=o.onSelect,h=o.multiple,u=n.props,p=u.selected,C=u.eventKey,N=!p;N?h?r=I(r,C):r=[C]:r=$(r,C);var k=r.map(function(g){var K=d[g];return K?K.node:null}).filter(function(g){return g});e.setUncontrolledState({selectedKeys:r}),f&&f(r,{event:"select",selected:N,node:n,selectedNodes:k,nativeEvent:t.nativeEvent})},e.onNodeCheck=function(t,n,r){var d=e.state,o=d.keyEntities,f=d.checkedKeys,h=d.halfCheckedKeys,u=e.props,p=u.checkStrictly,C=u.onCheck,N=n.props.eventKey,k,g={event:"check",node:n,checked:r,nativeEvent:t.nativeEvent};if(p){var K=r?I(f,N):$(f,N),D=$(h,N);k={checked:K,halfChecked:D},g.checkedNodes=K.map(function(E){return o[E]}).filter(function(E){return E}).map(function(E){return E.node}),e.setUncontrolledState({checkedKeys:K})}else{var b=ye([N],r,o,{checkedKeys:f,halfCheckedKeys:h}),Z=b.checkedKeys,j=b.halfCheckedKeys;k=Z,g.checkedNodes=[],g.checkedNodesPositions=[],g.halfCheckedKeys=j,Z.forEach(function(E){var F=o[E];if(!!F){var G=F.node,ft=F.pos;g.checkedNodes.push(G),g.checkedNodesPositions.push({node:G,pos:ft})}}),e.setUncontrolledState({checkedKeys:Z,halfCheckedKeys:j})}C&&C(k,g)},e.onNodeLoad=function(t){return new Promise(function(n){e.setState(function(r){var d=r.loadedKeys,o=d===void 0?[]:d,f=r.loadingKeys,h=f===void 0?[]:f,u=e.props,p=u.loadData,C=u.onLoad,N=t.props.eventKey;if(!p||o.indexOf(N)!==-1||h.indexOf(N)!==-1)return{};var k=p(t);return k.then(function(){var g=e.state,K=g.loadedKeys,D=g.loadingKeys,b=I(K,N),Z=$(D,N);C&&C(b,{event:"load",node:t}),e.setUncontrolledState({loadedKeys:b}),e.setState({loadingKeys:Z}),n()}),{loadingKeys:I(h,N)}})})},e.onNodeExpand=function(t,n){var r=e.state.expandedKeys,d=e.props,o=d.onExpand,f=d.loadData,h=n.props,u=h.eventKey,p=h.expanded,C=r.indexOf(u),N=!p;if(N?r=I(r,u):r=$(r,u),e.setUncontrolledState({expandedKeys:r}),o&&o(r,{node:n,expanded:N,nativeEvent:t.nativeEvent}),N&&f){var k=e.onNodeLoad(n);return k?k.then(function(){e.setUncontrolledState({expandedKeys:r})}):null}return null},e.onNodeMouseEnter=function(t,n){var r=e.props.onMouseEnter;r&&r({event:t,node:n})},e.onNodeMouseLeave=function(t,n){var r=e.props.onMouseLeave;r&&r({event:t,node:n})},e.onNodeContextMenu=function(t,n){var r=e.props.onRightClick;r&&(t.preventDefault(),r({event:t,node:n}))},e.setUncontrolledState=function(t){var n=!1,r={};Object.keys(t).forEach(function(d){d in e.props||(n=!0,r[d]=t[d])}),n&&e.setState(r)},e.registerTreeNode=function(t,n){n?e.domTreeNodes[t]=n:delete e.domTreeNodes[t]},e.isKeyChecked=function(t){var n=e.state.checkedKeys,r=n===void 0?[]:n;return r.indexOf(t)!==-1},e.renderTreeNode=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=e.state,o=d.keyEntities,f=d.expandedKeys,h=f===void 0?[]:f,u=d.selectedKeys,p=u===void 0?[]:u,C=d.halfCheckedKeys,N=C===void 0?[]:C,k=d.loadedKeys,g=k===void 0?[]:k,K=d.loadingKeys,D=K===void 0?[]:K,b=d.dragOverNodeKey,Z=d.dropPosition,j=ce(r,n),E=t.key||j;return o[E]?P.cloneElement(t,{key:E,eventKey:E,expanded:h.indexOf(E)!==-1,selected:p.indexOf(E)!==-1,loaded:g.indexOf(E)!==-1,loading:D.indexOf(E)!==-1,checked:e.isKeyChecked(E),halfChecked:N.indexOf(E)!==-1,pos:j,dragOver:b===E&&Z===0,dragOverGapTop:b===E&&Z===-1,dragOverGapBottom:b===E&&Z===1}):(de(),null)},e}return(0,W.Z)(l,[{key:"render",value:function(){var a=this,v=this.state.treeNode,s=this.props,t=s.prefixCls,n=s.className,r=s.focusable,d=s.style,o=s.showLine,f=s.tabIndex,h=f===void 0?0:f,u=s.selectable,p=s.showIcon,C=s.icon,N=s.switcherIcon,k=s.draggable,g=s.checkable,K=s.checkStrictly,D=s.disabled,b=s.motion,Z=s.loadData,j=s.filterTreeNode,E=Ne(this.props);return r&&(E.tabIndex=h),(0,y.jsx)(oe.Provider,{value:{prefixCls:t,selectable:u,showIcon:p,icon:C,switcherIcon:N,draggable:k,checkable:g,checkStrictly:K,disabled:D,motion:b,loadData:Z,filterTreeNode:j,renderTreeNode:this.renderTreeNode,isKeyChecked:this.isKeyChecked,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop,registerTreeNode:this.registerTreeNode},children:(0,y.jsx)("ul",(0,m.Z)((0,m.Z)({},E),{},{className:L()(t,n,(0,T.Z)({},"".concat(t,"-show-line"),o)),style:d,role:"tree",unselectable:"on",children:fe(v,function(F,G){return a.renderTreeNode(F,G)})}))})}}],[{key:"getDerivedStateFromProps",value:function(a,v){var s=v.prevProps,t={prevProps:a};function n(g){return!s&&g in a||s&&s[g]!==a[g]}var r=null;if(n("treeData")?r=ge(a.treeData):n("children")&&(r=(0,R.Z)(a.children)),r){t.treeNode=r;var d=Ue(r);t.keyEntities=d.keyEntities}var o=t.keyEntities||v.keyEntities;if(n("expandedKeys")||s&&n("autoExpandParent")?t.expandedKeys=a.autoExpandParent||!s&&a.defaultExpandParent?xe(a.expandedKeys,o):a.expandedKeys:!s&&a.defaultExpandAll?t.expandedKeys=Object.keys(o):!s&&a.defaultExpandedKeys&&(t.expandedKeys=a.autoExpandParent||a.defaultExpandParent?xe(a.defaultExpandedKeys,o):a.defaultExpandedKeys),a.selectable&&(n("selectedKeys")?t.selectedKeys=ve(a.selectedKeys,a):!s&&a.defaultSelectedKeys&&(t.selectedKeys=ve(a.defaultSelectedKeys,a))),a.checkable){var f;if(n("checkedKeys")?f=Q(a.checkedKeys)||{}:!s&&a.defaultCheckedKeys?f=Q(a.defaultCheckedKeys)||{}:r&&(f=Q(a.checkedKeys)||{checkedKeys:v.checkedKeys,halfCheckedKeys:v.halfCheckedKeys}),f){var h=f,u=h.checkedKeys,p=u===void 0?[]:u,C=h.halfCheckedKeys,N=C===void 0?[]:C;if(!a.checkStrictly){var k=ye(p,!0,o);p=k.checkedKeys,N=k.halfCheckedKeys}t.checkedKeys=p,t.halfCheckedKeys=N}}return n("loadedKeys")&&(t.loadedKeys=a.loadedKeys),t}}]),l}(P.Component);Ce.defaultProps={prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[]};var Be=Ce,ke=Be;ke.TreeNode=J;var We=ke,X=function(){return{height:0,opacity:0}},me=function(i){return{height:i.scrollHeight,opacity:1}},ze=function(i){return{height:i.offsetHeight}},Ve={motionName:"ant-motion-collapse",onAppearStart:X,onEnterStart:X,onAppearActive:me,onEnterActive:me,onLeaveStart:ze,onLeaveActive:X},Ye=Ve,Ke=x(16165),Je=x(46133),Qe=x.n(Je),Xe=x(3361),qe=x.n(Xe),_e=x(31929),q=x(83279),et=["value","flatTreeData","onChange","readonly"],tt=function(i){var l=i.value,e=l===void 0?[]:l,a=i.flatTreeData,v=i.onChange,s=i.readonly,t=(0,A.Z)(i,et);return(0,y.jsx)(_,(0,m.Z)({checkable:!0,showIcon:!0,defaultCheckedKeys:e,checkedKeys:e,checkStrictly:!0,defaultExpandAll:!0,onCheck:function(r,d){var o=r.checked,f=d.node.props.eventKey;if(!(!f||!v||s)){var h=(a==null?void 0:a.filter(function(u){return u.key.startsWith(f)}).map(function(u){return u.key}))||[];if(d.checked){v((0,q.Z)(new Set([].concat((0,q.Z)(o),(0,q.Z)(h)))));return}if(!d.checked){v(o.filter(function(u){return!h.includes(u)}));return}}}},t))},_=function(c){(0,z.Z)(l,c);var i=(0,V.Z)(l);function l(){var e;(0,B.Z)(this,l);for(var a=arguments.length,v=new Array(a),s=0;s<a;s++)v[s]=arguments[s];return e=i.call.apply(i,[this].concat(v)),e.tree=void 0,e.renderSwitcherIcon=function(t,n,r){var d=r.isLeaf,o=r.expanded,f=r.loading,h=e.props.showLine;if(f)return(0,y.jsx)(Ke.Z,{type:"loading",className:"".concat(t,"-switcher-loading-icon")});if(d)return h?(0,y.jsx)(Ke.Z,{type:"file",className:"".concat(t,"-switcher-line-icon")}):null;var u="".concat(t,"-switcher-icon");return n?P.cloneElement(n,{className:L()(n.props.className||"",u)}):o?(0,y.jsx)(Qe(),{className:u}):(0,y.jsx)(qe(),{className:u})},e.setTreeRef=function(t){e.tree=t},e.renderTree=function(t){var n,r=t.getPrefixCls,d=(0,S.Z)(e),o=d.props,f=o.prefixCls,h=o.className,u=o.showIcon,p=o.switcherIcon,C=o.blockNode,N=o.children,k=o.checkable,g="ant3-tree";return(0,y.jsx)(We,(0,m.Z)((0,m.Z)({ref:e.setTreeRef},o),{},{prefixCls:g,className:L()(h,(n={},(0,T.Z)(n,"".concat(g,"-icon-hide"),!u),(0,T.Z)(n,"".concat(g,"-block-node"),C),n)),checkable:k&&(0,y.jsx)("span",{className:"".concat(g,"-checkbox-inner")}),switcherIcon:function(D){return e.renderSwitcherIcon(g,p,D)},children:N}))},e}return(0,W.Z)(l,[{key:"render",value:function(){return(0,y.jsx)(_e.ConfigConsumer,{children:this.renderTree})}}]),l}(P.Component);_.TreeNode=J,_.defaultProps={checkable:!1,showIcon:!1,motion:(0,m.Z)((0,m.Z)({},Ye),{},{motionAppear:!1}),blockNode:!1};var nt=x(52125),rt=x(57551),O=x(82837),ot=x(64284),at=["treeData","flatTreeData","readonly"];function st(c){for(var i=c.split(":"),l=[],e=0;e<i.length;e++)e>0?l.push("".concat(l[e-1],":").concat(i[e])):l.push(i[0]);return l}var H={list:"1",detail:"2",create:"3",update:"4",delete:"5",import:"6",export:"7"},it=function c(i,l){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"parentKey",a=i.filter(function(s){return s[e]===l}),v=a.filter(function(s){return Object.keys(H).includes(s.key.toLowerCase().split(":").slice(-1)[0])}).length>0;return v&&a.sort(function(s,t){var n=H[s.key.toLowerCase().split(":").slice(-1)[0]]||s,r=H[t.key.toLowerCase().split(":").slice(-1)[0]]||t;return n>r?1:n<r?-1:0}),a.map(function(s){return(0,m.Z)((0,m.Z)({},s),{},{children:c(i,s.key)})})},dt=function(i){var l=i.treeData,e=i.flatTreeData,a=i.readonly,v=(0,A.Z)(i,at);return(0,y.jsx)(O.ZP.Item,(0,m.Z)((0,m.Z)({},v),{},{children:(0,y.jsx)(tt,(0,m.Z)({treeData:l,flatTreeData:e},i.fieldProps))}))},ct=(0,re.Pi)(function(c){var i=c.onOk,l=c.onClose,e=c.role,a=(0,P.useRef)(),v=!!(e!=null&&e.id),s=(0,ot.Z)(),t=(0,ne.m2)(),n=[];t.permissions.filter(function(d){return!d.code.startsWith("ROLE_")}).forEach(function(d){st(d.code).forEach(function(o,f,h){var u=d.name||s.formatMessage({id:"authority.".concat(o.replaceAll(":",".")),defaultMessage:o});if(!n.find(function(C){return C.key===o})){var p=Object.keys(H).includes(o.toLowerCase().split(":").slice(-1)[0]);n.push({key:o,title:u,icon:p?(0,y.jsx)(nt.Z,{}):(0,y.jsx)(rt.Z,{}),parentKey:h[f-1]})}})});var r=it(n,void 0);return(0,y.jsxs)(O.aN,{title:v?e!=null&&e.id?"\u4FEE\u6539\u89D2\u8272":"\u65B0\u589E\u89D2\u8272":"\u67E5\u770B\u89D2\u8272",formRef:a,open:!0,initialValues:e,drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){l()}},onFinish:function(){var d=(0,te.Z)((0,M.Z)().mark(function o(f){var h;return(0,M.Z)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!((e==null?void 0:e.code)==="admin"&&f.code!=="admin")){p.next=3;break}return U.default.error("\u9ED8\u8BA4\u7BA1\u7406\u5458\u89D2\u8272\u7F16\u7801\u4E0D\u80FD\u4FEE\u6539"),p.abrupt("return");case 3:return p.next=5,t.saveOrUpdateRole((0,m.Z)((0,m.Z)({},e),f));case 5:h=p.sent,h.success&&i();case 7:case"end":return p.stop()}},o)}));return function(o){return d.apply(this,arguments)}}(),children:[(0,y.jsxs)(O.ZP.Group,{children:[(0,y.jsx)(O.V,{name:"name",width:"md",label:"\u89D2\u8272\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",required:!0,rules:[{required:!0,message:"\u89D2\u8272\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,y.jsx)(O.V,{width:"md",name:"code",label:"\u89D2\u8272\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u7F16\u7801",rules:[{required:!0,message:"\u89D2\u8272\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"}],required:!0})]}),(0,y.jsx)(O.ZP.Group,{children:(0,y.jsx)(O.$J,{name:"remark",width:"xl",label:"\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0\u4FE1\u606F"})}),(0,y.jsx)(O.ZP.Group,{children:(0,y.jsx)(dt,{name:"authorities",label:"\u89D2\u8272\u6388\u6743",treeData:r,flatTreeData:n})})]})}),lt=(0,re.Pi)(function(){var c=(0,ne.m2)(),i=(0,P.useRef)(),l=(0,P.useState)(),e=(0,be.Z)(l,2),a=e[0],v=e[1];(0,P.useEffect)(function(){c.loadPermissions()},[c]);var s=[{title:"\u89D2\u8272\u540D\u79F0",dataIndex:"name",ellipsis:!0,width:150},{title:"\u7F16\u7801",dataIndex:"code",hideInSearch:!0,width:150},{title:"\u63CF\u8FF0",dataIndex:"remark",search:!1},{title:"\u521B\u5EFA\u65F6\u95F4",key:"showTime",dataIndex:"createAt",valueType:"dateTime",hideInSearch:!0,width:200},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:function(n,r){return[(0,y.jsx)("a",{onClick:function(){v({current:r,visible:!0})},children:"\u7F16\u8F91"},"edit"),(0,y.jsx)("a",{onClick:function(){if(r.code==="admin"){U.default.error("\u9ED8\u8BA4\u7BA1\u7406\u5458\u89D2\u8272\u4E0D\u80FD\u5220\u9664");return}Ee.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u89D2\u8272?",icon:(0,y.jsx)(Se.Z,{}),onOk:function(){c.deleteRole(r.id).then(function(f){if(f.success){var h;U.default.success("\u5220\u9664\u6210\u529F"),(h=i.current)===null||h===void 0||h.reload()}})}})},children:"\u5220\u9664"},"delete")]}}];return(0,y.jsxs)(Te._z,{title:!1,children:[(0,y.jsx)(Pe.ZP,{columns:s,bordered:!0,actionRef:i,dataSource:c.roles,request:function(){var t=(0,te.Z)((0,M.Z)().mark(function n(r){return(0,M.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",c.loadRoles(r));case 1:case"end":return o.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),scroll:{x:800},columnsState:{persistenceKey:"pro-table-singe-demos",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:5},dateFormatter:"string",headerTitle:"\u7CFB\u7EDF\u89D2\u8272\u5217\u8868",toolBarRender:function(){return[(0,y.jsx)(De.Z,{icon:(0,y.jsx)(Ze.Z,{}),type:"primary",onClick:function(){v({visible:!0})},children:"\u65B0\u5EFA"},"button")]}}),(a==null?void 0:a.visible)&&(0,y.jsx)(ct,{onClose:function(){v(void 0)},onOk:function(){var n;v(void 0),(n=i.current)===null||n===void 0||n.reload()},role:a.current})]})}),ut=lt}}]);
