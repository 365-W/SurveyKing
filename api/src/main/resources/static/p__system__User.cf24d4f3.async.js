(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7915],{14198:function(se,w,n){"use strict";n.r(w),n.d(w,{default:function(){return le}});var ie=n(57663),G=n(71577),x=n(3182),de=n(34792),V=n(48086),ce=n(71194),$=n(50146),me=n(49111),L=n(19650),ve=n(71153),M=n(60331),W=n(2824),K=n(94043),P=n.n(K),O=n(89835),z=n(57119),N=n(49101),H=n(84452),J=n(5691),Q=n(93279),D=n(77613),f=n(67294),S=n(11849),C=n(15196),X=n(71975),j=n(5966),I=n(21426),R=n(22270),T=n(66758),Y=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],k=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"];function Z(){return Z=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Z.apply(this,arguments)}function A(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,r)}return t}function b(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?A(Object(t),!0).forEach(function(r){q(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function q(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function U(e,a){if(e==null)return{};var t=_(e,a),r,u;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(u=0;u<i.length;u++)r=i[u],!(a.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(t[r]=e[r]))}return t}function _(e,a){if(e==null)return{};var t={},r=Object.keys(e),u,i;for(i=0;i<r.length;i++)u=r[i],!(a.indexOf(u)>=0)&&(t[u]=e[u]);return t}var ee=f.forwardRef(function(e,a){var t=e.fieldProps,r=e.children,u=e.params,i=e.proFieldProps,F=e.mode,v=e.valueEnum,c=e.request,d=e.showSearch,l=e.options,s=U(e,Y),m=(0,f.useContext)(T.Z);return f.createElement(I.Z,Z({mode:"edit",valueEnum:(0,R.h)(v),request:c,params:u,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:b({options:l,mode:F,showSearch:d,getPopupContainer:m.getPopupContainer},t),ref:a,proFieldProps:i},s),r)}),re=f.forwardRef(function(e,a){var t=e.fieldProps,r=e.children,u=e.params,i=e.proFieldProps,F=e.mode,v=e.valueEnum,c=e.request,d=e.options,l=U(e,k),s=b({options:d,mode:F||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},t),m=(0,f.useContext)(T.Z);return f.createElement(I.Z,Z({mode:"edit",valueEnum:(0,R.h)(v),request:c,params:u,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:b({getPopupContainer:m.getPopupContainer},s),ref:a,proFieldProps:i},l),r)}),te=ee,ne=re,E=te;E.SearchSelect=ne,E.displayName="ProFormComponent";var B=E,o=n(85893),ae=(0,D.P)(function(e){var a,t=e.user,r=e.readonly,u=e.onClose,i=e.onOk,F=(0,O.m2)(),v=(0,f.useRef)(),c=t==null||(a=t.roles)===null||a===void 0?void 0:a.map(function(l){return l.id}),d=!!(t!=null&&t.id);return(0,o.jsxs)(X.Z,{title:r?"\u7CFB\u7EDF\u7528\u6237\u8BE6\u60C5":d?"\u4FEE\u6539\u7528\u6237":"\u65B0\u5EFA\u7528\u6237",formRef:v,visible:!0,initialValues:(0,S.Z)((0,S.Z)({},t),{},{roles:c}),drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){u()}},onFinish:function(){var l=(0,x.Z)(P().mark(function s(m){var h;return P().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,F.saveOrUpdateUser((0,S.Z)((0,S.Z)({},t),m));case 2:return h=y.sent,h.success&&i(),y.abrupt("return",!0);case 5:case"end":return y.stop()}},s)}));return function(s){return l.apply(this,arguments)}}(),children:[(0,o.jsxs)(C.ZP.Group,{children:[(0,o.jsx)(j.Z,{name:"name",width:"md",label:"\u7528\u6237\u540D",tooltip:"\u6700\u957F\u4E3A 24 \u4F4D",id:"form-name",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",readonly:r,required:!0,rules:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,o.jsx)(j.Z,{width:"md",readonly:r,name:"username",label:"\u767B\u5F55\u540D",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u8D26\u6237\u540D\u79F0",rules:[{required:!0,message:"\u767B\u5F55\u540D\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(){var l=(0,x.Z)(P().mark(function m(h,p){var y;return P().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(p!==(t==null?void 0:t.username)){g.next=2;break}return g.abrupt("return");case 2:return g.next=4,O.hi.checkUsernameExist(p);case 4:if(y=g.sent,!y){g.next=7;break}throw new Error("\u767B\u5F55\u540D\u5DF2\u5B58\u5728!");case 7:case"end":return g.stop()}},m)}));function s(m,h){return l.apply(this,arguments)}return s}()}],required:!0})]}),!r&&(0,o.jsxs)(C.ZP.Group,{children:[(0,o.jsx)(j.Z.Password,{width:"md",readonly:r,name:"password",label:"\u8F93\u5165\u5BC6\u7801",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!d,message:"\u8BF7\u8F93\u5165\u5BC6\u7801!"}],required:!d}),(0,o.jsx)(j.Z.Password,{width:"md",readonly:r,name:"rePassword",label:"\u786E\u8BA4\u5BC6\u7801",placeholder:"\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{required:!d,message:"\u786E\u8BA4\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A!"},function(l){var s=l.getFieldValue;return{validator:function(h,p){return!p||s("password")===p?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))}}}],required:!d})]}),(0,o.jsxs)(C.ZP.Group,{children:[(0,o.jsx)(B,{readonly:r,required:!0,options:[{value:"M",label:"\u7537"},{value:"F",label:"\u5973"}],width:"md",name:"gender",label:"\u6027\u522B"}),(0,o.jsx)(B,{readonly:r,required:!0,options:[{value:1,label:"\u6FC0\u6D3B"},{value:0,label:"\u5931\u6D3B"}],width:"md",name:"status",label:"\u72B6\u6001"})]}),(0,o.jsxs)(C.ZP.Group,{children:[(0,o.jsx)(j.Z,{name:"phone",readonly:r,width:"md",label:"\u624B\u673A",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"}),(0,o.jsx)(j.Z,{width:"md",name:"email",readonly:r,label:"\u90AE\u7BB1",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",rules:[{type:"email",message:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"}]}),(0,o.jsx)(B,{mode:"tags",readonly:r,request:(0,x.Z)(P().mark(function l(){return P().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",O.hi.loadRoles({current:1,pageSize:1024}).then(function(h){return h.list.map(function(p){return{label:p.name,value:p.id}})}));case 1:case"end":return m.stop()}},l)})),width:"md",name:"roles",label:"\u89D2\u8272\u5217\u8868"})]})]})}),oe=["magenta","volcano","cyan","blue","geekblue","purple"],ue=(0,D.P)(function(){var e=(0,O.m2)(),a=(0,f.useRef)(),t=(0,f.useState)(),r=(0,W.Z)(t,2),u=r[0],i=r[1];(0,f.useEffect)(function(){e.loadPermissions()},[e]);var F=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:"\u59D3\u540D",dataIndex:"name",ellipsis:!0},{title:"\u89D2\u8272",dataIndex:"phone",hideInSearch:!0,renderFormItem:function(c,d){var l=d.defaultRender;return l(c)},render:function(c,d){var l;return(0,o.jsx)(L.Z,{children:(l=d.roles)===null||l===void 0?void 0:l.map(function(s,m){return(0,o.jsx)(M.Z,{color:oe[m],children:s.name},s.id)})})}},{title:"\u624B\u673A",dataIndex:"phone",search:!1},{title:"\u72B6\u6001",dataIndex:"status",search:!1,valueEnum:{0:{text:"\u5931\u6D3B",status:"Default"},1:{text:"\u6FC0\u6D3B",status:"Processing"}}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"showTime",dataIndex:"createAt",valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",valueType:"option",render:function(c,d){return[(0,o.jsx)("a",{onClick:function(){i({visible:!0,readonly:!0,current:d})},children:"\u8BE6\u60C5"},"editable"),(0,o.jsx)(Q.Z,{onSelect:function(s){s==="edit"&&i({current:d,visible:!0}),s==="delete"&&$.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u7528\u6237?",icon:(0,o.jsx)(z.Z,{}),onOk:function(){e.deleteRole(d.id).then(function(h){if(h.success){var p;V.default.success("\u5220\u9664\u6210\u529F"),(p=a.current)===null||p===void 0||p.reload()}})}})},menus:[{key:"edit",name:"\u7F16\u8F91"},{key:"delete",name:"\u5220\u9664"}]},"actionGroup")]}}];return(0,o.jsxs)(H.ZP,{title:!1,children:[(0,o.jsx)(J.ZP,{columns:F,actionRef:a,dataSource:e.users,request:function(){var v=(0,x.Z)(P().mark(function c(d){return P().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",e.loadUsers(d));case 1:case"end":return s.stop()}},c)}));return function(c){return v.apply(this,arguments)}}(),columnsState:{persistenceKey:"pro-table-singe-demos",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},pagination:{pageSize:5},dateFormatter:"string",headerTitle:"\u7CFB\u7EDF\u7528\u6237\u5217\u8868",toolBarRender:function(){return[(0,o.jsx)(G.Z,{icon:(0,o.jsx)(N.Z,{}),type:"primary",onClick:function(){i({visible:!0})},children:"\u65B0\u5EFA"},"button")]}}),(u==null?void 0:u.visible)&&(0,o.jsx)(ae,{onClose:function(){i(void 0)},readonly:u.readonly,onOk:function(){var c;i(void 0),(c=a.current)===null||c===void 0||c.reload()},user:u.current})]})}),le=ue}}]);
